import{i as Ct,j as sc,_ as fc,d as ac,c as Fi,r as Di,o as Ki,a as uc,b as ys,w as cc,e as qn,t as _s,f as bs,g as lc,p as hc,h as dc}from"./index-597dc359.js";import{g as jf,c as xt,r as ln,i as ve,u as pc}from"./useEtherJsStore-066c617b.js";function yc(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const o=Object.getOwnPropertyDescriptor(n,i);o&&Object.defineProperty(e,i,o.get?o:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var dt={},ke={},le={};Object.defineProperty(le,"__esModule",{value:!0});le.testnet=le.regtest=le.bitcoin=void 0;le.bitcoin={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128};le.regtest={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bcrt",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239};le.testnet={messagePrefix:`Bitcoin Signed Message:
`,bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239};var Hr={},fi={},Be={},yt={};Object.defineProperty(yt,"__esModule",{value:!0});yt.encode=yt.decode=yt.check=void 0;function _c(e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return!1;const t=e[3];if(t===0||5+t>=e.length||e[4+t]!==2)return!1;const r=e[5+t];return!(r===0||6+t+r!==e.length||e[4]&128||t>1&&e[4]===0&&!(e[5]&128)||e[t+6]&128||r>1&&e[t+6]===0&&!(e[t+7]&128))}yt.check=_c;function bc(e){if(e.length<8)throw new Error("DER sequence length is too short");if(e.length>72)throw new Error("DER sequence length is too long");if(e[0]!==48)throw new Error("Expected DER sequence");if(e[1]!==e.length-2)throw new Error("DER sequence length is invalid");if(e[2]!==2)throw new Error("Expected DER integer");const t=e[3];if(t===0)throw new Error("R length is zero");if(5+t>=e.length)throw new Error("R length is too long");if(e[4+t]!==2)throw new Error("Expected DER integer (2)");const r=e[5+t];if(r===0)throw new Error("S length is zero");if(6+t+r!==e.length)throw new Error("S length is invalid");if(e[4]&128)throw new Error("R value is negative");if(t>1&&e[4]===0&&!(e[5]&128))throw new Error("R value excessively padded");if(e[t+6]&128)throw new Error("S value is negative");if(r>1&&e[t+6]===0&&!(e[t+7]&128))throw new Error("S value excessively padded");return{r:e.slice(4,4+t),s:e.slice(6+t)}}yt.decode=bc;function gc(e,t){const r=e.length,n=t.length;if(r===0)throw new Error("R length is zero");if(n===0)throw new Error("S length is zero");if(r>33)throw new Error("R length is too long");if(n>33)throw new Error("S length is too long");if(e[0]&128)throw new Error("R value is negative");if(t[0]&128)throw new Error("S value is negative");if(r>1&&e[0]===0&&!(e[1]&128))throw new Error("R value excessively padded");if(n>1&&t[0]===0&&!(t[1]&128))throw new Error("S value excessively padded");const i=Buffer.allocUnsafe(6+r+n);return i[0]=48,i[1]=i.length-2,i[2]=2,i[3]=e.length,e.copy(i,4),i[4+r]=2,i[5+r]=t.length,t.copy(i,6+r),i}yt.encode=gc;var Rt={};Object.defineProperty(Rt,"__esModule",{value:!0});Rt.REVERSE_OPS=Rt.OPS=void 0;const Eo={OP_FALSE:0,OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_LEFT:128,OP_RIGHT:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_NOP2:177,OP_CHECKLOCKTIMEVERIFY:177,OP_NOP3:178,OP_CHECKSEQUENCEVERIFY:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_CHECKSIGADD:186,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255};Rt.OPS=Eo;const Vf={};Rt.REVERSE_OPS=Vf;for(const e of Object.keys(Eo)){const t=Eo[e];Vf[t]=e}var Ot={};Object.defineProperty(Ot,"__esModule",{value:!0});Ot.decode=Ot.encode=Ot.encodingLength=void 0;const kt=Rt;function Gf(e){return e<kt.OPS.OP_PUSHDATA1?1:e<=255?2:e<=65535?3:5}Ot.encodingLength=Gf;function wc(e,t,r){const n=Gf(t);return n===1?e.writeUInt8(t,r):n===2?(e.writeUInt8(kt.OPS.OP_PUSHDATA1,r),e.writeUInt8(t,r+1)):n===3?(e.writeUInt8(kt.OPS.OP_PUSHDATA2,r),e.writeUInt16LE(t,r+1)):(e.writeUInt8(kt.OPS.OP_PUSHDATA4,r),e.writeUInt32LE(t,r+1)),n}Ot.encode=wc;function Ec(e,t){const r=e.readUInt8(t);let n,i;if(r<kt.OPS.OP_PUSHDATA1)n=r,i=1;else if(r===kt.OPS.OP_PUSHDATA1){if(t+2>e.length)return null;n=e.readUInt8(t+1),i=2}else if(r===kt.OPS.OP_PUSHDATA2){if(t+3>e.length)return null;n=e.readUInt16LE(t+1),i=3}else{if(t+5>e.length)return null;if(r!==kt.OPS.OP_PUSHDATA4)throw new Error("Unexpected opcode");n=e.readUInt32LE(t+1),i=5}return{opcode:r,number:n,size:i}}Ot.decode=Ec;var Or={};Object.defineProperty(Or,"__esModule",{value:!0});Or.encode=Or.decode=void 0;function Sc(e,t,r){t=t||4,r=r===void 0?!0:r;const n=e.length;if(n===0)return 0;if(n>t)throw new TypeError("Script number overflow");if(r&&!(e[n-1]&127)&&(n<=1||!(e[n-2]&128)))throw new Error("Non-minimally encoded script number");if(n===5){const o=e.readUInt32LE(0),s=e.readUInt8(4);return s&128?-((s&-129)*4294967296+o):s*4294967296+o}let i=0;for(let o=0;o<n;++o)i|=e[o]<<8*o;return e[n-1]&128?-(i&~(128<<8*(n-1))):i}Or.decode=Sc;function vc(e){return e>2147483647?5:e>8388607?4:e>32767?3:e>127?2:e>0?1:0}function mc(e){let t=Math.abs(e);const r=vc(t),n=Buffer.allocUnsafe(r),i=e<0;for(let o=0;o<r;++o)n.writeUInt8(t&255,o),t>>=8;return n[r-1]&128?n.writeUInt8(i?128:0,r-1):i&&(n[r-1]|=128),n}Or.encode=mc;var Br={},be={},hn={Array:function(e){return e!=null&&e.constructor===Array},Boolean:function(e){return typeof e=="boolean"},Function:function(e){return typeof e=="function"},Nil:function(e){return e==null},Number:function(e){return typeof e=="number"},Object:function(e){return typeof e=="object"},String:function(e){return typeof e=="string"},"":function(){return!0}};hn.Null=hn.Nil;for(var gs in hn)hn[gs].toJSON=function(e){return e}.bind(null,gs);var Lo=hn,Kt=Lo;function qf(e){return e.name||e.toString().match(/function (.*?)\s*\(/)[1]}function Mo(e){return Kt.Nil(e)?"":qf(e.constructor)}function Tc(e){return Kt.Function(e)?"":Kt.String(e)?JSON.stringify(e):e&&Kt.Object(e)?"":e}function $o(e,t){Error.captureStackTrace&&Error.captureStackTrace(e,t)}function Xn(e){return Kt.Function(e)?e.toJSON?e.toJSON():qf(e):Kt.Array(e)?"Array":e&&Kt.Object(e)?"Object":e!==void 0?e:""}function Xf(e,t,r){var n=Tc(t);return"Expected "+Xn(e)+", got"+(r!==""?" "+r:"")+(n!==""?" "+n:"")}function bt(e,t,r){r=r||Mo(t),this.message=Xf(e,t,r),$o(this,bt),this.__type=e,this.__value=t,this.__valueTypeName=r}bt.prototype=Object.create(Error.prototype);bt.prototype.constructor=bt;function Pc(e,t,r,n,i){var o='" of type ';return t==="key"&&(o='" with key type '),Xf('property "'+Xn(r)+o+Xn(e),n,i)}function Pr(e,t,r,n,i){e?(i=i||Mo(n),this.message=Pc(e,r,t,n,i)):this.message='Unexpected property "'+t+'"',$o(this,bt),this.__label=r,this.__property=t,this.__type=e,this.__value=n,this.__valueTypeName=i}Pr.prototype=Object.create(Error.prototype);Pr.prototype.constructor=bt;function Ic(e,t){return new bt(e,{},t)}function Ac(e,t,r){return e instanceof Pr?(t=t+"."+e.__property,e=new Pr(e.__type,t,e.__label,e.__value,e.__valueTypeName)):e instanceof bt&&(e=new Pr(e.__type,t,r,e.__value,e.__valueTypeName)),$o(e),e}var Yf={TfTypeError:bt,TfPropertyTypeError:Pr,tfCustomError:Ic,tfSubError:Ac,tfJSON:Xn,getValueTypeName:Mo},Wi,ws;function kc(){if(ws)return Wi;ws=1;var e=Lo,t=Yf;function r(_){return Buffer.isBuffer(_)}function n(_){return typeof _=="string"&&/^([0-9a-f]{2})+$/i.test(_)}function i(_,O){var x=_.toJSON();function m(N){if(!_(N))return!1;if(N.length===O)return!0;throw t.tfCustomError(x+"(Length: "+O+")",x+"(Length: "+N.length+")")}return m.toJSON=function(){return x},m}var o=i.bind(null,e.Array),s=i.bind(null,r),f=i.bind(null,n),a=i.bind(null,e.String);function u(_,O,x){x=x||e.Number;function m(N,F){return x(N,F)&&N>_&&N<O}return m.toJSON=function(){return`${x.toJSON()} between [${_}, ${O}]`},m}var l=Math.pow(2,53)-1;function c(_){return typeof _=="number"&&isFinite(_)}function b(_){return _<<24>>24===_}function p(_){return _<<16>>16===_}function y(_){return(_|0)===_}function g(_){return typeof _=="number"&&_>=-l&&_<=l&&Math.floor(_)===_}function w(_){return(_&255)===_}function v(_){return(_&65535)===_}function I(_){return _>>>0===_}function P(_){return typeof _=="number"&&_>=0&&_<=l&&Math.floor(_)===_}var T={ArrayN:o,Buffer:r,BufferN:s,Finite:c,Hex:n,HexN:f,Int8:b,Int16:p,Int32:y,Int53:g,Range:u,StringN:a,UInt8:w,UInt16:v,UInt32:I,UInt53:P};for(var A in T)T[A].toJSON=function(_){return _}.bind(null,A);return Wi=T,Wi}var bn=Yf,ye=Lo,ft=bn.tfJSON,zf=bn.TfTypeError,Jf=bn.TfPropertyTypeError,Gr=bn.tfSubError,Oc=bn.getValueTypeName,pt={arrayOf:function(t,r){t=et(t),r=r||{};function n(i,o){return!ye.Array(i)||ye.Nil(i)||r.minLength!==void 0&&i.length<r.minLength||r.maxLength!==void 0&&i.length>r.maxLength||r.length!==void 0&&i.length!==r.length?!1:i.every(function(s,f){try{return Ae(t,s,o)}catch(a){throw Gr(a,f)}})}return n.toJSON=function(){var i="["+ft(t)+"]";return r.length!==void 0?i+="{"+r.length+"}":(r.minLength!==void 0||r.maxLength!==void 0)&&(i+="{"+(r.minLength===void 0?0:r.minLength)+","+(r.maxLength===void 0?1/0:r.maxLength)+"}"),i},n},maybe:function e(t){t=et(t);function r(n,i){return ye.Nil(n)||t(n,i,e)}return r.toJSON=function(){return"?"+ft(t)},r},map:function(t,r){t=et(t),r&&(r=et(r));function n(i,o){if(!ye.Object(i)||ye.Nil(i))return!1;for(var s in i){try{r&&Ae(r,s,o)}catch(a){throw Gr(a,s,"key")}try{var f=i[s];Ae(t,f,o)}catch(a){throw Gr(a,s)}}return!0}return r?n.toJSON=function(){return"{"+ft(r)+": "+ft(t)+"}"}:n.toJSON=function(){return"{"+ft(t)+"}"},n},object:function(t){var r={};for(var n in t)r[n]=et(t[n]);function i(o,s){if(!ye.Object(o)||ye.Nil(o))return!1;var f;try{for(f in r){var a=r[f],u=o[f];Ae(a,u,s)}}catch(l){throw Gr(l,f)}if(s){for(f in o)if(!r[f])throw new Jf(void 0,f)}return!0}return i.toJSON=function(){return ft(r)},i},anyOf:function(){var t=[].slice.call(arguments).map(et);function r(n,i){return t.some(function(o){try{return Ae(o,n,i)}catch{return!1}})}return r.toJSON=function(){return t.map(ft).join("|")},r},allOf:function(){var t=[].slice.call(arguments).map(et);function r(n,i){return t.every(function(o){try{return Ae(o,n,i)}catch{return!1}})}return r.toJSON=function(){return t.map(ft).join(" & ")},r},quacksLike:function(t){function r(n){return t===Oc(n)}return r.toJSON=function(){return t},r},tuple:function(){var t=[].slice.call(arguments).map(et);function r(n,i){return ye.Nil(n)||ye.Nil(n.length)||i&&n.length!==t.length?!1:t.every(function(o,s){try{return Ae(o,n[s],i)}catch(f){throw Gr(f,s)}})}return r.toJSON=function(){return"("+t.map(ft).join(", ")+")"},r},value:function(t){function r(n){return n===t}return r.toJSON=function(){return t},r}};pt.oneOf=pt.anyOf;function et(e){if(ye.String(e))return e[0]==="?"?pt.maybe(e.slice(1)):ye[e]||pt.quacksLike(e);if(e&&ye.Object(e)){if(ye.Array(e)){if(e.length!==1)throw new TypeError("Expected compile() parameter of type Array of length 1");return pt.arrayOf(e[0])}return pt.object(e)}else if(ye.Function(e))return e;return pt.value(e)}function Ae(e,t,r,n){if(ye.Function(e)){if(e(t,r))return!0;throw new zf(n||e,t)}return Ae(et(e),t,r)}for(var Bt in ye)Ae[Bt]=ye[Bt];for(Bt in pt)Ae[Bt]=pt[Bt];var Es=kc();for(Bt in Es)Ae[Bt]=Es[Bt];Ae.compile=et;Ae.TfTypeError=zf;Ae.TfPropertyTypeError=Jf;var Qf=Ae;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.oneOf=e.Null=e.BufferN=e.Function=e.UInt32=e.UInt8=e.tuple=e.maybe=e.Hex=e.Buffer=e.String=e.Boolean=e.Array=e.Number=e.Hash256bit=e.Hash160bit=e.Buffer256bit=e.isTaptree=e.isTapleaf=e.TAPLEAF_VERSION_MASK=e.Network=e.ECPoint=e.Satoshi=e.Signer=e.BIP32Path=e.UInt31=e.isPoint=e.typeforce=void 0;const t=Ct;e.typeforce=Qf;const r=t.Buffer.alloc(32,0),n=t.Buffer.from("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f","hex");function i(p){if(!t.Buffer.isBuffer(p)||p.length<33)return!1;const y=p[0],g=p.slice(1,33);if(g.compare(r)===0||g.compare(n)>=0)return!1;if((y===2||y===3)&&p.length===33)return!0;const w=p.slice(33);return w.compare(r)===0||w.compare(n)>=0?!1:y===4&&p.length===65}e.isPoint=i;const o=Math.pow(2,31)-1;function s(p){return e.typeforce.UInt32(p)&&p<=o}e.UInt31=s;function f(p){return e.typeforce.String(p)&&!!p.match(/^(m\/)?(\d+'?\/)*\d+'?$/)}e.BIP32Path=f,f.toJSON=()=>"BIP32 derivation path";function a(p){return(e.typeforce.Buffer(p.publicKey)||typeof p.getPublicKey=="function")&&typeof p.sign=="function"}e.Signer=a;const u=21*1e14;function l(p){return e.typeforce.UInt53(p)&&p<=u}e.Satoshi=l,e.ECPoint=e.typeforce.quacksLike("Point"),e.Network=e.typeforce.compile({messagePrefix:e.typeforce.oneOf(e.typeforce.Buffer,e.typeforce.String),bip32:{public:e.typeforce.UInt32,private:e.typeforce.UInt32},pubKeyHash:e.typeforce.UInt8,scriptHash:e.typeforce.UInt8,wif:e.typeforce.UInt8}),e.TAPLEAF_VERSION_MASK=254;function c(p){return!p||!("output"in p)||!t.Buffer.isBuffer(p.output)?!1:p.version!==void 0?(p.version&e.TAPLEAF_VERSION_MASK)===p.version:!0}e.isTapleaf=c;function b(p){return(0,e.Array)(p)?p.length!==2?!1:p.every(y=>b(y)):c(p)}e.isTaptree=b,e.Buffer256bit=e.typeforce.BufferN(32),e.Hash160bit=e.typeforce.BufferN(20),e.Hash256bit=e.typeforce.BufferN(32),e.Number=e.typeforce.Number,e.Array=e.typeforce.Array,e.Boolean=e.typeforce.Boolean,e.String=e.typeforce.String,e.Buffer=e.typeforce.Buffer,e.Hex=e.typeforce.Hex,e.maybe=e.typeforce.maybe,e.tuple=e.typeforce.tuple,e.UInt8=e.typeforce.UInt8,e.UInt32=e.typeforce.UInt32,e.Function=e.typeforce.Function,e.BufferN=e.typeforce.BufferN,e.Null=e.typeforce.Null,e.oneOf=e.typeforce.oneOf})(be);Object.defineProperty(Br,"__esModule",{value:!0});Br.encode=Br.decode=void 0;const Zf=yt,So=be,{typeforce:Bc}=So,Ss=Buffer.alloc(1,0);function vs(e){let t=0;for(;e[t]===0;)++t;return t===e.length?Ss:(e=e.slice(t),e[0]&128?Buffer.concat([Ss,e],1+e.length):e)}function ms(e){e[0]===0&&(e=e.slice(1));const t=Buffer.alloc(32,0),r=Math.max(0,32-e.length);return e.copy(t,r),t}function xc(e){const t=e.readUInt8(e.length-1),r=t&-129;if(r<=0||r>=4)throw new Error("Invalid hashType "+t);const n=Zf.decode(e.slice(0,-1)),i=ms(n.r),o=ms(n.s);return{signature:Buffer.concat([i,o],64),hashType:t}}Br.decode=xc;function Rc(e,t){Bc({signature:So.BufferN(64),hashType:So.UInt8},{signature:e,hashType:t});const r=t&-129;if(r<=0||r>=4)throw new Error("Invalid hashType "+t);const n=Buffer.allocUnsafe(1);n.writeUInt8(t,0);const i=vs(e.slice(0,32)),o=vs(e.slice(32,64));return Buffer.concat([Zf.encode(i,o),n])}Br.encode=Rc;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.signature=e.number=e.isCanonicalScriptSignature=e.isDefinedHashType=e.isCanonicalPubKey=e.toStack=e.fromASM=e.toASM=e.decompile=e.compile=e.countNonPushOnlyOPs=e.isPushOnly=e.OPS=void 0;const t=yt,r=Rt;Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return r.OPS}});const n=Ot,i=Or,o=Br,s=be,{typeforce:f}=s,a=r.OPS.OP_RESERVED;function u(m){return s.Number(m)&&(m===r.OPS.OP_0||m>=r.OPS.OP_1&&m<=r.OPS.OP_16||m===r.OPS.OP_1NEGATE)}function l(m){return s.Buffer(m)||u(m)}function c(m){return s.Array(m)&&m.every(l)}e.isPushOnly=c;function b(m){return m.length-m.filter(l).length}e.countNonPushOnlyOPs=b;function p(m){if(m.length===0)return r.OPS.OP_0;if(m.length===1){if(m[0]>=1&&m[0]<=16)return a+m[0];if(m[0]===129)return r.OPS.OP_1NEGATE}}function y(m){return Buffer.isBuffer(m)}function g(m){return s.Array(m)}function w(m){return Buffer.isBuffer(m)}function v(m){if(y(m))return m;f(s.Array,m);const N=m.reduce((D,ee)=>w(ee)?ee.length===1&&p(ee)!==void 0?D+1:D+n.encodingLength(ee.length)+ee.length:D+1,0),F=Buffer.allocUnsafe(N);let J=0;if(m.forEach(D=>{if(w(D)){const ee=p(D);if(ee!==void 0){F.writeUInt8(ee,J),J+=1;return}J+=n.encode(F,D.length,J),D.copy(F,J),J+=D.length}else F.writeUInt8(D,J),J+=1}),J!==F.length)throw new Error("Could not decode chunks");return F}e.compile=v;function I(m){if(g(m))return m;f(s.Buffer,m);const N=[];let F=0;for(;F<m.length;){const J=m[F];if(J>r.OPS.OP_0&&J<=r.OPS.OP_PUSHDATA4){const D=n.decode(m,F);if(D===null||(F+=D.size,F+D.number>m.length))return null;const ee=m.slice(F,F+D.number);F+=D.number;const Re=p(ee);Re!==void 0?N.push(Re):N.push(ee)}else N.push(J),F+=1}return N}e.decompile=I;function P(m){return y(m)&&(m=I(m)),m.map(N=>{if(w(N)){const F=p(N);if(F===void 0)return N.toString("hex");N=F}return r.REVERSE_OPS[N]}).join(" ")}e.toASM=P;function T(m){return f(s.String,m),v(m.split(" ").map(N=>r.OPS[N]!==void 0?r.OPS[N]:(f(s.Hex,N),Buffer.from(N,"hex"))))}e.fromASM=T;function A(m){return m=I(m),f(c,m),m.map(N=>w(N)?N:N===r.OPS.OP_0?Buffer.allocUnsafe(0):i.encode(N-a))}e.toStack=A;function _(m){return s.isPoint(m)}e.isCanonicalPubKey=_;function O(m){const N=m&-129;return N>0&&N<4}e.isDefinedHashType=O;function x(m){return!Buffer.isBuffer(m)||!O(m[m.length-1])?!1:t.check(m.slice(0,-1))}e.isCanonicalScriptSignature=x,e.number=i,e.signature=o})(Be);var Ce={};Object.defineProperty(Ce,"__esModule",{value:!0});Ce.value=Ce.prop=void 0;function Nc(e,t,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get(){const n=r.call(this);return this[t]=n,n},set(n){Object.defineProperty(this,t,{configurable:!0,enumerable:!0,value:n,writable:!0})}})}Ce.prop=Nc;function Uc(e){let t;return()=>(t!==void 0||(t=e()),t)}Ce.value=Uc;Object.defineProperty(fi,"__esModule",{value:!0});fi.p2data=void 0;const Cc=le,Kn=Be,at=be,Ts=Ce,Ps=Kn.OPS;function Hc(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}function Lc(e,t){if(!e.data&&!e.output)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,at.typeforce)({network:at.typeforce.maybe(at.typeforce.Object),output:at.typeforce.maybe(at.typeforce.Buffer),data:at.typeforce.maybe(at.typeforce.arrayOf(at.typeforce.Buffer))},e);const n={name:"embed",network:e.network||Cc.bitcoin};if(Ts.prop(n,"output",()=>{if(e.data)return Kn.compile([Ps.OP_RETURN].concat(e.data))}),Ts.prop(n,"data",()=>{if(e.output)return Kn.decompile(e.output).slice(1)}),t.validate&&e.output){const i=Kn.decompile(e.output);if(i[0]!==Ps.OP_RETURN)throw new TypeError("Output is invalid");if(!i.slice(1).every(at.typeforce.Buffer))throw new TypeError("Output is invalid");if(e.data&&!Hc(e.data,n.data))throw new TypeError("Data mismatch")}return Object.assign(n,e)}fi.p2data=Lc;var ai={};Object.defineProperty(ai,"__esModule",{value:!0});ai.p2ms=void 0;const Mc=le,Sr=Be,se=be,St=Ce,vr=Sr.OPS,kn=vr.OP_RESERVED;function Is(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}function $c(e,t){if(!e.input&&!e.output&&!(e.pubkeys&&e.m!==void 0)&&!e.signatures)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{});function r(a){return Sr.isCanonicalScriptSignature(a)||(t.allowIncomplete&&a===vr.OP_0)!==void 0}(0,se.typeforce)({network:se.typeforce.maybe(se.typeforce.Object),m:se.typeforce.maybe(se.typeforce.Number),n:se.typeforce.maybe(se.typeforce.Number),output:se.typeforce.maybe(se.typeforce.Buffer),pubkeys:se.typeforce.maybe(se.typeforce.arrayOf(se.isPoint)),signatures:se.typeforce.maybe(se.typeforce.arrayOf(r)),input:se.typeforce.maybe(se.typeforce.Buffer)},e);const i={network:e.network||Mc.bitcoin};let o=[],s=!1;function f(a){s||(s=!0,o=Sr.decompile(a),i.m=o[0]-kn,i.n=o[o.length-2]-kn,i.pubkeys=o.slice(1,-2))}if(St.prop(i,"output",()=>{if(e.m&&i.n&&e.pubkeys)return Sr.compile([].concat(kn+e.m,e.pubkeys,kn+i.n,vr.OP_CHECKMULTISIG))}),St.prop(i,"m",()=>{if(i.output)return f(i.output),i.m}),St.prop(i,"n",()=>{if(i.pubkeys)return i.pubkeys.length}),St.prop(i,"pubkeys",()=>{if(e.output)return f(e.output),i.pubkeys}),St.prop(i,"signatures",()=>{if(e.input)return Sr.decompile(e.input).slice(1)}),St.prop(i,"input",()=>{if(e.signatures)return Sr.compile([vr.OP_0].concat(e.signatures))}),St.prop(i,"witness",()=>{if(i.input)return[]}),St.prop(i,"name",()=>{if(!(!i.m||!i.n))return`p2ms(${i.m} of ${i.n})`}),t.validate){if(e.output){if(f(e.output),!se.typeforce.Number(o[0]))throw new TypeError("Output is invalid");if(!se.typeforce.Number(o[o.length-2]))throw new TypeError("Output is invalid");if(o[o.length-1]!==vr.OP_CHECKMULTISIG)throw new TypeError("Output is invalid");if(i.m<=0||i.n>16||i.m>i.n||i.n!==o.length-3)throw new TypeError("Output is invalid");if(!i.pubkeys.every(a=>(0,se.isPoint)(a)))throw new TypeError("Output is invalid");if(e.m!==void 0&&e.m!==i.m)throw new TypeError("m mismatch");if(e.n!==void 0&&e.n!==i.n)throw new TypeError("n mismatch");if(e.pubkeys&&!Is(e.pubkeys,i.pubkeys))throw new TypeError("Pubkeys mismatch")}if(e.pubkeys){if(e.n!==void 0&&e.n!==e.pubkeys.length)throw new TypeError("Pubkey count mismatch");if(i.n=e.pubkeys.length,i.n<i.m)throw new TypeError("Pubkey count cannot be less than m")}if(e.signatures){if(e.signatures.length<i.m)throw new TypeError("Not enough signatures provided");if(e.signatures.length>i.m)throw new TypeError("Too many signatures provided")}if(e.input){if(e.input[0]!==vr.OP_0)throw new TypeError("Input is invalid");if(i.signatures.length===0||!i.signatures.every(r))throw new TypeError("Input has invalid signature(s)");if(e.signatures&&!Is(e.signatures,i.signatures))throw new TypeError("Signature mismatch");if(e.m!==void 0&&e.m!==e.signatures.length)throw new TypeError("Signature count mismatch")}}return Object.assign(i,e)}ai.p2ms=$c;var ui={};Object.defineProperty(ui,"__esModule",{value:!0});ui.p2pk=void 0;const Fc=le,mr=Be,Ge=be,wr=Ce,As=mr.OPS;function Dc(e,t){if(!e.input&&!e.output&&!e.pubkey&&!e.input&&!e.signature)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,Ge.typeforce)({network:Ge.typeforce.maybe(Ge.typeforce.Object),output:Ge.typeforce.maybe(Ge.typeforce.Buffer),pubkey:Ge.typeforce.maybe(Ge.isPoint),signature:Ge.typeforce.maybe(mr.isCanonicalScriptSignature),input:Ge.typeforce.maybe(Ge.typeforce.Buffer)},e);const r=wr.value(()=>mr.decompile(e.input)),i={name:"p2pk",network:e.network||Fc.bitcoin};if(wr.prop(i,"output",()=>{if(e.pubkey)return mr.compile([e.pubkey,As.OP_CHECKSIG])}),wr.prop(i,"pubkey",()=>{if(e.output)return e.output.slice(1,-1)}),wr.prop(i,"signature",()=>{if(e.input)return r()[0]}),wr.prop(i,"input",()=>{if(e.signature)return mr.compile([e.signature])}),wr.prop(i,"witness",()=>{if(i.input)return[]}),t.validate){if(e.output){if(e.output[e.output.length-1]!==As.OP_CHECKSIG)throw new TypeError("Output is invalid");if(!(0,Ge.isPoint)(i.pubkey))throw new TypeError("Output pubkey is invalid");if(e.pubkey&&!e.pubkey.equals(i.pubkey))throw new TypeError("Pubkey mismatch")}if(e.signature&&e.input&&!e.input.equals(i.input))throw new TypeError("Signature mismatch");if(e.input){if(r().length!==1)throw new TypeError("Input is invalid");if(!mr.isCanonicalScriptSignature(i.signature))throw new TypeError("Input has invalid signature")}}return Object.assign(i,e)}ui.p2pk=Dc;var ci={},rt={},xr={},Lr={},Oe={};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.output=Oe.exists=Oe.hash=Oe.bytes=Oe.bool=Oe.number=void 0;function Yn(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}Oe.number=Yn;function ea(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}Oe.bool=ea;function Fo(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}Oe.bytes=Fo;function ta(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Yn(e.outputLen),Yn(e.blockLen)}Oe.hash=ta;function ra(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}Oe.exists=ra;function na(e,t){Fo(e);const r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}Oe.output=na;const Kc={number:Yn,bool:ea,bytes:Fo,hash:ta,exists:ra,output:na};Oe.default=Kc;var gn={},li={};Object.defineProperty(li,"__esModule",{value:!0});li.crypto=void 0;li.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;(function(e){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(e,"__esModule",{value:!0}),e.randomBytes=e.wrapXOFConstructorWithOpts=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.rotr=e.createView=e.u32=e.u8=void 0;const t=li,r=_=>_ instanceof Uint8Array,n=_=>new Uint8Array(_.buffer,_.byteOffset,_.byteLength);e.u8=n;const i=_=>new Uint32Array(_.buffer,_.byteOffset,Math.floor(_.byteLength/4));e.u32=i;const o=_=>new DataView(_.buffer,_.byteOffset,_.byteLength);e.createView=o;const s=(_,O)=>_<<32-O|_>>>O;if(e.rotr=s,e.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,!e.isLE)throw new Error("Non little-endian hardware is not supported");const f=Array.from({length:256},(_,O)=>O.toString(16).padStart(2,"0"));function a(_){if(!r(_))throw new Error("Uint8Array expected");let O="";for(let x=0;x<_.length;x++)O+=f[_[x]];return O}e.bytesToHex=a;function u(_){if(typeof _!="string")throw new Error("hex string expected, got "+typeof _);const O=_.length;if(O%2)throw new Error("padded hex string expected, got unpadded hex of length "+O);const x=new Uint8Array(O/2);for(let m=0;m<x.length;m++){const N=m*2,F=_.slice(N,N+2),J=Number.parseInt(F,16);if(Number.isNaN(J)||J<0)throw new Error("Invalid byte sequence");x[m]=J}return x}e.hexToBytes=u;const l=async()=>{};e.nextTick=l;async function c(_,O,x){let m=Date.now();for(let N=0;N<_;N++){x(N);const F=Date.now()-m;F>=0&&F<O||(await(0,e.nextTick)(),m+=F)}}e.asyncLoop=c;function b(_){if(typeof _!="string")throw new Error(`utf8ToBytes expected string, got ${typeof _}`);return new Uint8Array(new TextEncoder().encode(_))}e.utf8ToBytes=b;function p(_){if(typeof _=="string"&&(_=b(_)),!r(_))throw new Error(`expected Uint8Array, got ${typeof _}`);return _}e.toBytes=p;function y(..._){const O=new Uint8Array(_.reduce((m,N)=>m+N.length,0));let x=0;return _.forEach(m=>{if(!r(m))throw new Error("Uint8Array expected");O.set(m,x),x+=m.length}),O}e.concatBytes=y;class g{clone(){return this._cloneInto()}}e.Hash=g;const w=_=>Object.prototype.toString.call(_)==="[object Object]"&&_.constructor===Object;function v(_,O){if(O!==void 0&&(typeof O!="object"||!w(O)))throw new Error("Options should be object or undefined");return Object.assign(_,O)}e.checkOpts=v;function I(_){const O=m=>_().update(p(m)).digest(),x=_();return O.outputLen=x.outputLen,O.blockLen=x.blockLen,O.create=()=>_(),O}e.wrapConstructor=I;function P(_){const O=(m,N)=>_(N).update(p(m)).digest(),x=_({});return O.outputLen=x.outputLen,O.blockLen=x.blockLen,O.create=m=>_(m),O}e.wrapConstructorWithOpts=P;function T(_){const O=(m,N)=>_(N).update(p(m)).digest(),x=_({});return O.outputLen=x.outputLen,O.blockLen=x.blockLen,O.create=m=>_(m),O}e.wrapXOFConstructorWithOpts=T;function A(_=32){if(t.crypto&&typeof t.crypto.getRandomValues=="function")return t.crypto.getRandomValues(new Uint8Array(_));throw new Error("crypto.getRandomValues must be defined")}e.randomBytes=A})(gn);Object.defineProperty(Lr,"__esModule",{value:!0});Lr.SHA2=void 0;const ji=Oe,qr=gn;function Wc(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);const i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),f=Number(r&o),a=n?4:0,u=n?0:4;e.setUint32(t+a,s,n),e.setUint32(t+u,f,n)}class jc extends qr.Hash{constructor(t,r,n,i){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,qr.createView)(this.buffer)}update(t){ji.default.exists(this);const{view:r,buffer:n,blockLen:i}=this;t=(0,qr.toBytes)(t);const o=t.length;for(let s=0;s<o;){const f=Math.min(i-this.pos,o-s);if(f===i){const a=(0,qr.createView)(t);for(;i<=o-s;s+=i)this.process(a,s);continue}n.set(t.subarray(s,s+f),this.pos),this.pos+=f,s+=f,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){ji.default.exists(this),ji.default.output(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:o}=this;let{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let c=s;c<i;c++)r[c]=0;Wc(n,i-8,BigInt(this.length*8),o),this.process(n,0);const f=(0,qr.createView)(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=a/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let c=0;c<u;c++)f.setUint32(4*c,l[c],o)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:o,destroyed:s,pos:f}=this;return t.length=i,t.pos=f,t.finished=o,t.destroyed=s,i%r&&t.buffer.set(n),t}}Lr.SHA2=jc;Object.defineProperty(xr,"__esModule",{value:!0});xr.ripemd160=xr.RIPEMD160=void 0;const Vc=Lr,Gc=gn,qc=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),ia=Uint8Array.from({length:16},(e,t)=>t),Xc=ia.map(e=>(9*e+5)%16);let Do=[ia],Ko=[Xc];for(let e=0;e<4;e++)for(let t of[Do,Ko])t.push(t[e].map(r=>qc[r]));const oa=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>new Uint8Array(e)),Yc=Do.map((e,t)=>e.map(r=>oa[t][r])),zc=Ko.map((e,t)=>e.map(r=>oa[t][r])),Jc=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),Qc=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),On=(e,t)=>e<<t|e>>>32-t;function ks(e,t,r,n){return e===0?t^r^n:e===1?t&r|~t&n:e===2?(t|~r)^n:e===3?t&n|r&~n:t^(r|~n)}const Bn=new Uint32Array(16);let sa=class extends Vc.SHA2{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:r,h2:n,h3:i,h4:o}=this;return[t,r,n,i,o]}set(t,r,n,i,o){this.h0=t|0,this.h1=r|0,this.h2=n|0,this.h3=i|0,this.h4=o|0}process(t,r){for(let p=0;p<16;p++,r+=4)Bn[p]=t.getUint32(r,!0);let n=this.h0|0,i=n,o=this.h1|0,s=o,f=this.h2|0,a=f,u=this.h3|0,l=u,c=this.h4|0,b=c;for(let p=0;p<5;p++){const y=4-p,g=Jc[p],w=Qc[p],v=Do[p],I=Ko[p],P=Yc[p],T=zc[p];for(let A=0;A<16;A++){const _=On(n+ks(p,o,f,u)+Bn[v[A]]+g,P[A])+c|0;n=c,c=u,u=On(f,10)|0,f=o,o=_}for(let A=0;A<16;A++){const _=On(i+ks(y,s,a,l)+Bn[I[A]]+w,T[A])+b|0;i=b,b=l,l=On(a,10)|0,a=s,s=_}}this.set(this.h1+f+l|0,this.h2+u+b|0,this.h3+c+i|0,this.h4+n+s|0,this.h0+o+a|0)}roundClean(){Bn.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}};xr.RIPEMD160=sa;xr.ripemd160=(0,Gc.wrapConstructor)(()=>new sa);var hi={};Object.defineProperty(hi,"__esModule",{value:!0});hi.sha1=void 0;const Zc=Lr,el=gn,Vi=(e,t)=>e<<t|e>>>32-t>>>0,tl=(e,t,r)=>e&t^~e&r,rl=(e,t,r)=>e&t^e&r^t&r,Xr=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),vt=new Uint32Array(80);class nl extends Zc.SHA2{constructor(){super(64,20,8,!1),this.A=Xr[0]|0,this.B=Xr[1]|0,this.C=Xr[2]|0,this.D=Xr[3]|0,this.E=Xr[4]|0}get(){const{A:t,B:r,C:n,D:i,E:o}=this;return[t,r,n,i,o]}set(t,r,n,i,o){this.A=t|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0}process(t,r){for(let a=0;a<16;a++,r+=4)vt[a]=t.getUint32(r,!1);for(let a=16;a<80;a++)vt[a]=Vi(vt[a-3]^vt[a-8]^vt[a-14]^vt[a-16],1);let{A:n,B:i,C:o,D:s,E:f}=this;for(let a=0;a<80;a++){let u,l;a<20?(u=tl(i,o,s),l=1518500249):a<40?(u=i^o^s,l=1859775393):a<60?(u=rl(i,o,s),l=2400959708):(u=i^o^s,l=3395469782);const c=Vi(n,5)+u+f+l+vt[a]|0;f=s,s=o,o=Vi(i,30),i=n,n=c}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,f=f+this.E|0,this.set(n,i,o,s,f)}roundClean(){vt.fill(0)}destroy(){this.set(0,0,0,0,0),this.buffer.fill(0)}}hi.sha1=(0,el.wrapConstructor)(()=>new nl);var jt={};Object.defineProperty(jt,"__esModule",{value:!0});jt.sha224=jt.sha256=void 0;const il=Lr,$e=gn,ol=(e,t,r)=>e&t^~e&r,sl=(e,t,r)=>e&t^e&r^t&r,fl=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),mt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Tt=new Uint32Array(64);class fa extends il.SHA2{constructor(){super(64,32,8,!1),this.A=mt[0]|0,this.B=mt[1]|0,this.C=mt[2]|0,this.D=mt[3]|0,this.E=mt[4]|0,this.F=mt[5]|0,this.G=mt[6]|0,this.H=mt[7]|0}get(){const{A:t,B:r,C:n,D:i,E:o,F:s,G:f,H:a}=this;return[t,r,n,i,o,s,f,a]}set(t,r,n,i,o,s,f,a){this.A=t|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=f|0,this.H=a|0}process(t,r){for(let c=0;c<16;c++,r+=4)Tt[c]=t.getUint32(r,!1);for(let c=16;c<64;c++){const b=Tt[c-15],p=Tt[c-2],y=(0,$e.rotr)(b,7)^(0,$e.rotr)(b,18)^b>>>3,g=(0,$e.rotr)(p,17)^(0,$e.rotr)(p,19)^p>>>10;Tt[c]=g+Tt[c-7]+y+Tt[c-16]|0}let{A:n,B:i,C:o,D:s,E:f,F:a,G:u,H:l}=this;for(let c=0;c<64;c++){const b=(0,$e.rotr)(f,6)^(0,$e.rotr)(f,11)^(0,$e.rotr)(f,25),p=l+b+ol(f,a,u)+fl[c]+Tt[c]|0,g=((0,$e.rotr)(n,2)^(0,$e.rotr)(n,13)^(0,$e.rotr)(n,22))+sl(n,i,o)|0;l=u,u=a,a=f,f=s+p|0,s=o,o=i,i=n,n=p+g|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,f=f+this.E|0,a=a+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(n,i,o,s,f,a,u,l)}roundClean(){Tt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class al extends fa{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}jt.sha256=(0,$e.wrapConstructor)(()=>new fa);jt.sha224=(0,$e.wrapConstructor)(()=>new al);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.taggedHash=e.TAGGED_HASH_PREFIXES=e.TAGS=e.hash256=e.hash160=e.sha256=e.sha1=e.ripemd160=void 0;const t=xr,r=hi,n=jt;function i(l){return Buffer.from((0,t.ripemd160)(Uint8Array.from(l)))}e.ripemd160=i;function o(l){return Buffer.from((0,r.sha1)(Uint8Array.from(l)))}e.sha1=o;function s(l){return Buffer.from((0,n.sha256)(Uint8Array.from(l)))}e.sha256=s;function f(l){return Buffer.from((0,t.ripemd160)((0,n.sha256)(Uint8Array.from(l))))}e.hash160=f;function a(l){return Buffer.from((0,n.sha256)((0,n.sha256)(Uint8Array.from(l))))}e.hash256=a,e.TAGS=["BIP0340/challenge","BIP0340/aux","BIP0340/nonce","TapLeaf","TapBranch","TapSighash","TapTweak","KeyAgg list","KeyAgg coefficient"],e.TAGGED_HASH_PREFIXES={"BIP0340/challenge":Buffer.from([123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124,123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124]),"BIP0340/aux":Buffer.from([241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144,241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144]),"BIP0340/nonce":Buffer.from([7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47,7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47]),TapLeaf:Buffer.from([174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238,174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238]),TapBranch:Buffer.from([25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21,25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21]),TapSighash:Buffer.from([244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49,244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49]),TapTweak:Buffer.from([232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233,232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233]),"KeyAgg list":Buffer.from([72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240,72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240]),"KeyAgg coefficient":Buffer.from([191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129,191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129])};function u(l,c){return s(Buffer.concat([e.TAGGED_HASH_PREFIXES[l],c]))}e.taggedHash=u})(rt);function ul(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var n=0;n<e.length;n++){var i=e.charAt(n),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=n}var s=e.length,f=e.charAt(0),a=Math.log(s)/Math.log(256),u=Math.log(256)/Math.log(s);function l(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,g=0,w=0,v=p.length;w!==v&&p[w]===0;)w++,y++;for(var I=(v-w)*u+1>>>0,P=new Uint8Array(I);w!==v;){for(var T=p[w],A=0,_=I-1;(T!==0||A<g)&&_!==-1;_--,A++)T+=256*P[_]>>>0,P[_]=T%s>>>0,T=T/s>>>0;if(T!==0)throw new Error("Non-zero carry");g=A,w++}for(var O=I-g;O!==I&&P[O]===0;)O++;for(var x=f.repeat(y);O<I;++O)x+=e.charAt(P[O]);return x}function c(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;for(var y=0,g=0,w=0;p[y]===f;)g++,y++;for(var v=(p.length-y)*a+1>>>0,I=new Uint8Array(v);p[y];){var P=t[p.charCodeAt(y)];if(P===255)return;for(var T=0,A=v-1;(P!==0||T<w)&&A!==-1;A--,T++)P+=s*I[A]>>>0,I[A]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");w=T,y++}for(var _=v-w;_!==v&&I[_]===0;)_++;for(var O=new Uint8Array(g+(v-_)),x=g;_!==v;)O[x++]=I[_++];return O}function b(p){var y=c(p);if(y)return y;throw new Error("Non-base"+s+" character")}return{encode:l,decodeUnsafe:c,decode:b}}var cl=ul;const ll=cl,hl="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";var dl=ll(hl),Gi=dl,pl=function(e){function t(o){var s=Uint8Array.from(o),f=e(s),a=s.length+4,u=new Uint8Array(a);return u.set(s,0),u.set(f.subarray(0,4),s.length),Gi.encode(u,a)}function r(o){var s=o.slice(0,-4),f=o.slice(-4),a=e(s);if(!(f[0]^a[0]|f[1]^a[1]|f[2]^a[2]|f[3]^a[3]))return s}function n(o){var s=Gi.decodeUnsafe(o);if(s)return r(s)}function i(o){var s=Gi.decode(o),f=r(s);if(!f)throw new Error("Invalid checksum");return f}return{encode:t,decode:i,decodeUnsafe:n}},{sha256:Os}=jt,yl=pl;function _l(e){return Os(Os(e))}var Wo=yl(_l);Object.defineProperty(ci,"__esModule",{value:!0});ci.p2pkh=void 0;const qi=rt,bl=le,Tr=Be,me=be,ut=Ce,Bs=Wo,Pt=Tr.OPS;function gl(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.input)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,me.typeforce)({network:me.typeforce.maybe(me.typeforce.Object),address:me.typeforce.maybe(me.typeforce.String),hash:me.typeforce.maybe(me.typeforce.BufferN(20)),output:me.typeforce.maybe(me.typeforce.BufferN(25)),pubkey:me.typeforce.maybe(me.isPoint),signature:me.typeforce.maybe(Tr.isCanonicalScriptSignature),input:me.typeforce.maybe(me.typeforce.Buffer)},e);const r=ut.value(()=>{const s=Buffer.from(Bs.decode(e.address)),f=s.readUInt8(0),a=s.slice(1);return{version:f,hash:a}}),n=ut.value(()=>Tr.decompile(e.input)),i=e.network||bl.bitcoin,o={name:"p2pkh",network:i};if(ut.prop(o,"address",()=>{if(!o.hash)return;const s=Buffer.allocUnsafe(21);return s.writeUInt8(i.pubKeyHash,0),o.hash.copy(s,1),Bs.encode(s)}),ut.prop(o,"hash",()=>{if(e.output)return e.output.slice(3,23);if(e.address)return r().hash;if(e.pubkey||o.pubkey)return qi.hash160(e.pubkey||o.pubkey)}),ut.prop(o,"output",()=>{if(o.hash)return Tr.compile([Pt.OP_DUP,Pt.OP_HASH160,o.hash,Pt.OP_EQUALVERIFY,Pt.OP_CHECKSIG])}),ut.prop(o,"pubkey",()=>{if(e.input)return n()[1]}),ut.prop(o,"signature",()=>{if(e.input)return n()[0]}),ut.prop(o,"input",()=>{if(e.pubkey&&e.signature)return Tr.compile([e.signature,e.pubkey])}),ut.prop(o,"witness",()=>{if(o.input)return[]}),t.validate){let s=Buffer.from([]);if(e.address){if(r().version!==i.pubKeyHash)throw new TypeError("Invalid version or Network mismatch");if(r().hash.length!==20)throw new TypeError("Invalid address");s=r().hash}if(e.hash){if(s.length>0&&!s.equals(e.hash))throw new TypeError("Hash mismatch");s=e.hash}if(e.output){if(e.output.length!==25||e.output[0]!==Pt.OP_DUP||e.output[1]!==Pt.OP_HASH160||e.output[2]!==20||e.output[23]!==Pt.OP_EQUALVERIFY||e.output[24]!==Pt.OP_CHECKSIG)throw new TypeError("Output is invalid");const f=e.output.slice(3,23);if(s.length>0&&!s.equals(f))throw new TypeError("Hash mismatch");s=f}if(e.pubkey){const f=qi.hash160(e.pubkey);if(s.length>0&&!s.equals(f))throw new TypeError("Hash mismatch");s=f}if(e.input){const f=n();if(f.length!==2)throw new TypeError("Input is invalid");if(!Tr.isCanonicalScriptSignature(f[0]))throw new TypeError("Input has invalid signature");if(!(0,me.isPoint)(f[1]))throw new TypeError("Input has invalid pubkey");if(e.signature&&!e.signature.equals(f[0]))throw new TypeError("Signature mismatch");if(e.pubkey&&!e.pubkey.equals(f[1]))throw new TypeError("Pubkey mismatch");const a=qi.hash160(f[1]);if(s.length>0&&!s.equals(a))throw new TypeError("Hash mismatch")}}return Object.assign(o,e)}ci.p2pkh=gl;var di={};Object.defineProperty(di,"__esModule",{value:!0});di.p2sh=void 0;const xs=rt,wl=le,Qe=Be,Q=be,ze=Ce,Rs=Wo,Yr=Qe.OPS;function El(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}function Sl(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.input)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,Q.typeforce)({network:Q.typeforce.maybe(Q.typeforce.Object),address:Q.typeforce.maybe(Q.typeforce.String),hash:Q.typeforce.maybe(Q.typeforce.BufferN(20)),output:Q.typeforce.maybe(Q.typeforce.BufferN(23)),redeem:Q.typeforce.maybe({network:Q.typeforce.maybe(Q.typeforce.Object),output:Q.typeforce.maybe(Q.typeforce.Buffer),input:Q.typeforce.maybe(Q.typeforce.Buffer),witness:Q.typeforce.maybe(Q.typeforce.arrayOf(Q.typeforce.Buffer))}),input:Q.typeforce.maybe(Q.typeforce.Buffer),witness:Q.typeforce.maybe(Q.typeforce.arrayOf(Q.typeforce.Buffer))},e);let r=e.network;r||(r=e.redeem&&e.redeem.network||wl.bitcoin);const n={network:r},i=ze.value(()=>{const f=Buffer.from(Rs.decode(e.address)),a=f.readUInt8(0),u=f.slice(1);return{version:a,hash:u}}),o=ze.value(()=>Qe.decompile(e.input)),s=ze.value(()=>{const f=o(),a=f[f.length-1];return{network:r,output:a===Yr.OP_FALSE?Buffer.from([]):a,input:Qe.compile(f.slice(0,-1)),witness:e.witness||[]}});if(ze.prop(n,"address",()=>{if(!n.hash)return;const f=Buffer.allocUnsafe(21);return f.writeUInt8(n.network.scriptHash,0),n.hash.copy(f,1),Rs.encode(f)}),ze.prop(n,"hash",()=>{if(e.output)return e.output.slice(2,22);if(e.address)return i().hash;if(n.redeem&&n.redeem.output)return xs.hash160(n.redeem.output)}),ze.prop(n,"output",()=>{if(n.hash)return Qe.compile([Yr.OP_HASH160,n.hash,Yr.OP_EQUAL])}),ze.prop(n,"redeem",()=>{if(e.input)return s()}),ze.prop(n,"input",()=>{if(!(!e.redeem||!e.redeem.input||!e.redeem.output))return Qe.compile([].concat(Qe.decompile(e.redeem.input),e.redeem.output))}),ze.prop(n,"witness",()=>{if(n.redeem&&n.redeem.witness)return n.redeem.witness;if(n.input)return[]}),ze.prop(n,"name",()=>{const f=["p2sh"];return n.redeem!==void 0&&n.redeem.name!==void 0&&f.push(n.redeem.name),f.join("-")}),t.validate){let f=Buffer.from([]);if(e.address){if(i().version!==r.scriptHash)throw new TypeError("Invalid version or Network mismatch");if(i().hash.length!==20)throw new TypeError("Invalid address");f=i().hash}if(e.hash){if(f.length>0&&!f.equals(e.hash))throw new TypeError("Hash mismatch");f=e.hash}if(e.output){if(e.output.length!==23||e.output[0]!==Yr.OP_HASH160||e.output[1]!==20||e.output[22]!==Yr.OP_EQUAL)throw new TypeError("Output is invalid");const u=e.output.slice(2,22);if(f.length>0&&!f.equals(u))throw new TypeError("Hash mismatch");f=u}const a=u=>{if(u.output){const l=Qe.decompile(u.output);if(!l||l.length<1)throw new TypeError("Redeem.output too short");if(u.output.byteLength>520)throw new TypeError("Redeem.output unspendable if larger than 520 bytes");if(Qe.countNonPushOnlyOPs(l)>201)throw new TypeError("Redeem.output unspendable with more than 201 non-push ops");const c=xs.hash160(u.output);if(f.length>0&&!f.equals(c))throw new TypeError("Hash mismatch");f=c}if(u.input){const l=u.input.length>0,c=u.witness&&u.witness.length>0;if(!l&&!c)throw new TypeError("Empty input");if(l&&c)throw new TypeError("Input and witness provided");if(l){const b=Qe.decompile(u.input);if(!Qe.isPushOnly(b))throw new TypeError("Non push-only scriptSig")}}};if(e.input){const u=o();if(!u||u.length<1)throw new TypeError("Input too short");if(!Buffer.isBuffer(s().output))throw new TypeError("Input is invalid");a(s())}if(e.redeem){if(e.redeem.network&&e.redeem.network!==r)throw new TypeError("Network mismatch");if(e.input){const u=s();if(e.redeem.output&&!e.redeem.output.equals(u.output))throw new TypeError("Redeem.output mismatch");if(e.redeem.input&&!e.redeem.input.equals(u.input))throw new TypeError("Redeem.input mismatch")}a(e.redeem)}if(e.witness&&e.redeem&&e.redeem.witness&&!El(e.redeem.witness,e.witness))throw new TypeError("Witness and redeem.witness mismatch")}return Object.assign(n,e)}di.p2sh=Sl;var pi={},gt={};Object.defineProperty(gt,"__esModule",{value:!0});gt.bech32m=gt.bech32=void 0;const zn="qpzry9x8gf2tvdw0s3jn54khce6mua7l",aa={};for(let e=0;e<zn.length;e++){const t=zn.charAt(e);aa[t]=e}function Ir(e){const t=e>>25;return(e&33554431)<<5^-(t>>0&1)&996825010^-(t>>1&1)&642813549^-(t>>2&1)&513874426^-(t>>3&1)&1027748829^-(t>>4&1)&705979059}function Ns(e){let t=1;for(let r=0;r<e.length;++r){const n=e.charCodeAt(r);if(n<33||n>126)return"Invalid prefix ("+e+")";t=Ir(t)^n>>5}t=Ir(t);for(let r=0;r<e.length;++r){const n=e.charCodeAt(r);t=Ir(t)^n&31}return t}function jo(e,t,r,n){let i=0,o=0;const s=(1<<r)-1,f=[];for(let a=0;a<e.length;++a)for(i=i<<t|e[a],o+=t;o>=r;)o-=r,f.push(i>>o&s);if(n)o>0&&f.push(i<<r-o&s);else{if(o>=t)return"Excess padding";if(i<<r-o&s)return"Non-zero padding"}return f}function vl(e){return jo(e,8,5,!0)}function ml(e){const t=jo(e,5,8,!1);if(Array.isArray(t))return t}function Tl(e){const t=jo(e,5,8,!1);if(Array.isArray(t))return t;throw new Error(t)}function ua(e){let t;e==="bech32"?t=1:t=734539939;function r(s,f,a){if(a=a||90,s.length+7+f.length>a)throw new TypeError("Exceeds length limit");s=s.toLowerCase();let u=Ns(s);if(typeof u=="string")throw new Error(u);let l=s+"1";for(let c=0;c<f.length;++c){const b=f[c];if(b>>5)throw new Error("Non 5-bit word");u=Ir(u)^b,l+=zn.charAt(b)}for(let c=0;c<6;++c)u=Ir(u);u^=t;for(let c=0;c<6;++c){const b=u>>(5-c)*5&31;l+=zn.charAt(b)}return l}function n(s,f){if(f=f||90,s.length<8)return s+" too short";if(s.length>f)return"Exceeds length limit";const a=s.toLowerCase(),u=s.toUpperCase();if(s!==a&&s!==u)return"Mixed-case string "+s;s=a;const l=s.lastIndexOf("1");if(l===-1)return"No separator character for "+s;if(l===0)return"Missing prefix for "+s;const c=s.slice(0,l),b=s.slice(l+1);if(b.length<6)return"Data too short";let p=Ns(c);if(typeof p=="string")return p;const y=[];for(let g=0;g<b.length;++g){const w=b.charAt(g),v=aa[w];if(v===void 0)return"Unknown character "+w;p=Ir(p)^v,!(g+6>=b.length)&&y.push(v)}return p!==t?"Invalid checksum for "+s:{prefix:c,words:y}}function i(s,f){const a=n(s,f);if(typeof a=="object")return a}function o(s,f){const a=n(s,f);if(typeof a=="object")return a;throw new Error(a)}return{decodeUnsafe:i,decode:o,encode:r,toWords:vl,fromWordsUnsafe:ml,fromWords:Tl}}gt.bech32=ua("bech32");gt.bech32m=ua("bech32m");Object.defineProperty(pi,"__esModule",{value:!0});pi.p2wpkh=void 0;const Xi=rt,Pl=le,Wn=Be,fe=be,It=Ce,xn=gt,Us=Wn.OPS,Il=Buffer.alloc(0);function Al(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.witness)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,fe.typeforce)({address:fe.typeforce.maybe(fe.typeforce.String),hash:fe.typeforce.maybe(fe.typeforce.BufferN(20)),input:fe.typeforce.maybe(fe.typeforce.BufferN(0)),network:fe.typeforce.maybe(fe.typeforce.Object),output:fe.typeforce.maybe(fe.typeforce.BufferN(22)),pubkey:fe.typeforce.maybe(fe.isPoint),signature:fe.typeforce.maybe(Wn.isCanonicalScriptSignature),witness:fe.typeforce.maybe(fe.typeforce.arrayOf(fe.typeforce.Buffer))},e);const r=It.value(()=>{const o=xn.bech32.decode(e.address),s=o.words.shift(),f=xn.bech32.fromWords(o.words);return{version:s,prefix:o.prefix,data:Buffer.from(f)}}),n=e.network||Pl.bitcoin,i={name:"p2wpkh",network:n};if(It.prop(i,"address",()=>{if(!i.hash)return;const o=xn.bech32.toWords(i.hash);return o.unshift(0),xn.bech32.encode(n.bech32,o)}),It.prop(i,"hash",()=>{if(e.output)return e.output.slice(2,22);if(e.address)return r().data;if(e.pubkey||i.pubkey)return Xi.hash160(e.pubkey||i.pubkey)}),It.prop(i,"output",()=>{if(i.hash)return Wn.compile([Us.OP_0,i.hash])}),It.prop(i,"pubkey",()=>{if(e.pubkey)return e.pubkey;if(e.witness)return e.witness[1]}),It.prop(i,"signature",()=>{if(e.witness)return e.witness[0]}),It.prop(i,"input",()=>{if(i.witness)return Il}),It.prop(i,"witness",()=>{if(e.pubkey&&e.signature)return[e.signature,e.pubkey]}),t.validate){let o=Buffer.from([]);if(e.address){if(n&&n.bech32!==r().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==0)throw new TypeError("Invalid address version");if(r().data.length!==20)throw new TypeError("Invalid address data");o=r().data}if(e.hash){if(o.length>0&&!o.equals(e.hash))throw new TypeError("Hash mismatch");o=e.hash}if(e.output){if(e.output.length!==22||e.output[0]!==Us.OP_0||e.output[1]!==20)throw new TypeError("Output is invalid");if(o.length>0&&!o.equals(e.output.slice(2)))throw new TypeError("Hash mismatch");o=e.output.slice(2)}if(e.pubkey){const s=Xi.hash160(e.pubkey);if(o.length>0&&!o.equals(s))throw new TypeError("Hash mismatch");if(o=s,!(0,fe.isPoint)(e.pubkey)||e.pubkey.length!==33)throw new TypeError("Invalid pubkey for p2wpkh")}if(e.witness){if(e.witness.length!==2)throw new TypeError("Witness is invalid");if(!Wn.isCanonicalScriptSignature(e.witness[0]))throw new TypeError("Witness has invalid signature");if(!(0,fe.isPoint)(e.witness[1])||e.witness[1].length!==33)throw new TypeError("Witness has invalid pubkey");if(e.signature&&!e.signature.equals(e.witness[0]))throw new TypeError("Signature mismatch");if(e.pubkey&&!e.pubkey.equals(e.witness[1]))throw new TypeError("Pubkey mismatch");const s=Xi.hash160(e.witness[1]);if(o.length>0&&!o.equals(s))throw new TypeError("Hash mismatch")}}return Object.assign(i,e)}pi.p2wpkh=Al;var yi={};Object.defineProperty(yi,"__esModule",{value:!0});yi.p2wsh=void 0;const Cs=rt,kl=le,ht=Be,z=be,ct=Ce,Rn=gt,Hs=ht.OPS,Yi=Buffer.alloc(0);function Ol(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}function Nn(e){return!!(Buffer.isBuffer(e)&&e.length===65&&e[0]===4&&(0,z.isPoint)(e))}function Bl(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.witness)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,z.typeforce)({network:z.typeforce.maybe(z.typeforce.Object),address:z.typeforce.maybe(z.typeforce.String),hash:z.typeforce.maybe(z.typeforce.BufferN(32)),output:z.typeforce.maybe(z.typeforce.BufferN(34)),redeem:z.typeforce.maybe({input:z.typeforce.maybe(z.typeforce.Buffer),network:z.typeforce.maybe(z.typeforce.Object),output:z.typeforce.maybe(z.typeforce.Buffer),witness:z.typeforce.maybe(z.typeforce.arrayOf(z.typeforce.Buffer))}),input:z.typeforce.maybe(z.typeforce.BufferN(0)),witness:z.typeforce.maybe(z.typeforce.arrayOf(z.typeforce.Buffer))},e);const r=ct.value(()=>{const s=Rn.bech32.decode(e.address),f=s.words.shift(),a=Rn.bech32.fromWords(s.words);return{version:f,prefix:s.prefix,data:Buffer.from(a)}}),n=ct.value(()=>ht.decompile(e.redeem.input));let i=e.network;i||(i=e.redeem&&e.redeem.network||kl.bitcoin);const o={network:i};if(ct.prop(o,"address",()=>{if(!o.hash)return;const s=Rn.bech32.toWords(o.hash);return s.unshift(0),Rn.bech32.encode(i.bech32,s)}),ct.prop(o,"hash",()=>{if(e.output)return e.output.slice(2);if(e.address)return r().data;if(o.redeem&&o.redeem.output)return Cs.sha256(o.redeem.output)}),ct.prop(o,"output",()=>{if(o.hash)return ht.compile([Hs.OP_0,o.hash])}),ct.prop(o,"redeem",()=>{if(e.witness)return{output:e.witness[e.witness.length-1],input:Yi,witness:e.witness.slice(0,-1)}}),ct.prop(o,"input",()=>{if(o.witness)return Yi}),ct.prop(o,"witness",()=>{if(e.redeem&&e.redeem.input&&e.redeem.input.length>0&&e.redeem.output&&e.redeem.output.length>0){const s=ht.toStack(n());return o.redeem=Object.assign({witness:s},e.redeem),o.redeem.input=Yi,[].concat(s,e.redeem.output)}if(e.redeem&&e.redeem.output&&e.redeem.witness)return[].concat(e.redeem.witness,e.redeem.output)}),ct.prop(o,"name",()=>{const s=["p2wsh"];return o.redeem!==void 0&&o.redeem.name!==void 0&&s.push(o.redeem.name),s.join("-")}),t.validate){let s=Buffer.from([]);if(e.address){if(r().prefix!==i.bech32)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==0)throw new TypeError("Invalid address version");if(r().data.length!==32)throw new TypeError("Invalid address data");s=r().data}if(e.hash){if(s.length>0&&!s.equals(e.hash))throw new TypeError("Hash mismatch");s=e.hash}if(e.output){if(e.output.length!==34||e.output[0]!==Hs.OP_0||e.output[1]!==32)throw new TypeError("Output is invalid");const f=e.output.slice(2);if(s.length>0&&!s.equals(f))throw new TypeError("Hash mismatch");s=f}if(e.redeem){if(e.redeem.network&&e.redeem.network!==i)throw new TypeError("Network mismatch");if(e.redeem.input&&e.redeem.input.length>0&&e.redeem.witness&&e.redeem.witness.length>0)throw new TypeError("Ambiguous witness source");if(e.redeem.output){const f=ht.decompile(e.redeem.output);if(!f||f.length<1)throw new TypeError("Redeem.output is invalid");if(e.redeem.output.byteLength>3600)throw new TypeError("Redeem.output unspendable if larger than 3600 bytes");if(ht.countNonPushOnlyOPs(f)>201)throw new TypeError("Redeem.output unspendable with more than 201 non-push ops");const a=Cs.sha256(e.redeem.output);if(s.length>0&&!s.equals(a))throw new TypeError("Hash mismatch");s=a}if(e.redeem.input&&!ht.isPushOnly(n()))throw new TypeError("Non push-only scriptSig");if(e.witness&&e.redeem.witness&&!Ol(e.witness,e.redeem.witness))throw new TypeError("Witness and redeem.witness mismatch");if(e.redeem.input&&n().some(Nn)||e.redeem.output&&(ht.decompile(e.redeem.output)||[]).some(Nn))throw new TypeError("redeem.input or redeem.output contains uncompressed pubkey")}if(e.witness&&e.witness.length>0){const f=e.witness[e.witness.length-1];if(e.redeem&&e.redeem.output&&!e.redeem.output.equals(f))throw new TypeError("Witness and redeem.output mismatch");if(e.witness.some(Nn)||(ht.decompile(f)||[]).some(Nn))throw new TypeError("Witness contains uncompressed pubkey")}}return Object.assign(o,e)}yi.p2wsh=Bl;var _i={},Nt={};Object.defineProperty(Nt,"__esModule",{value:!0});Nt.getEccLib=Nt.initEccLib=void 0;const un={};function xl(e){e?e!==un.eccLib&&(Nl(e),un.eccLib=e):un.eccLib=e}Nt.initEccLib=xl;function Rl(){if(!un.eccLib)throw new Error("No ECC Library provided. You must call initEccLib() with a valid TinySecp256k1Interface instance");return un.eccLib}Nt.getEccLib=Rl;const lt=e=>Buffer.from(e,"hex");function Nl(e){Le(typeof e.isXOnlyPoint=="function"),Le(e.isXOnlyPoint(lt("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),Le(e.isXOnlyPoint(lt("fffffffffffffffffffffffffffffffffffffffffffffffffffffffeeffffc2e"))),Le(e.isXOnlyPoint(lt("f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9"))),Le(e.isXOnlyPoint(lt("0000000000000000000000000000000000000000000000000000000000000001"))),Le(!e.isXOnlyPoint(lt("0000000000000000000000000000000000000000000000000000000000000000"))),Le(!e.isXOnlyPoint(lt("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"))),Le(typeof e.xOnlyPointAddTweak=="function"),Ul.forEach(t=>{const r=e.xOnlyPointAddTweak(lt(t.pubkey),lt(t.tweak));t.result===null?Le(r===null):(Le(r!==null),Le(r.parity===t.parity),Le(Buffer.from(r.xOnlyPubkey).equals(lt(t.result))))})}function Le(e){if(!e)throw new Error("ecc library invalid")}const Ul=[{pubkey:"79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798",tweak:"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140",parity:-1,result:null},{pubkey:"1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b",tweak:"a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac",parity:1,result:"e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"},{pubkey:"2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991",tweak:"823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47",parity:0,result:"9534f8dc8c6deda2dc007655981c78b49c5d96c778fbf363462a11ec9dfd948c"}];var bi={},ae={},vo={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(e,t){var r=Ct,n=r.Buffer;function i(s,f){for(var a in s)f[a]=s[a]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(i(r,t),t.Buffer=o);function o(s,f,a){return n(s,f,a)}o.prototype=Object.create(n.prototype),i(n,o),o.from=function(s,f,a){if(typeof s=="number")throw new TypeError("Argument must not be a number");return n(s,f,a)},o.alloc=function(s,f,a){if(typeof s!="number")throw new TypeError("Argument must be a number");var u=n(s);return f!==void 0?typeof a=="string"?u.fill(f,a):u.fill(f):u.fill(0),u},o.allocUnsafe=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return n(s)},o.allocUnsafeSlow=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(s)}})(vo,vo.exports);var xe=vo.exports,mo=xe.Buffer,Cl=9007199254740991;function Vo(e){if(e<0||e>Cl||e%1!==0)throw new RangeError("value out of range")}function on(e,t,r){if(Vo(e),t||(t=mo.allocUnsafe(ca(e))),!mo.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");return r||(r=0),e<253?(t.writeUInt8(e,r),on.bytes=1):e<=65535?(t.writeUInt8(253,r),t.writeUInt16LE(e,r+1),on.bytes=3):e<=4294967295?(t.writeUInt8(254,r),t.writeUInt32LE(e,r+1),on.bytes=5):(t.writeUInt8(255,r),t.writeUInt32LE(e>>>0,r+1),t.writeUInt32LE(e/4294967296|0,r+5),on.bytes=9),t}function sn(e,t){if(!mo.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");t||(t=0);var r=e.readUInt8(t);if(r<253)return sn.bytes=1,r;if(r===253)return sn.bytes=3,e.readUInt16LE(t+1);if(r===254)return sn.bytes=5,e.readUInt32LE(t+1);sn.bytes=9;var n=e.readUInt32LE(t+1),i=e.readUInt32LE(t+5),o=i*4294967296+n;return Vo(o),o}function ca(e){return Vo(e),e<253?1:e<=65535?3:e<=4294967295?5:9}var Hl={encode:on,decode:sn,encodingLength:ca};Object.defineProperty(ae,"__esModule",{value:!0});ae.BufferReader=ae.BufferWriter=ae.cloneBuffer=ae.reverseBuffer=ae.writeUInt64LE=ae.readUInt64LE=ae.varuint=void 0;const Wt=be,{typeforce:la}=Wt,dn=Hl;ae.varuint=dn;function ha(e,t){if(typeof e!="number")throw new Error("cannot write a non-number as a number");if(e<0)throw new Error("specified a negative value for writing an unsigned value");if(e>t)throw new Error("RangeError: value out of range");if(Math.floor(e)!==e)throw new Error("value has a fractional component")}function da(e,t){const r=e.readUInt32LE(t);let n=e.readUInt32LE(t+4);return n*=4294967296,ha(n+r,9007199254740991),n+r}ae.readUInt64LE=da;function pa(e,t,r){return ha(t,9007199254740991),e.writeInt32LE(t&-1,r),e.writeUInt32LE(Math.floor(t/4294967296),r+4),r+8}ae.writeUInt64LE=pa;function Ll(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e}ae.reverseBuffer=Ll;function Ml(e){const t=Buffer.allocUnsafe(e.length);return e.copy(t),t}ae.cloneBuffer=Ml;class Go{static withCapacity(t){return new Go(Buffer.alloc(t))}constructor(t,r=0){this.buffer=t,this.offset=r,la(Wt.tuple(Wt.Buffer,Wt.UInt32),[t,r])}writeUInt8(t){this.offset=this.buffer.writeUInt8(t,this.offset)}writeInt32(t){this.offset=this.buffer.writeInt32LE(t,this.offset)}writeUInt32(t){this.offset=this.buffer.writeUInt32LE(t,this.offset)}writeUInt64(t){this.offset=pa(this.buffer,t,this.offset)}writeVarInt(t){dn.encode(t,this.buffer,this.offset),this.offset+=dn.encode.bytes}writeSlice(t){if(this.buffer.length<this.offset+t.length)throw new Error("Cannot write slice out of bounds");this.offset+=t.copy(this.buffer,this.offset)}writeVarSlice(t){this.writeVarInt(t.length),this.writeSlice(t)}writeVector(t){this.writeVarInt(t.length),t.forEach(r=>this.writeVarSlice(r))}end(){if(this.buffer.length===this.offset)return this.buffer;throw new Error(`buffer size ${this.buffer.length}, offset ${this.offset}`)}}ae.BufferWriter=Go;class $l{constructor(t,r=0){this.buffer=t,this.offset=r,la(Wt.tuple(Wt.Buffer,Wt.UInt32),[t,r])}readUInt8(){const t=this.buffer.readUInt8(this.offset);return this.offset++,t}readInt32(){const t=this.buffer.readInt32LE(this.offset);return this.offset+=4,t}readUInt32(){const t=this.buffer.readUInt32LE(this.offset);return this.offset+=4,t}readUInt64(){const t=da(this.buffer,this.offset);return this.offset+=8,t}readVarInt(){const t=dn.decode(this.buffer,this.offset);return this.offset+=dn.decode.bytes,t}readSlice(t){if(this.buffer.length<this.offset+t)throw new Error("Cannot read slice out of bounds");const r=this.buffer.slice(this.offset,this.offset+t);return this.offset+=t,r}readVarSlice(){return this.readSlice(this.readVarInt())}readVector(){const t=this.readVarInt(),r=[];for(let n=0;n<t;n++)r.push(this.readVarSlice());return r}}ae.BufferReader=$l;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.tweakKey=e.tapTweakHash=e.tapleafHash=e.findScriptPath=e.toHashTree=e.rootHashFromPath=e.MAX_TAPTREE_DEPTH=e.LEAF_VERSION_TAPSCRIPT=void 0;const t=Ct,r=Nt,n=rt,i=ae,o=be;e.LEAF_VERSION_TAPSCRIPT=192,e.MAX_TAPTREE_DEPTH=128;const s=g=>"left"in g&&"right"in g;function f(g,w){if(g.length<33)throw new TypeError(`The control-block length is too small. Got ${g.length}, expected min 33.`);const v=(g.length-33)/32;let I=w;for(let P=0;P<v;P++){const T=g.slice(33+32*P,65+32*P);I.compare(T)<0?I=p(I,T):I=p(T,I)}return I}e.rootHashFromPath=f;function a(g){if((0,o.isTapleaf)(g))return{hash:l(g)};const w=[a(g[0]),a(g[1])];w.sort((P,T)=>P.hash.compare(T.hash));const[v,I]=w;return{hash:p(v.hash,I.hash),left:v,right:I}}e.toHashTree=a;function u(g,w){if(s(g)){const v=u(g.left,w);if(v!==void 0)return[...v,g.right.hash];const I=u(g.right,w);if(I!==void 0)return[...I,g.left.hash]}else if(g.hash.equals(w))return[]}e.findScriptPath=u;function l(g){const w=g.version||e.LEAF_VERSION_TAPSCRIPT;return n.taggedHash("TapLeaf",t.Buffer.concat([t.Buffer.from([w]),y(g.output)]))}e.tapleafHash=l;function c(g,w){return n.taggedHash("TapTweak",t.Buffer.concat(w?[g,w]:[g]))}e.tapTweakHash=c;function b(g,w){if(!t.Buffer.isBuffer(g)||g.length!==32||w&&w.length!==32)return null;const v=c(g,w),I=(0,r.getEccLib)().xOnlyPointAddTweak(g,v);return!I||I.xOnlyPubkey===null?null:{parity:I.parity,x:t.Buffer.from(I.xOnlyPubkey)}}e.tweakKey=b;function p(g,w){return n.taggedHash("TapBranch",t.Buffer.concat([g,w]))}function y(g){const w=i.varuint.encodingLength(g.length),v=t.Buffer.allocUnsafe(w);return i.varuint.encode(g.length,v),t.Buffer.concat([v,g])}})(bi);Object.defineProperty(_i,"__esModule",{value:!0});_i.p2tr=void 0;const Un=Ct,Fl=le,To=Be,M=be,Ls=Nt,Ne=bi,Me=Ce,Cn=gt,Ms=To.OPS,$s=1,Dl=80;function Kl(e,t){if(!e.address&&!e.output&&!e.pubkey&&!e.internalPubkey&&!(e.witness&&e.witness.length>1))throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,M.typeforce)({address:M.typeforce.maybe(M.typeforce.String),input:M.typeforce.maybe(M.typeforce.BufferN(0)),network:M.typeforce.maybe(M.typeforce.Object),output:M.typeforce.maybe(M.typeforce.BufferN(34)),internalPubkey:M.typeforce.maybe(M.typeforce.BufferN(32)),hash:M.typeforce.maybe(M.typeforce.BufferN(32)),pubkey:M.typeforce.maybe(M.typeforce.BufferN(32)),signature:M.typeforce.maybe(M.typeforce.anyOf(M.typeforce.BufferN(64),M.typeforce.BufferN(65))),witness:M.typeforce.maybe(M.typeforce.arrayOf(M.typeforce.Buffer)),scriptTree:M.typeforce.maybe(M.isTaptree),redeem:M.typeforce.maybe({output:M.typeforce.maybe(M.typeforce.Buffer),redeemVersion:M.typeforce.maybe(M.typeforce.Number),witness:M.typeforce.maybe(M.typeforce.arrayOf(M.typeforce.Buffer))}),redeemVersion:M.typeforce.maybe(M.typeforce.Number)},e);const r=Me.value(()=>{const f=Cn.bech32m.decode(e.address),a=f.words.shift(),u=Cn.bech32m.fromWords(f.words);return{version:a,prefix:f.prefix,data:Un.Buffer.from(u)}}),n=Me.value(()=>{if(!(!e.witness||!e.witness.length))return e.witness.length>=2&&e.witness[e.witness.length-1][0]===Dl?e.witness.slice(0,-1):e.witness.slice()}),i=Me.value(()=>{if(e.scriptTree)return(0,Ne.toHashTree)(e.scriptTree);if(e.hash)return{hash:e.hash}}),o=e.network||Fl.bitcoin,s={name:"p2tr",network:o};if(Me.prop(s,"address",()=>{if(!s.pubkey)return;const f=Cn.bech32m.toWords(s.pubkey);return f.unshift($s),Cn.bech32m.encode(o.bech32,f)}),Me.prop(s,"hash",()=>{const f=i();if(f)return f.hash;const a=n();if(a&&a.length>1){const u=a[a.length-1],l=u[0]&M.TAPLEAF_VERSION_MASK,c=a[a.length-2],b=(0,Ne.tapleafHash)({output:c,version:l});return(0,Ne.rootHashFromPath)(u,b)}return null}),Me.prop(s,"output",()=>{if(s.pubkey)return To.compile([Ms.OP_1,s.pubkey])}),Me.prop(s,"redeemVersion",()=>e.redeemVersion?e.redeemVersion:e.redeem&&e.redeem.redeemVersion!==void 0&&e.redeem.redeemVersion!==null?e.redeem.redeemVersion:Ne.LEAF_VERSION_TAPSCRIPT),Me.prop(s,"redeem",()=>{const f=n();if(!(!f||f.length<2))return{output:f[f.length-2],witness:f.slice(0,-2),redeemVersion:f[f.length-1][0]&M.TAPLEAF_VERSION_MASK}}),Me.prop(s,"pubkey",()=>{if(e.pubkey)return e.pubkey;if(e.output)return e.output.slice(2);if(e.address)return r().data;if(s.internalPubkey){const f=(0,Ne.tweakKey)(s.internalPubkey,s.hash);if(f)return f.x}}),Me.prop(s,"internalPubkey",()=>{if(e.internalPubkey)return e.internalPubkey;const f=n();if(f&&f.length>1)return f[f.length-1].slice(1,33)}),Me.prop(s,"signature",()=>{if(e.signature)return e.signature;const f=n();if(!(!f||f.length!==1))return f[0]}),Me.prop(s,"witness",()=>{if(e.witness)return e.witness;const f=i();if(f&&e.redeem&&e.redeem.output&&e.internalPubkey){const a=(0,Ne.tapleafHash)({output:e.redeem.output,version:s.redeemVersion}),u=(0,Ne.findScriptPath)(f,a);if(!u)return;const l=(0,Ne.tweakKey)(e.internalPubkey,f.hash);if(!l)return;const c=Un.Buffer.concat([Un.Buffer.from([s.redeemVersion|l.parity]),e.internalPubkey].concat(u));return[e.redeem.output,c]}if(e.signature)return[e.signature]}),t.validate){let f=Un.Buffer.from([]);if(e.address){if(o&&o.bech32!==r().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==$s)throw new TypeError("Invalid address version");if(r().data.length!==32)throw new TypeError("Invalid address data");f=r().data}if(e.pubkey){if(f.length>0&&!f.equals(e.pubkey))throw new TypeError("Pubkey mismatch");f=e.pubkey}if(e.output){if(e.output.length!==34||e.output[0]!==Ms.OP_1||e.output[1]!==32)throw new TypeError("Output is invalid");if(f.length>0&&!f.equals(e.output.slice(2)))throw new TypeError("Pubkey mismatch");f=e.output.slice(2)}if(e.internalPubkey){const l=(0,Ne.tweakKey)(e.internalPubkey,s.hash);if(f.length>0&&!f.equals(l.x))throw new TypeError("Pubkey mismatch");f=l.x}if(f&&f.length&&!(0,Ls.getEccLib)().isXOnlyPoint(f))throw new TypeError("Invalid pubkey for p2tr");const a=i();if(e.hash&&a&&!e.hash.equals(a.hash))throw new TypeError("Hash mismatch");if(e.redeem&&e.redeem.output&&a){const l=(0,Ne.tapleafHash)({output:e.redeem.output,version:s.redeemVersion});if(!(0,Ne.findScriptPath)(a,l))throw new TypeError("Redeem script not in tree")}const u=n();if(e.redeem&&s.redeem){if(e.redeem.redeemVersion&&e.redeem.redeemVersion!==s.redeem.redeemVersion)throw new TypeError("Redeem.redeemVersion and witness mismatch");if(e.redeem.output){if(To.decompile(e.redeem.output).length===0)throw new TypeError("Redeem.output is invalid");if(s.redeem.output&&!e.redeem.output.equals(s.redeem.output))throw new TypeError("Redeem.output and witness mismatch")}if(e.redeem.witness&&s.redeem.witness&&!Wl(e.redeem.witness,s.redeem.witness))throw new TypeError("Redeem.witness and witness mismatch")}if(u&&u.length)if(u.length===1){if(e.signature&&!e.signature.equals(u[0]))throw new TypeError("Signature mismatch")}else{const l=u[u.length-1];if(l.length<33)throw new TypeError(`The control-block length is too small. Got ${l.length}, expected min 33.`);if((l.length-33)%32!==0)throw new TypeError(`The control-block length of ${l.length} is incorrect!`);const c=(l.length-33)/32;if(c>128)throw new TypeError(`The script path is too long. Got ${c}, expected max 128.`);const b=l.slice(1,33);if(e.internalPubkey&&!e.internalPubkey.equals(b))throw new TypeError("Internal pubkey mismatch");if(!(0,Ls.getEccLib)().isXOnlyPoint(b))throw new TypeError("Invalid internalPubkey for p2tr witness");const p=l[0]&M.TAPLEAF_VERSION_MASK,y=u[u.length-2],g=(0,Ne.tapleafHash)({output:y,version:p}),w=(0,Ne.rootHashFromPath)(l,g),v=(0,Ne.tweakKey)(b,w);if(!v)throw new TypeError("Invalid outputKey for p2tr witness");if(f.length&&!f.equals(v.x))throw new TypeError("Pubkey mismatch for p2tr witness");if(v.parity!==(l[0]&1))throw new Error("Incorrect parity")}}return Object.assign(s,e)}_i.p2tr=Kl;function Wl(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.p2tr=e.p2wsh=e.p2wpkh=e.p2sh=e.p2pkh=e.p2pk=e.p2ms=e.embed=void 0;const t=fi;Object.defineProperty(e,"embed",{enumerable:!0,get:function(){return t.p2data}});const r=ai;Object.defineProperty(e,"p2ms",{enumerable:!0,get:function(){return r.p2ms}});const n=ui;Object.defineProperty(e,"p2pk",{enumerable:!0,get:function(){return n.p2pk}});const i=ci;Object.defineProperty(e,"p2pkh",{enumerable:!0,get:function(){return i.p2pkh}});const o=di;Object.defineProperty(e,"p2sh",{enumerable:!0,get:function(){return o.p2sh}});const s=pi;Object.defineProperty(e,"p2wpkh",{enumerable:!0,get:function(){return s.p2wpkh}});const f=yi;Object.defineProperty(e,"p2wsh",{enumerable:!0,get:function(){return f.p2wsh}});const a=_i;Object.defineProperty(e,"p2tr",{enumerable:!0,get:function(){return a.p2tr}})})(Hr);Object.defineProperty(ke,"__esModule",{value:!0});ke.toOutputScript=ke.fromOutputScript=ke.toBech32=ke.toBase58Check=ke.fromBech32=ke.fromBase58Check=void 0;const ya=le,tt=Hr,_a=Be,Hn=be,Ar=gt,ba=Wo,ga=40,wa=2,Ea=16,Sa=2,va=80,ma="WARNING: Sending to a future segwit version address can lead to loss of funds. End users MUST be warned carefully in the GUI and asked if they wish to proceed with caution. Wallets should verify the segwit version from the output of fromBech32, then decide when it is safe to use which version of segwit.";function jl(e,t){const r=e.slice(2);if(r.length<wa||r.length>ga)throw new TypeError("Invalid program length for segwit address");const n=e[0]-va;if(n<Sa||n>Ea)throw new TypeError("Invalid version for segwit address");if(e[1]!==r.length)throw new TypeError("Invalid script for segwit address");return console.warn(ma),Ia(r,n,t.bech32)}function Ta(e){const t=Buffer.from(ba.decode(e));if(t.length<21)throw new TypeError(e+" is too short");if(t.length>21)throw new TypeError(e+" is too long");const r=t.readUint8(0),n=t.slice(1);return{version:r,hash:n}}ke.fromBase58Check=Ta;function Pa(e){let t,r;try{t=Ar.bech32.decode(e)}catch{}if(t){if(r=t.words[0],r!==0)throw new TypeError(e+" uses wrong encoding")}else if(t=Ar.bech32m.decode(e),r=t.words[0],r===0)throw new TypeError(e+" uses wrong encoding");const n=Ar.bech32.fromWords(t.words.slice(1));return{version:r,prefix:t.prefix,data:Buffer.from(n)}}ke.fromBech32=Pa;function Vl(e,t){(0,Hn.typeforce)((0,Hn.tuple)(Hn.Hash160bit,Hn.UInt8),arguments);const r=Buffer.allocUnsafe(21);return r.writeUInt8(t,0),e.copy(r,1),ba.encode(r)}ke.toBase58Check=Vl;function Ia(e,t,r){const n=Ar.bech32.toWords(e);return n.unshift(t),t===0?Ar.bech32.encode(r,n):Ar.bech32m.encode(r,n)}ke.toBech32=Ia;function Gl(e,t){t=t||ya.bitcoin;try{return tt.p2pkh({output:e,network:t}).address}catch{}try{return tt.p2sh({output:e,network:t}).address}catch{}try{return tt.p2wpkh({output:e,network:t}).address}catch{}try{return tt.p2wsh({output:e,network:t}).address}catch{}try{return tt.p2tr({output:e,network:t}).address}catch{}try{return jl(e,t)}catch{}throw new Error(_a.toASM(e)+" has no matching Address")}ke.fromOutputScript=Gl;function ql(e,t){t=t||ya.bitcoin;let r,n;try{r=Ta(e)}catch{}if(r){if(r.version===t.pubKeyHash)return tt.p2pkh({hash:r.hash}).output;if(r.version===t.scriptHash)return tt.p2sh({hash:r.hash}).output}else{try{n=Pa(e)}catch{}if(n){if(n.prefix!==t.bech32)throw new Error(e+" has an invalid prefix");if(n.version===0){if(n.data.length===20)return tt.p2wpkh({hash:n.data}).output;if(n.data.length===32)return tt.p2wsh({hash:n.data}).output}else if(n.version===1){if(n.data.length===32)return tt.p2tr({pubkey:n.data}).output}else if(n.version>=Sa&&n.version<=Ea&&n.data.length>=wa&&n.data.length<=ga)return console.warn(ma),_a.compile([n.version+va,n.data])}}throw new Error(e+" has no matching Script")}ke.toOutputScript=ql;var gi={},wi={};Object.defineProperty(wi,"__esModule",{value:!0});wi.fastMerkleRoot=void 0;function Xl(e,t){if(!Array.isArray(e))throw TypeError("Expected values Array");if(typeof t!="function")throw TypeError("Expected digest Function");let r=e.length;const n=e.concat();for(;r>1;){let i=0;for(let o=0;o<r;o+=2,++i){const s=n[o],f=o+1===r?s:n[o+1],a=Buffer.concat([s,f]);n[i]=t(a)}r=i}return n[0]}wi.fastMerkleRoot=Xl;var Ht={};Object.defineProperty(Ht,"__esModule",{value:!0});Ht.Transaction=void 0;const ie=ae,Te=rt,Fs=Be,Yl=Be,j=be,{typeforce:Je}=j;function Ze(e){const t=e.length;return ie.varuint.encodingLength(t)+t}function zl(e){const t=e.length;return ie.varuint.encodingLength(t)+e.reduce((r,n)=>r+Ze(n),0)}const At=Buffer.allocUnsafe(0),Ds=[],zi=Buffer.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),Ks=Buffer.from("0000000000000000000000000000000000000000000000000000000000000001","hex"),Jl=Buffer.from("ffffffffffffffff","hex"),Ql={script:At,valueBuffer:Jl};function Zl(e){return e.value!==void 0}class L{constructor(){this.version=1,this.locktime=0,this.ins=[],this.outs=[]}static fromBuffer(t,r){const n=new ie.BufferReader(t),i=new L;i.version=n.readInt32();const o=n.readUInt8(),s=n.readUInt8();let f=!1;o===L.ADVANCED_TRANSACTION_MARKER&&s===L.ADVANCED_TRANSACTION_FLAG?f=!0:n.offset-=2;const a=n.readVarInt();for(let l=0;l<a;++l)i.ins.push({hash:n.readSlice(32),index:n.readUInt32(),script:n.readVarSlice(),sequence:n.readUInt32(),witness:Ds});const u=n.readVarInt();for(let l=0;l<u;++l)i.outs.push({value:n.readUInt64(),script:n.readVarSlice()});if(f){for(let l=0;l<a;++l)i.ins[l].witness=n.readVector();if(!i.hasWitnesses())throw new Error("Transaction has superfluous witness data")}if(i.locktime=n.readUInt32(),r)return i;if(n.offset!==t.length)throw new Error("Transaction has unexpected data");return i}static fromHex(t){return L.fromBuffer(Buffer.from(t,"hex"),!1)}static isCoinbaseHash(t){Je(j.Hash256bit,t);for(let r=0;r<32;++r)if(t[r]!==0)return!1;return!0}isCoinbase(){return this.ins.length===1&&L.isCoinbaseHash(this.ins[0].hash)}addInput(t,r,n,i){return Je(j.tuple(j.Hash256bit,j.UInt32,j.maybe(j.UInt32),j.maybe(j.Buffer)),arguments),j.Null(n)&&(n=L.DEFAULT_SEQUENCE),this.ins.push({hash:t,index:r,script:i||At,sequence:n,witness:Ds})-1}addOutput(t,r){return Je(j.tuple(j.Buffer,j.Satoshi),arguments),this.outs.push({script:t,value:r})-1}hasWitnesses(){return this.ins.some(t=>t.witness.length!==0)}weight(){const t=this.byteLength(!1),r=this.byteLength(!0);return t*3+r}virtualSize(){return Math.ceil(this.weight()/4)}byteLength(t=!0){const r=t&&this.hasWitnesses();return(r?10:8)+ie.varuint.encodingLength(this.ins.length)+ie.varuint.encodingLength(this.outs.length)+this.ins.reduce((n,i)=>n+40+Ze(i.script),0)+this.outs.reduce((n,i)=>n+8+Ze(i.script),0)+(r?this.ins.reduce((n,i)=>n+zl(i.witness),0):0)}clone(){const t=new L;return t.version=this.version,t.locktime=this.locktime,t.ins=this.ins.map(r=>({hash:r.hash,index:r.index,script:r.script,sequence:r.sequence,witness:r.witness})),t.outs=this.outs.map(r=>({script:r.script,value:r.value})),t}hashForSignature(t,r,n){if(Je(j.tuple(j.UInt32,j.Buffer,j.Number),arguments),t>=this.ins.length)return Ks;const i=Fs.compile(Fs.decompile(r).filter(f=>f!==Yl.OPS.OP_CODESEPARATOR)),o=this.clone();if((n&31)===L.SIGHASH_NONE)o.outs=[],o.ins.forEach((f,a)=>{a!==t&&(f.sequence=0)});else if((n&31)===L.SIGHASH_SINGLE){if(t>=this.outs.length)return Ks;o.outs.length=t+1;for(let f=0;f<t;f++)o.outs[f]=Ql;o.ins.forEach((f,a)=>{a!==t&&(f.sequence=0)})}n&L.SIGHASH_ANYONECANPAY?(o.ins=[o.ins[t]],o.ins[0].script=i):(o.ins.forEach(f=>{f.script=At}),o.ins[t].script=i);const s=Buffer.allocUnsafe(o.byteLength(!1)+4);return s.writeInt32LE(n,s.length-4),o.__toBuffer(s,0,!1),Te.hash256(s)}hashForWitnessV1(t,r,n,i,o,s){if(Je(j.tuple(j.UInt32,Je.arrayOf(j.Buffer),Je.arrayOf(j.Satoshi),j.UInt32),arguments),n.length!==this.ins.length||r.length!==this.ins.length)throw new Error("Must supply prevout script and value for all inputs");const f=i===L.SIGHASH_DEFAULT?L.SIGHASH_ALL:i&L.SIGHASH_OUTPUT_MASK,u=(i&L.SIGHASH_INPUT_MASK)===L.SIGHASH_ANYONECANPAY,l=f===L.SIGHASH_NONE,c=f===L.SIGHASH_SINGLE;let b=At,p=At,y=At,g=At,w=At;if(!u){let T=ie.BufferWriter.withCapacity(36*this.ins.length);this.ins.forEach(A=>{T.writeSlice(A.hash),T.writeUInt32(A.index)}),b=Te.sha256(T.end()),T=ie.BufferWriter.withCapacity(8*this.ins.length),n.forEach(A=>T.writeUInt64(A)),p=Te.sha256(T.end()),T=ie.BufferWriter.withCapacity(r.map(Ze).reduce((A,_)=>A+_)),r.forEach(A=>T.writeVarSlice(A)),y=Te.sha256(T.end()),T=ie.BufferWriter.withCapacity(4*this.ins.length),this.ins.forEach(A=>T.writeUInt32(A.sequence)),g=Te.sha256(T.end())}if(l||c){if(c&&t<this.outs.length){const T=this.outs[t],A=ie.BufferWriter.withCapacity(8+Ze(T.script));A.writeUInt64(T.value),A.writeVarSlice(T.script),w=Te.sha256(A.end())}}else{const T=this.outs.map(_=>8+Ze(_.script)).reduce((_,O)=>_+O),A=ie.BufferWriter.withCapacity(T);this.outs.forEach(_=>{A.writeUInt64(_.value),A.writeVarSlice(_.script)}),w=Te.sha256(A.end())}const v=(o?2:0)+(s?1:0),I=174-(u?49:0)-(l?32:0)+(s?32:0)+(o?37:0),P=ie.BufferWriter.withCapacity(I);if(P.writeUInt8(i),P.writeInt32(this.version),P.writeUInt32(this.locktime),P.writeSlice(b),P.writeSlice(p),P.writeSlice(y),P.writeSlice(g),l||c||P.writeSlice(w),P.writeUInt8(v),u){const T=this.ins[t];P.writeSlice(T.hash),P.writeUInt32(T.index),P.writeUInt64(n[t]),P.writeVarSlice(r[t]),P.writeUInt32(T.sequence)}else P.writeUInt32(t);if(s){const T=ie.BufferWriter.withCapacity(Ze(s));T.writeVarSlice(s),P.writeSlice(Te.sha256(T.end()))}return c&&P.writeSlice(w),o&&(P.writeSlice(o),P.writeUInt8(0),P.writeUInt32(4294967295)),Te.taggedHash("TapSighash",Buffer.concat([Buffer.from([0]),P.end()]))}hashForWitnessV0(t,r,n,i){Je(j.tuple(j.UInt32,j.Buffer,j.Satoshi,j.UInt32),arguments);let o=Buffer.from([]),s,f=zi,a=zi,u=zi;if(i&L.SIGHASH_ANYONECANPAY||(o=Buffer.allocUnsafe(36*this.ins.length),s=new ie.BufferWriter(o,0),this.ins.forEach(c=>{s.writeSlice(c.hash),s.writeUInt32(c.index)}),a=Te.hash256(o)),!(i&L.SIGHASH_ANYONECANPAY)&&(i&31)!==L.SIGHASH_SINGLE&&(i&31)!==L.SIGHASH_NONE&&(o=Buffer.allocUnsafe(4*this.ins.length),s=new ie.BufferWriter(o,0),this.ins.forEach(c=>{s.writeUInt32(c.sequence)}),u=Te.hash256(o)),(i&31)!==L.SIGHASH_SINGLE&&(i&31)!==L.SIGHASH_NONE){const c=this.outs.reduce((b,p)=>b+8+Ze(p.script),0);o=Buffer.allocUnsafe(c),s=new ie.BufferWriter(o,0),this.outs.forEach(b=>{s.writeUInt64(b.value),s.writeVarSlice(b.script)}),f=Te.hash256(o)}else if((i&31)===L.SIGHASH_SINGLE&&t<this.outs.length){const c=this.outs[t];o=Buffer.allocUnsafe(8+Ze(c.script)),s=new ie.BufferWriter(o,0),s.writeUInt64(c.value),s.writeVarSlice(c.script),f=Te.hash256(o)}o=Buffer.allocUnsafe(156+Ze(r)),s=new ie.BufferWriter(o,0);const l=this.ins[t];return s.writeInt32(this.version),s.writeSlice(a),s.writeSlice(u),s.writeSlice(l.hash),s.writeUInt32(l.index),s.writeVarSlice(r),s.writeUInt64(n),s.writeUInt32(l.sequence),s.writeSlice(f),s.writeUInt32(this.locktime),s.writeUInt32(i),Te.hash256(o)}getHash(t){return t&&this.isCoinbase()?Buffer.alloc(32,0):Te.hash256(this.__toBuffer(void 0,void 0,t))}getId(){return(0,ie.reverseBuffer)(this.getHash(!1)).toString("hex")}toBuffer(t,r){return this.__toBuffer(t,r,!0)}toHex(){return this.toBuffer(void 0,void 0).toString("hex")}setInputScript(t,r){Je(j.tuple(j.Number,j.Buffer),arguments),this.ins[t].script=r}setWitness(t,r){Je(j.tuple(j.Number,[j.Buffer]),arguments),this.ins[t].witness=r}__toBuffer(t,r,n=!1){t||(t=Buffer.allocUnsafe(this.byteLength(n)));const i=new ie.BufferWriter(t,r||0);i.writeInt32(this.version);const o=n&&this.hasWitnesses();return o&&(i.writeUInt8(L.ADVANCED_TRANSACTION_MARKER),i.writeUInt8(L.ADVANCED_TRANSACTION_FLAG)),i.writeVarInt(this.ins.length),this.ins.forEach(s=>{i.writeSlice(s.hash),i.writeUInt32(s.index),i.writeVarSlice(s.script),i.writeUInt32(s.sequence)}),i.writeVarInt(this.outs.length),this.outs.forEach(s=>{Zl(s)?i.writeUInt64(s.value):i.writeSlice(s.valueBuffer),i.writeVarSlice(s.script)}),o&&this.ins.forEach(s=>{i.writeVector(s.witness)}),i.writeUInt32(this.locktime),r!==void 0?t.slice(r,i.offset):t}}Ht.Transaction=L;L.DEFAULT_SEQUENCE=4294967295;L.SIGHASH_DEFAULT=0;L.SIGHASH_ALL=1;L.SIGHASH_NONE=2;L.SIGHASH_SINGLE=3;L.SIGHASH_ANYONECANPAY=128;L.SIGHASH_OUTPUT_MASK=3;L.SIGHASH_INPUT_MASK=128;L.ADVANCED_TRANSACTION_MARKER=0;L.ADVANCED_TRANSACTION_FLAG=1;Object.defineProperty(gi,"__esModule",{value:!0});gi.Block=void 0;const Ft=ae,Ji=rt,eh=wi,th=Ht,Aa=be,{typeforce:rh}=Aa,Qi=new TypeError("Cannot compute merkle root for zero transactions"),Ws=new TypeError("Cannot compute witness commit for non-segwit block");class Dt{constructor(){this.version=1,this.prevHash=void 0,this.merkleRoot=void 0,this.timestamp=0,this.witnessCommit=void 0,this.bits=0,this.nonce=0,this.transactions=void 0}static fromBuffer(t){if(t.length<80)throw new Error("Buffer too small (< 80 bytes)");const r=new Ft.BufferReader(t),n=new Dt;if(n.version=r.readInt32(),n.prevHash=r.readSlice(32),n.merkleRoot=r.readSlice(32),n.timestamp=r.readUInt32(),n.bits=r.readUInt32(),n.nonce=r.readUInt32(),t.length===80)return n;const i=()=>{const f=th.Transaction.fromBuffer(r.buffer.slice(r.offset),!0);return r.offset+=f.byteLength(),f},o=r.readVarInt();n.transactions=[];for(let f=0;f<o;++f){const a=i();n.transactions.push(a)}const s=n.getWitnessCommit();return s&&(n.witnessCommit=s),n}static fromHex(t){return Dt.fromBuffer(Buffer.from(t,"hex"))}static calculateTarget(t){const r=((t&4278190080)>>24)-3,n=t&8388607,i=Buffer.alloc(32,0);return i.writeUIntBE(n,29-r,3),i}static calculateMerkleRoot(t,r){if(rh([{getHash:Aa.Function}],t),t.length===0)throw Qi;if(r&&!js(t))throw Ws;const n=t.map(o=>o.getHash(r)),i=(0,eh.fastMerkleRoot)(n,Ji.hash256);return r?Ji.hash256(Buffer.concat([i,t[0].ins[0].witness[0]])):i}getWitnessCommit(){if(!js(this.transactions))return null;const t=this.transactions[0].outs.filter(n=>n.script.slice(0,6).equals(Buffer.from("6a24aa21a9ed","hex"))).map(n=>n.script.slice(6,38));if(t.length===0)return null;const r=t[t.length-1];return r instanceof Buffer&&r.length===32?r:null}hasWitnessCommit(){return this.witnessCommit instanceof Buffer&&this.witnessCommit.length===32||this.getWitnessCommit()!==null}hasWitness(){return nh(this.transactions)}weight(){const t=this.byteLength(!1,!1),r=this.byteLength(!1,!0);return t*3+r}byteLength(t,r=!0){return t||!this.transactions?80:80+Ft.varuint.encodingLength(this.transactions.length)+this.transactions.reduce((n,i)=>n+i.byteLength(r),0)}getHash(){return Ji.hash256(this.toBuffer(!0))}getId(){return(0,Ft.reverseBuffer)(this.getHash()).toString("hex")}getUTCDate(){const t=new Date(0);return t.setUTCSeconds(this.timestamp),t}toBuffer(t){const r=Buffer.allocUnsafe(this.byteLength(t)),n=new Ft.BufferWriter(r);return n.writeInt32(this.version),n.writeSlice(this.prevHash),n.writeSlice(this.merkleRoot),n.writeUInt32(this.timestamp),n.writeUInt32(this.bits),n.writeUInt32(this.nonce),t||!this.transactions||(Ft.varuint.encode(this.transactions.length,r,n.offset),n.offset+=Ft.varuint.encode.bytes,this.transactions.forEach(i=>{const o=i.byteLength();i.toBuffer(r,n.offset),n.offset+=o})),r}toHex(t){return this.toBuffer(t).toString("hex")}checkTxRoots(){const t=this.hasWitnessCommit();return!t&&this.hasWitness()?!1:this.__checkMerkleRoot()&&(t?this.__checkWitnessCommit():!0)}checkProofOfWork(){const t=(0,Ft.reverseBuffer)(this.getHash()),r=Dt.calculateTarget(this.bits);return t.compare(r)<=0}__checkMerkleRoot(){if(!this.transactions)throw Qi;const t=Dt.calculateMerkleRoot(this.transactions);return this.merkleRoot.compare(t)===0}__checkWitnessCommit(){if(!this.transactions)throw Qi;if(!this.hasWitnessCommit())throw Ws;const t=Dt.calculateMerkleRoot(this.transactions,!0);return this.witnessCommit.compare(t)===0}}gi.Block=Dt;function js(e){return e instanceof Array&&e[0]&&e[0].ins&&e[0].ins instanceof Array&&e[0].ins[0]&&e[0].ins[0].witness&&e[0].ins[0].witness instanceof Array&&e[0].ins[0].witness.length>0}function nh(e){return e instanceof Array&&e.some(t=>typeof t=="object"&&t.ins instanceof Array&&t.ins.some(r=>typeof r=="object"&&r.witness instanceof Array&&r.witness.length>0))}var Ei={},qo={},Xo={},Yo={},wn={},Xt={},he={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.UNSIGNED_TX=0]="UNSIGNED_TX",t[t.GLOBAL_XPUB=1]="GLOBAL_XPUB"}(e.GlobalTypes||(e.GlobalTypes={})),e.GLOBAL_TYPE_NAMES=["unsignedTx","globalXpub"],function(t){t[t.NON_WITNESS_UTXO=0]="NON_WITNESS_UTXO",t[t.WITNESS_UTXO=1]="WITNESS_UTXO",t[t.PARTIAL_SIG=2]="PARTIAL_SIG",t[t.SIGHASH_TYPE=3]="SIGHASH_TYPE",t[t.REDEEM_SCRIPT=4]="REDEEM_SCRIPT",t[t.WITNESS_SCRIPT=5]="WITNESS_SCRIPT",t[t.BIP32_DERIVATION=6]="BIP32_DERIVATION",t[t.FINAL_SCRIPTSIG=7]="FINAL_SCRIPTSIG",t[t.FINAL_SCRIPTWITNESS=8]="FINAL_SCRIPTWITNESS",t[t.POR_COMMITMENT=9]="POR_COMMITMENT",t[t.TAP_KEY_SIG=19]="TAP_KEY_SIG",t[t.TAP_SCRIPT_SIG=20]="TAP_SCRIPT_SIG",t[t.TAP_LEAF_SCRIPT=21]="TAP_LEAF_SCRIPT",t[t.TAP_BIP32_DERIVATION=22]="TAP_BIP32_DERIVATION",t[t.TAP_INTERNAL_KEY=23]="TAP_INTERNAL_KEY",t[t.TAP_MERKLE_ROOT=24]="TAP_MERKLE_ROOT"}(e.InputTypes||(e.InputTypes={})),e.INPUT_TYPE_NAMES=["nonWitnessUtxo","witnessUtxo","partialSig","sighashType","redeemScript","witnessScript","bip32Derivation","finalScriptSig","finalScriptWitness","porCommitment","tapKeySig","tapScriptSig","tapLeafScript","tapBip32Derivation","tapInternalKey","tapMerkleRoot"],function(t){t[t.REDEEM_SCRIPT=0]="REDEEM_SCRIPT",t[t.WITNESS_SCRIPT=1]="WITNESS_SCRIPT",t[t.BIP32_DERIVATION=2]="BIP32_DERIVATION",t[t.TAP_INTERNAL_KEY=5]="TAP_INTERNAL_KEY",t[t.TAP_TREE=6]="TAP_TREE",t[t.TAP_BIP32_DERIVATION=7]="TAP_BIP32_DERIVATION"}(e.OutputTypes||(e.OutputTypes={})),e.OUTPUT_TYPE_NAMES=["redeemScript","witnessScript","bip32Derivation","tapInternalKey","tapTree","tapBip32Derivation"]})(he);var Yt={};Object.defineProperty(Yt,"__esModule",{value:!0});const ka=he,ih=e=>[...Array(e).keys()];function oh(e){if(e.key[0]!==ka.GlobalTypes.GLOBAL_XPUB)throw new Error("Decode Error: could not decode globalXpub with key 0x"+e.key.toString("hex"));if(e.key.length!==79||![2,3].includes(e.key[46]))throw new Error("Decode Error: globalXpub has invalid extended pubkey in key 0x"+e.key.toString("hex"));if(e.value.length/4%1!==0)throw new Error("Decode Error: Global GLOBAL_XPUB value length should be multiple of 4");const t=e.key.slice(1),r={masterFingerprint:e.value.slice(0,4),extendedPubkey:t,path:"m"};for(const n of ih(e.value.length/4-1)){const i=e.value.readUInt32LE(n*4+4),o=!!(i&2147483648),s=i&2147483647;r.path+="/"+s.toString(10)+(o?"'":"")}return r}Yt.decode=oh;function sh(e){const t=Buffer.from([ka.GlobalTypes.GLOBAL_XPUB]),r=Buffer.concat([t,e.extendedPubkey]),n=e.path.split("/"),i=Buffer.allocUnsafe(n.length*4);e.masterFingerprint.copy(i,0);let o=4;return n.slice(1).forEach(s=>{const f=s.slice(-1)==="'";let a=2147483647&parseInt(f?s.slice(0,-1):s,10);f&&(a+=2147483648),i.writeUInt32LE(a,o),o+=4}),{key:r,value:i}}Yt.encode=sh;Yt.expected="{ masterFingerprint: Buffer; extendedPubkey: Buffer; path: string; }";function fh(e){const t=e.extendedPubkey,r=e.masterFingerprint,n=e.path;return Buffer.isBuffer(t)&&t.length===78&&[2,3].indexOf(t[45])>-1&&Buffer.isBuffer(r)&&r.length===4&&typeof n=="string"&&!!n.match(/^m(\/\d+'?)*$/)}Yt.check=fh;function ah(e,t,r){const n=t.extendedPubkey.toString("hex");return r.has(n)?!1:(r.add(n),e.filter(i=>i.extendedPubkey.equals(t.extendedPubkey)).length===0)}Yt.canAddToArray=ah;var zo={};Object.defineProperty(zo,"__esModule",{value:!0});const uh=he;function ch(e){return{key:Buffer.from([uh.GlobalTypes.UNSIGNED_TX]),value:e.toBuffer()}}zo.encode=ch;var zt={};Object.defineProperty(zt,"__esModule",{value:!0});const Oa=he;function lh(e){if(e.key[0]!==Oa.InputTypes.FINAL_SCRIPTSIG)throw new Error("Decode Error: could not decode finalScriptSig with key 0x"+e.key.toString("hex"));return e.value}zt.decode=lh;function hh(e){return{key:Buffer.from([Oa.InputTypes.FINAL_SCRIPTSIG]),value:e}}zt.encode=hh;zt.expected="Buffer";function dh(e){return Buffer.isBuffer(e)}zt.check=dh;function ph(e,t){return!!e&&!!t&&e.finalScriptSig===void 0}zt.canAdd=ph;var Jt={};Object.defineProperty(Jt,"__esModule",{value:!0});const Ba=he;function yh(e){if(e.key[0]!==Ba.InputTypes.FINAL_SCRIPTWITNESS)throw new Error("Decode Error: could not decode finalScriptWitness with key 0x"+e.key.toString("hex"));return e.value}Jt.decode=yh;function _h(e){return{key:Buffer.from([Ba.InputTypes.FINAL_SCRIPTWITNESS]),value:e}}Jt.encode=_h;Jt.expected="Buffer";function bh(e){return Buffer.isBuffer(e)}Jt.check=bh;function gh(e,t){return!!e&&!!t&&e.finalScriptWitness===void 0}Jt.canAdd=gh;var Qt={};Object.defineProperty(Qt,"__esModule",{value:!0});const xa=he;function wh(e){if(e.key[0]!==xa.InputTypes.NON_WITNESS_UTXO)throw new Error("Decode Error: could not decode nonWitnessUtxo with key 0x"+e.key.toString("hex"));return e.value}Qt.decode=wh;function Eh(e){return{key:Buffer.from([xa.InputTypes.NON_WITNESS_UTXO]),value:e}}Qt.encode=Eh;Qt.expected="Buffer";function Sh(e){return Buffer.isBuffer(e)}Qt.check=Sh;function vh(e,t){return!!e&&!!t&&e.nonWitnessUtxo===void 0}Qt.canAdd=vh;var Zt={};Object.defineProperty(Zt,"__esModule",{value:!0});const Ra=he;function mh(e){if(e.key[0]!==Ra.InputTypes.PARTIAL_SIG)throw new Error("Decode Error: could not decode partialSig with key 0x"+e.key.toString("hex"));if(!(e.key.length===34||e.key.length===66)||![2,3,4].includes(e.key[1]))throw new Error("Decode Error: partialSig has invalid pubkey in key 0x"+e.key.toString("hex"));return{pubkey:e.key.slice(1),signature:e.value}}Zt.decode=mh;function Th(e){const t=Buffer.from([Ra.InputTypes.PARTIAL_SIG]);return{key:Buffer.concat([t,e.pubkey]),value:e.signature}}Zt.encode=Th;Zt.expected="{ pubkey: Buffer; signature: Buffer; }";function Ph(e){return Buffer.isBuffer(e.pubkey)&&Buffer.isBuffer(e.signature)&&[33,65].includes(e.pubkey.length)&&[2,3,4].includes(e.pubkey[0])&&Ih(e.signature)}Zt.check=Ph;function Ih(e){if(!Buffer.isBuffer(e)||e.length<9||e[0]!==48||e.length!==e[1]+3||e[2]!==2)return!1;const t=e[3];if(t>33||t<1||e[3+t+1]!==2)return!1;const r=e[3+t+2];return!(r>33||r<1||e.length!==3+t+2+r+2)}function Ah(e,t,r){const n=t.pubkey.toString("hex");return r.has(n)?!1:(r.add(n),e.filter(i=>i.pubkey.equals(t.pubkey)).length===0)}Zt.canAddToArray=Ah;var er={};Object.defineProperty(er,"__esModule",{value:!0});const Na=he;function kh(e){if(e.key[0]!==Na.InputTypes.POR_COMMITMENT)throw new Error("Decode Error: could not decode porCommitment with key 0x"+e.key.toString("hex"));return e.value.toString("utf8")}er.decode=kh;function Oh(e){return{key:Buffer.from([Na.InputTypes.POR_COMMITMENT]),value:Buffer.from(e,"utf8")}}er.encode=Oh;er.expected="string";function Bh(e){return typeof e=="string"}er.check=Bh;function xh(e,t){return!!e&&!!t&&e.porCommitment===void 0}er.canAdd=xh;var tr={};Object.defineProperty(tr,"__esModule",{value:!0});const Ua=he;function Rh(e){if(e.key[0]!==Ua.InputTypes.SIGHASH_TYPE)throw new Error("Decode Error: could not decode sighashType with key 0x"+e.key.toString("hex"));return e.value.readUInt32LE(0)}tr.decode=Rh;function Nh(e){const t=Buffer.from([Ua.InputTypes.SIGHASH_TYPE]),r=Buffer.allocUnsafe(4);return r.writeUInt32LE(e,0),{key:t,value:r}}tr.encode=Nh;tr.expected="number";function Uh(e){return typeof e=="number"}tr.check=Uh;function Ch(e,t){return!!e&&!!t&&e.sighashType===void 0}tr.canAdd=Ch;var rr={};Object.defineProperty(rr,"__esModule",{value:!0});const Ca=he;function Hh(e){if(e.key[0]!==Ca.InputTypes.TAP_KEY_SIG||e.key.length!==1)throw new Error("Decode Error: could not decode tapKeySig with key 0x"+e.key.toString("hex"));if(!Ha(e.value))throw new Error("Decode Error: tapKeySig not a valid 64-65-byte BIP340 signature");return e.value}rr.decode=Hh;function Lh(e){return{key:Buffer.from([Ca.InputTypes.TAP_KEY_SIG]),value:e}}rr.encode=Lh;rr.expected="Buffer";function Ha(e){return Buffer.isBuffer(e)&&(e.length===64||e.length===65)}rr.check=Ha;function Mh(e,t){return!!e&&!!t&&e.tapKeySig===void 0}rr.canAdd=Mh;var nr={};Object.defineProperty(nr,"__esModule",{value:!0});const La=he;function $h(e){if(e.key[0]!==La.InputTypes.TAP_LEAF_SCRIPT)throw new Error("Decode Error: could not decode tapLeafScript with key 0x"+e.key.toString("hex"));if((e.key.length-2)%32!==0)throw new Error("Decode Error: tapLeafScript has invalid control block in key 0x"+e.key.toString("hex"));const t=e.value[e.value.length-1];if((e.key[1]&254)!==t)throw new Error("Decode Error: tapLeafScript bad leaf version in key 0x"+e.key.toString("hex"));const r=e.value.slice(0,-1);return{controlBlock:e.key.slice(1),script:r,leafVersion:t}}nr.decode=$h;function Fh(e){const t=Buffer.from([La.InputTypes.TAP_LEAF_SCRIPT]),r=Buffer.from([e.leafVersion]);return{key:Buffer.concat([t,e.controlBlock]),value:Buffer.concat([e.script,r])}}nr.encode=Fh;nr.expected="{ controlBlock: Buffer; leafVersion: number, script: Buffer; }";function Dh(e){return Buffer.isBuffer(e.controlBlock)&&(e.controlBlock.length-1)%32===0&&(e.controlBlock[0]&254)===e.leafVersion&&Buffer.isBuffer(e.script)}nr.check=Dh;function Kh(e,t,r){const n=t.controlBlock.toString("hex");return r.has(n)?!1:(r.add(n),e.filter(i=>i.controlBlock.equals(t.controlBlock)).length===0)}nr.canAddToArray=Kh;var ir={};Object.defineProperty(ir,"__esModule",{value:!0});const Ma=he;function Wh(e){if(e.key[0]!==Ma.InputTypes.TAP_MERKLE_ROOT||e.key.length!==1)throw new Error("Decode Error: could not decode tapMerkleRoot with key 0x"+e.key.toString("hex"));if(!$a(e.value))throw new Error("Decode Error: tapMerkleRoot not a 32-byte hash");return e.value}ir.decode=Wh;function jh(e){return{key:Buffer.from([Ma.InputTypes.TAP_MERKLE_ROOT]),value:e}}ir.encode=jh;ir.expected="Buffer";function $a(e){return Buffer.isBuffer(e)&&e.length===32}ir.check=$a;function Vh(e,t){return!!e&&!!t&&e.tapMerkleRoot===void 0}ir.canAdd=Vh;var or={};Object.defineProperty(or,"__esModule",{value:!0});const Fa=he;function Gh(e){if(e.key[0]!==Fa.InputTypes.TAP_SCRIPT_SIG)throw new Error("Decode Error: could not decode tapScriptSig with key 0x"+e.key.toString("hex"));if(e.key.length!==65)throw new Error("Decode Error: tapScriptSig has invalid key 0x"+e.key.toString("hex"));if(e.value.length!==64&&e.value.length!==65)throw new Error("Decode Error: tapScriptSig has invalid signature in key 0x"+e.key.toString("hex"));const t=e.key.slice(1,33),r=e.key.slice(33);return{pubkey:t,leafHash:r,signature:e.value}}or.decode=Gh;function qh(e){const t=Buffer.from([Fa.InputTypes.TAP_SCRIPT_SIG]);return{key:Buffer.concat([t,e.pubkey,e.leafHash]),value:e.signature}}or.encode=qh;or.expected="{ pubkey: Buffer; leafHash: Buffer; signature: Buffer; }";function Xh(e){return Buffer.isBuffer(e.pubkey)&&Buffer.isBuffer(e.leafHash)&&Buffer.isBuffer(e.signature)&&e.pubkey.length===32&&e.leafHash.length===32&&(e.signature.length===64||e.signature.length===65)}or.check=Xh;function Yh(e,t,r){const n=t.pubkey.toString("hex")+t.leafHash.toString("hex");return r.has(n)?!1:(r.add(n),e.filter(i=>i.pubkey.equals(t.pubkey)&&i.leafHash.equals(t.leafHash)).length===0)}or.canAddToArray=Yh;var sr={},nt={},qe={};Object.defineProperty(qe,"__esModule",{value:!0});const zh=9007199254740991;function Jo(e){if(e<0||e>zh||e%1!==0)throw new RangeError("value out of range")}function fn(e,t,r){if(Jo(e),t||(t=Buffer.allocUnsafe(Da(e))),!Buffer.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");return r||(r=0),e<253?(t.writeUInt8(e,r),Object.assign(fn,{bytes:1})):e<=65535?(t.writeUInt8(253,r),t.writeUInt16LE(e,r+1),Object.assign(fn,{bytes:3})):e<=4294967295?(t.writeUInt8(254,r),t.writeUInt32LE(e,r+1),Object.assign(fn,{bytes:5})):(t.writeUInt8(255,r),t.writeUInt32LE(e>>>0,r+1),t.writeUInt32LE(e/4294967296|0,r+5),Object.assign(fn,{bytes:9})),t}qe.encode=fn;function an(e,t){if(!Buffer.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");t||(t=0);const r=e.readUInt8(t);if(r<253)return Object.assign(an,{bytes:1}),r;if(r===253)return Object.assign(an,{bytes:3}),e.readUInt16LE(t+1);if(r===254)return Object.assign(an,{bytes:5}),e.readUInt32LE(t+1);{Object.assign(an,{bytes:9});const n=e.readUInt32LE(t+1),o=e.readUInt32LE(t+5)*4294967296+n;return Jo(o),o}}qe.decode=an;function Da(e){return Jo(e),e<253?1:e<=65535?3:e<=4294967295?5:9}qe.encodingLength=Da;Object.defineProperty(nt,"__esModule",{value:!0});const Ln=qe;nt.range=e=>[...Array(e).keys()];function Jh(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e}nt.reverseBuffer=Jh;function Qh(e){const t=e.map(Ka);return t.push(Buffer.from([0])),Buffer.concat(t)}nt.keyValsToBuffer=Qh;function Ka(e){const t=e.key.length,r=e.value.length,n=Ln.encodingLength(t),i=Ln.encodingLength(r),o=Buffer.allocUnsafe(n+t+i+r);return Ln.encode(t,o,0),e.key.copy(o,n),Ln.encode(r,o,n+t),e.value.copy(o,n+t+i),o}nt.keyValToBuffer=Ka;function Wa(e,t){if(typeof e!="number")throw new Error("cannot write a non-number as a number");if(e<0)throw new Error("specified a negative value for writing an unsigned value");if(e>t)throw new Error("RangeError: value out of range");if(Math.floor(e)!==e)throw new Error("value has a fractional component")}function Zh(e,t){const r=e.readUInt32LE(t);let n=e.readUInt32LE(t+4);return n*=4294967296,Wa(n+r,9007199254740991),n+r}nt.readUInt64LE=Zh;function ed(e,t,r){return Wa(t,9007199254740991),e.writeInt32LE(t&-1,r),e.writeUInt32LE(Math.floor(t/4294967296),r+4),r+8}nt.writeUInt64LE=ed;Object.defineProperty(sr,"__esModule",{value:!0});const ja=he,Va=nt,Jn=qe;function td(e){if(e.key[0]!==ja.InputTypes.WITNESS_UTXO)throw new Error("Decode Error: could not decode witnessUtxo with key 0x"+e.key.toString("hex"));const t=Va.readUInt64LE(e.value,0);let r=8;const n=Jn.decode(e.value,r);r+=Jn.encodingLength(n);const i=e.value.slice(r);if(i.length!==n)throw new Error("Decode Error: WITNESS_UTXO script is not proper length");return{script:i,value:t}}sr.decode=td;function rd(e){const{script:t,value:r}=e,n=Jn.encodingLength(t.length),i=Buffer.allocUnsafe(8+n+t.length);return Va.writeUInt64LE(i,r,0),Jn.encode(t.length,i,8),t.copy(i,8+n),{key:Buffer.from([ja.InputTypes.WITNESS_UTXO]),value:i}}sr.encode=rd;sr.expected="{ script: Buffer; value: number; }";function nd(e){return Buffer.isBuffer(e.script)&&typeof e.value=="number"}sr.check=nd;function id(e,t){return!!e&&!!t&&e.witnessUtxo===void 0}sr.canAdd=id;var fr={};Object.defineProperty(fr,"__esModule",{value:!0});const Ga=he,Po=qe;function od(e){if(e.key[0]!==Ga.OutputTypes.TAP_TREE||e.key.length!==1)throw new Error("Decode Error: could not decode tapTree with key 0x"+e.key.toString("hex"));let t=0;const r=[];for(;t<e.value.length;){const n=e.value[t++],i=e.value[t++],o=Po.decode(e.value,t);t+=Po.encodingLength(o),r.push({depth:n,leafVersion:i,script:e.value.slice(t,t+o)}),t+=o}return{leaves:r}}fr.decode=od;function sd(e){const t=Buffer.from([Ga.OutputTypes.TAP_TREE]),r=[].concat(...e.leaves.map(n=>[Buffer.of(n.depth,n.leafVersion),Po.encode(n.script.length),n.script]));return{key:t,value:Buffer.concat(r)}}fr.encode=sd;fr.expected="{ leaves: [{ depth: number; leafVersion: number, script: Buffer; }] }";function fd(e){return Array.isArray(e.leaves)&&e.leaves.every(t=>t.depth>=0&&t.depth<=128&&(t.leafVersion&254)===t.leafVersion&&Buffer.isBuffer(t.script))}fr.check=fd;function ad(e,t){return!!e&&!!t&&e.tapTree===void 0}fr.canAdd=ad;var Si={};Object.defineProperty(Si,"__esModule",{value:!0});const ud=e=>[...Array(e).keys()],cd=e=>e.length===33&&[2,3].includes(e[0])||e.length===65&&e[0]===4;function ld(e,t=cd){function r(f){if(f.key[0]!==e)throw new Error("Decode Error: could not decode bip32Derivation with key 0x"+f.key.toString("hex"));const a=f.key.slice(1);if(!t(a))throw new Error("Decode Error: bip32Derivation has invalid pubkey in key 0x"+f.key.toString("hex"));if(f.value.length/4%1!==0)throw new Error("Decode Error: Input BIP32_DERIVATION value length should be multiple of 4");const u={masterFingerprint:f.value.slice(0,4),pubkey:a,path:"m"};for(const l of ud(f.value.length/4-1)){const c=f.value.readUInt32LE(l*4+4),b=!!(c&2147483648),p=c&2147483647;u.path+="/"+p.toString(10)+(b?"'":"")}return u}function n(f){const a=Buffer.from([e]),u=Buffer.concat([a,f.pubkey]),l=f.path.split("/"),c=Buffer.allocUnsafe(l.length*4);f.masterFingerprint.copy(c,0);let b=4;return l.slice(1).forEach(p=>{const y=p.slice(-1)==="'";let g=2147483647&parseInt(y?p.slice(0,-1):p,10);y&&(g+=2147483648),c.writeUInt32LE(g,b),b+=4}),{key:u,value:c}}const i="{ masterFingerprint: Buffer; pubkey: Buffer; path: string; }";function o(f){return Buffer.isBuffer(f.pubkey)&&Buffer.isBuffer(f.masterFingerprint)&&typeof f.path=="string"&&t(f.pubkey)&&f.masterFingerprint.length===4}function s(f,a,u){const l=a.pubkey.toString("hex");return u.has(l)?!1:(u.add(l),f.filter(c=>c.pubkey.equals(a.pubkey)).length===0)}return{decode:r,encode:n,check:o,expected:i,canAddToArray:s}}Si.makeConverter=ld;var Qo={};Object.defineProperty(Qo,"__esModule",{value:!0});function hd(e){return t;function t(r){let n;if(e.includes(r.key[0])&&(n=r.key.slice(1),!(n.length===33||n.length===65)||![2,3,4].includes(n[0])))throw new Error("Format Error: invalid pubkey in key 0x"+r.key.toString("hex"));return n}}Qo.makeChecker=hd;var Zo={};Object.defineProperty(Zo,"__esModule",{value:!0});function dd(e){function t(s){if(s.key[0]!==e)throw new Error("Decode Error: could not decode redeemScript with key 0x"+s.key.toString("hex"));return s.value}function r(s){return{key:Buffer.from([e]),value:s}}const n="Buffer";function i(s){return Buffer.isBuffer(s)}function o(s,f){return!!s&&!!f&&s.redeemScript===void 0}return{decode:t,encode:r,check:i,expected:n,canAdd:o}}Zo.makeConverter=dd;var es={};Object.defineProperty(es,"__esModule",{value:!0});const Mn=qe,pd=Si,yd=e=>e.length===32;function _d(e){const t=pd.makeConverter(e,yd);function r(s){const f=Mn.decode(s.value),a=Mn.encodingLength(f),u=t.decode({key:s.key,value:s.value.slice(a+f*32)}),l=new Array(f);for(let c=0,b=a;c<f;c++,b+=32)l[c]=s.value.slice(b,b+32);return Object.assign({},u,{leafHashes:l})}function n(s){const f=t.encode(s),a=Mn.encodingLength(s.leafHashes.length),u=Buffer.allocUnsafe(a);Mn.encode(s.leafHashes.length,u);const l=Buffer.concat([u,...s.leafHashes,f.value]);return Object.assign({},f,{value:l})}const i="{ masterFingerprint: Buffer; pubkey: Buffer; path: string; leafHashes: Buffer[]; }";function o(s){return Array.isArray(s.leafHashes)&&s.leafHashes.every(f=>Buffer.isBuffer(f)&&f.length===32)&&t.check(s)}return{decode:r,encode:n,check:o,expected:i,canAddToArray:t.canAddToArray}}es.makeConverter=_d;var ts={};Object.defineProperty(ts,"__esModule",{value:!0});function bd(e){function t(s){if(s.key[0]!==e||s.key.length!==1)throw new Error("Decode Error: could not decode tapInternalKey with key 0x"+s.key.toString("hex"));if(s.value.length!==32)throw new Error("Decode Error: tapInternalKey not a 32-byte x-only pubkey");return s.value}function r(s){return{key:Buffer.from([e]),value:s}}const n="Buffer";function i(s){return Buffer.isBuffer(s)&&s.length===32}function o(s,f){return!!s&&!!f&&s.tapInternalKey===void 0}return{decode:t,encode:r,check:i,expected:n,canAdd:o}}ts.makeConverter=bd;var rs={};Object.defineProperty(rs,"__esModule",{value:!0});function gd(e){function t(s){if(s.key[0]!==e)throw new Error("Decode Error: could not decode witnessScript with key 0x"+s.key.toString("hex"));return s.value}function r(s){return{key:Buffer.from([e]),value:s}}const n="Buffer";function i(s){return Buffer.isBuffer(s)}function o(s,f){return!!s&&!!f&&s.witnessScript===void 0}return{decode:t,encode:r,check:i,expected:n,canAdd:o}}rs.makeConverter=gd;Object.defineProperty(Xt,"__esModule",{value:!0});const Ue=he,wd=Yt,Ed=zo,Sd=zt,vd=Jt,md=Qt,Td=Zt,Pd=er,Id=tr,Ad=rr,kd=nr,Od=ir,Bd=or,xd=sr,Rd=fr,qa=Si,ns=Qo,Xa=Zo,Ya=es,za=ts,Ja=rs,Nd={unsignedTx:Ed,globalXpub:wd,checkPubkey:ns.makeChecker([])};Xt.globals=Nd;const Ud={nonWitnessUtxo:md,partialSig:Td,sighashType:Id,finalScriptSig:Sd,finalScriptWitness:vd,porCommitment:Pd,witnessUtxo:xd,bip32Derivation:qa.makeConverter(Ue.InputTypes.BIP32_DERIVATION),redeemScript:Xa.makeConverter(Ue.InputTypes.REDEEM_SCRIPT),witnessScript:Ja.makeConverter(Ue.InputTypes.WITNESS_SCRIPT),checkPubkey:ns.makeChecker([Ue.InputTypes.PARTIAL_SIG,Ue.InputTypes.BIP32_DERIVATION]),tapKeySig:Ad,tapScriptSig:Bd,tapLeafScript:kd,tapBip32Derivation:Ya.makeConverter(Ue.InputTypes.TAP_BIP32_DERIVATION),tapInternalKey:za.makeConverter(Ue.InputTypes.TAP_INTERNAL_KEY),tapMerkleRoot:Od};Xt.inputs=Ud;const Cd={bip32Derivation:qa.makeConverter(Ue.OutputTypes.BIP32_DERIVATION),redeemScript:Xa.makeConverter(Ue.OutputTypes.REDEEM_SCRIPT),witnessScript:Ja.makeConverter(Ue.OutputTypes.WITNESS_SCRIPT),checkPubkey:ns.makeChecker([Ue.OutputTypes.BIP32_DERIVATION]),tapBip32Derivation:Ya.makeConverter(Ue.OutputTypes.TAP_BIP32_DERIVATION),tapTree:Rd,tapInternalKey:za.makeConverter(Ue.OutputTypes.TAP_INTERNAL_KEY)};Xt.outputs=Cd;Object.defineProperty(wn,"__esModule",{value:!0});const X=Xt,Qn=nt,Vs=qe,H=he;function Hd(e,t){let r=0;function n(){const w=Vs.decode(e,r);r+=Vs.encodingLength(w);const v=e.slice(r,r+w);return r+=w,v}function i(){const w=e.readUInt32BE(r);return r+=4,w}function o(){const w=e.readUInt8(r);return r+=1,w}function s(){const w=n(),v=n();return{key:w,value:v}}function f(){if(r>=e.length)throw new Error("Format Error: Unexpected End of PSBT");const w=e.readUInt8(r)===0;return w&&r++,w}if(i()!==1886610036)throw new Error("Format Error: Invalid Magic Number");if(o()!==255)throw new Error("Format Error: Magic Number must be followed by 0xff separator");const a=[],u={};for(;!f();){const w=s(),v=w.key.toString("hex");if(u[v])throw new Error("Format Error: Keys must be unique for global keymap: key "+v);u[v]=1,a.push(w)}const l=a.filter(w=>w.key[0]===H.GlobalTypes.UNSIGNED_TX);if(l.length!==1)throw new Error("Format Error: Only one UNSIGNED_TX allowed");const c=t(l[0].value),{inputCount:b,outputCount:p}=c.getInputOutputCounts(),y=[],g=[];for(const w of Qn.range(b)){const v={},I=[];for(;!f();){const P=s(),T=P.key.toString("hex");if(v[T])throw new Error("Format Error: Keys must be unique for each input: input index "+w+" key "+T);v[T]=1,I.push(P)}y.push(I)}for(const w of Qn.range(p)){const v={},I=[];for(;!f();){const P=s(),T=P.key.toString("hex");if(v[T])throw new Error("Format Error: Keys must be unique for each output: output index "+w+" key "+T);v[T]=1,I.push(P)}g.push(I)}return Qa(c,{globalMapKeyVals:a,inputKeyVals:y,outputKeyVals:g})}wn.psbtFromBuffer=Hd;function pe(e,t,r){if(!t.equals(Buffer.from([r])))throw new Error(`Format Error: Invalid ${e} key: ${t.toString("hex")}`)}wn.checkKeyBuffer=pe;function Qa(e,{globalMapKeyVals:t,inputKeyVals:r,outputKeyVals:n}){const i={unsignedTx:e};let o=0;for(const l of t)switch(l.key[0]){case H.GlobalTypes.UNSIGNED_TX:if(pe("global",l.key,H.GlobalTypes.UNSIGNED_TX),o>0)throw new Error("Format Error: GlobalMap has multiple UNSIGNED_TX");o++;break;case H.GlobalTypes.GLOBAL_XPUB:i.globalXpub===void 0&&(i.globalXpub=[]),i.globalXpub.push(X.globals.globalXpub.decode(l));break;default:i.unknownKeyVals||(i.unknownKeyVals=[]),i.unknownKeyVals.push(l)}const s=r.length,f=n.length,a=[],u=[];for(const l of Qn.range(s)){const c={};for(const b of r[l])switch(X.inputs.checkPubkey(b),b.key[0]){case H.InputTypes.NON_WITNESS_UTXO:if(pe("input",b.key,H.InputTypes.NON_WITNESS_UTXO),c.nonWitnessUtxo!==void 0)throw new Error("Format Error: Input has multiple NON_WITNESS_UTXO");c.nonWitnessUtxo=X.inputs.nonWitnessUtxo.decode(b);break;case H.InputTypes.WITNESS_UTXO:if(pe("input",b.key,H.InputTypes.WITNESS_UTXO),c.witnessUtxo!==void 0)throw new Error("Format Error: Input has multiple WITNESS_UTXO");c.witnessUtxo=X.inputs.witnessUtxo.decode(b);break;case H.InputTypes.PARTIAL_SIG:c.partialSig===void 0&&(c.partialSig=[]),c.partialSig.push(X.inputs.partialSig.decode(b));break;case H.InputTypes.SIGHASH_TYPE:if(pe("input",b.key,H.InputTypes.SIGHASH_TYPE),c.sighashType!==void 0)throw new Error("Format Error: Input has multiple SIGHASH_TYPE");c.sighashType=X.inputs.sighashType.decode(b);break;case H.InputTypes.REDEEM_SCRIPT:if(pe("input",b.key,H.InputTypes.REDEEM_SCRIPT),c.redeemScript!==void 0)throw new Error("Format Error: Input has multiple REDEEM_SCRIPT");c.redeemScript=X.inputs.redeemScript.decode(b);break;case H.InputTypes.WITNESS_SCRIPT:if(pe("input",b.key,H.InputTypes.WITNESS_SCRIPT),c.witnessScript!==void 0)throw new Error("Format Error: Input has multiple WITNESS_SCRIPT");c.witnessScript=X.inputs.witnessScript.decode(b);break;case H.InputTypes.BIP32_DERIVATION:c.bip32Derivation===void 0&&(c.bip32Derivation=[]),c.bip32Derivation.push(X.inputs.bip32Derivation.decode(b));break;case H.InputTypes.FINAL_SCRIPTSIG:pe("input",b.key,H.InputTypes.FINAL_SCRIPTSIG),c.finalScriptSig=X.inputs.finalScriptSig.decode(b);break;case H.InputTypes.FINAL_SCRIPTWITNESS:pe("input",b.key,H.InputTypes.FINAL_SCRIPTWITNESS),c.finalScriptWitness=X.inputs.finalScriptWitness.decode(b);break;case H.InputTypes.POR_COMMITMENT:pe("input",b.key,H.InputTypes.POR_COMMITMENT),c.porCommitment=X.inputs.porCommitment.decode(b);break;case H.InputTypes.TAP_KEY_SIG:pe("input",b.key,H.InputTypes.TAP_KEY_SIG),c.tapKeySig=X.inputs.tapKeySig.decode(b);break;case H.InputTypes.TAP_SCRIPT_SIG:c.tapScriptSig===void 0&&(c.tapScriptSig=[]),c.tapScriptSig.push(X.inputs.tapScriptSig.decode(b));break;case H.InputTypes.TAP_LEAF_SCRIPT:c.tapLeafScript===void 0&&(c.tapLeafScript=[]),c.tapLeafScript.push(X.inputs.tapLeafScript.decode(b));break;case H.InputTypes.TAP_BIP32_DERIVATION:c.tapBip32Derivation===void 0&&(c.tapBip32Derivation=[]),c.tapBip32Derivation.push(X.inputs.tapBip32Derivation.decode(b));break;case H.InputTypes.TAP_INTERNAL_KEY:pe("input",b.key,H.InputTypes.TAP_INTERNAL_KEY),c.tapInternalKey=X.inputs.tapInternalKey.decode(b);break;case H.InputTypes.TAP_MERKLE_ROOT:pe("input",b.key,H.InputTypes.TAP_MERKLE_ROOT),c.tapMerkleRoot=X.inputs.tapMerkleRoot.decode(b);break;default:c.unknownKeyVals||(c.unknownKeyVals=[]),c.unknownKeyVals.push(b)}a.push(c)}for(const l of Qn.range(f)){const c={};for(const b of n[l])switch(X.outputs.checkPubkey(b),b.key[0]){case H.OutputTypes.REDEEM_SCRIPT:if(pe("output",b.key,H.OutputTypes.REDEEM_SCRIPT),c.redeemScript!==void 0)throw new Error("Format Error: Output has multiple REDEEM_SCRIPT");c.redeemScript=X.outputs.redeemScript.decode(b);break;case H.OutputTypes.WITNESS_SCRIPT:if(pe("output",b.key,H.OutputTypes.WITNESS_SCRIPT),c.witnessScript!==void 0)throw new Error("Format Error: Output has multiple WITNESS_SCRIPT");c.witnessScript=X.outputs.witnessScript.decode(b);break;case H.OutputTypes.BIP32_DERIVATION:c.bip32Derivation===void 0&&(c.bip32Derivation=[]),c.bip32Derivation.push(X.outputs.bip32Derivation.decode(b));break;case H.OutputTypes.TAP_INTERNAL_KEY:pe("output",b.key,H.OutputTypes.TAP_INTERNAL_KEY),c.tapInternalKey=X.outputs.tapInternalKey.decode(b);break;case H.OutputTypes.TAP_TREE:pe("output",b.key,H.OutputTypes.TAP_TREE),c.tapTree=X.outputs.tapTree.decode(b);break;case H.OutputTypes.TAP_BIP32_DERIVATION:c.tapBip32Derivation===void 0&&(c.tapBip32Derivation=[]),c.tapBip32Derivation.push(X.outputs.tapBip32Derivation.decode(b));break;default:c.unknownKeyVals||(c.unknownKeyVals=[]),c.unknownKeyVals.push(b)}u.push(c)}return{globalMap:i,inputs:a,outputs:u}}wn.psbtFromKeyVals=Qa;var vi={};Object.defineProperty(vi,"__esModule",{value:!0});const Zi=Xt,Gs=nt;function Ld({globalMap:e,inputs:t,outputs:r}){const{globalKeyVals:n,inputKeyVals:i,outputKeyVals:o}=Za({globalMap:e,inputs:t,outputs:r}),s=Gs.keyValsToBuffer(n),f=c=>c.length===0?[Buffer.from([0])]:c.map(Gs.keyValsToBuffer),a=f(i),u=f(o),l=Buffer.allocUnsafe(5);return l.writeUIntBE(482972169471,0,5),Buffer.concat([l,s].concat(a,u))}vi.psbtToBuffer=Ld;const Md=(e,t)=>e.key.compare(t.key);function eo(e,t){const r=new Set,n=Object.entries(e).reduce((o,[s,f])=>{if(s==="unknownKeyVals")return o;const a=t[s];if(a===void 0)return o;const u=(Array.isArray(f)?f:[f]).map(a.encode);return u.map(c=>c.key.toString("hex")).forEach(c=>{if(r.has(c))throw new Error("Serialize Error: Duplicate key: "+c);r.add(c)}),o.concat(u)},[]),i=e.unknownKeyVals?e.unknownKeyVals.filter(o=>!r.has(o.key.toString("hex"))):[];return n.concat(i).sort(Md)}function Za({globalMap:e,inputs:t,outputs:r}){return{globalKeyVals:eo(e,Zi.globals),inputKeyVals:t.map(n=>eo(n,Zi.inputs)),outputKeyVals:r.map(n=>eo(n,Zi.outputs))}}vi.psbtToKeyVals=Za;(function(e){function t(r){for(var n in r)e.hasOwnProperty(n)||(e[n]=r[n])}Object.defineProperty(e,"__esModule",{value:!0}),t(wn),t(vi)})(Yo);Object.defineProperty(Xo,"__esModule",{value:!0});const to=Yo;function $d(e){const t=e[0],r=to.psbtToKeyVals(t),n=e.slice(1);if(n.length===0)throw new Error("Combine: Nothing to combine");const i=qs(t);if(i===void 0)throw new Error("Combine: Self missing transaction");const o=Er(r.globalKeyVals),s=r.inputKeyVals.map(Er),f=r.outputKeyVals.map(Er);for(const a of n){const u=qs(a);if(u===void 0||!u.toBuffer().equals(i.toBuffer()))throw new Error("Combine: One of the Psbts does not have the same transaction.");const l=to.psbtToKeyVals(a);Er(l.globalKeyVals).forEach(ro(o,r.globalKeyVals,l.globalKeyVals)),l.inputKeyVals.map(Er).forEach((y,g)=>y.forEach(ro(s[g],r.inputKeyVals[g],l.inputKeyVals[g]))),l.outputKeyVals.map(Er).forEach((y,g)=>y.forEach(ro(f[g],r.outputKeyVals[g],l.outputKeyVals[g])))}return to.psbtFromKeyVals(i,{globalMapKeyVals:r.globalKeyVals,inputKeyVals:r.inputKeyVals,outputKeyVals:r.outputKeyVals})}Xo.combine=$d;function ro(e,t,r){return n=>{if(e.has(n))return;const i=r.filter(o=>o.key.toString("hex")===n)[0];t.push(i),e.add(n)}}function qs(e){return e.globalMap.unsignedTx}function Er(e){const t=new Set;return e.forEach(r=>{const n=r.key.toString("hex");if(t.has(n))throw new Error("Combine: KeyValue Map keys should be unique");t.add(n)}),t}var is={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Xt;function r(p,y){const g=p[y];if(g===void 0)throw new Error(`No input #${y}`);return g}e.checkForInput=r;function n(p,y){const g=p[y];if(g===void 0)throw new Error(`No output #${y}`);return g}e.checkForOutput=n;function i(p,y,g){if(p.key[0]<g)throw new Error("Use the method for your specific key instead of addUnknownKeyVal*");if(y&&y.filter(w=>w.key.equals(p.key)).length!==0)throw new Error(`Duplicate Key: ${p.key.toString("hex")}`)}e.checkHasKey=i;function o(p){let y=0;return Object.keys(p).forEach(g=>{Number(isNaN(Number(g)))&&y++}),y}e.getEnumLength=o;function s(p,y){let g=!1;if(y.nonWitnessUtxo||y.witnessUtxo){const w=!!y.redeemScript,v=!!y.witnessScript,I=!w||!!y.finalScriptSig,P=!v||!!y.finalScriptWitness,T=!!y.finalScriptSig||!!y.finalScriptWitness;g=I&&P&&T}if(g===!1)throw new Error(`Input #${p} has too much or too little data to clean`)}e.inputCheckUncleanFinalized=s;function f(p,y,g,w){throw new Error(`Data for ${p} key ${y} is incorrect: Expected ${g} and got ${JSON.stringify(w)}`)}function a(p){return(y,g)=>{for(const w of Object.keys(y)){const v=y[w],{canAdd:I,canAddToArray:P,check:T,expected:A}=t[p+"s"][w]||{},_=!!P;if(T)if(_){if(!Array.isArray(v)||g[w]&&!Array.isArray(g[w]))throw new Error(`Key type ${w} must be an array`);v.every(T)||f(p,w,A,v);const O=g[w]||[],x=new Set;if(!v.every(m=>P(O,m,x)))throw new Error("Can not add duplicate data to array");g[w]=O.concat(v)}else{if(T(v)||f(p,w,A,v),!I(g,v))throw new Error(`Can not add duplicate data to ${p}`);g[w]=v}}}}e.updateGlobal=a("global"),e.updateInput=a("input"),e.updateOutput=a("output");function u(p,y){const g=p.length-1,w=r(p,g);e.updateInput(y,w)}e.addInputAttributes=u;function l(p,y){const g=p.length-1,w=n(p,g);e.updateOutput(y,w)}e.addOutputAttributes=l;function c(p,y){if(!Buffer.isBuffer(y)||y.length<4)throw new Error("Set Version: Invalid Transaction");return y.writeUInt32LE(p,0),y}e.defaultVersionSetter=c;function b(p,y){if(!Buffer.isBuffer(y)||y.length<4)throw new Error("Set Locktime: Invalid Transaction");return y.writeUInt32LE(p,y.length-4),y}e.defaultLocktimeSetter=b})(is);Object.defineProperty(qo,"__esModule",{value:!0});const Fd=Xo,Xs=Yo,no=he,de=is;let Dd=class{constructor(t){this.inputs=[],this.outputs=[],this.globalMap={unsignedTx:t}}static fromBase64(t,r){const n=Buffer.from(t,"base64");return this.fromBuffer(n,r)}static fromHex(t,r){const n=Buffer.from(t,"hex");return this.fromBuffer(n,r)}static fromBuffer(t,r){const n=Xs.psbtFromBuffer(t,r),i=new this(n.globalMap.unsignedTx);return Object.assign(i,n),i}toBase64(){return this.toBuffer().toString("base64")}toHex(){return this.toBuffer().toString("hex")}toBuffer(){return Xs.psbtToBuffer(this)}updateGlobal(t){return de.updateGlobal(t,this.globalMap),this}updateInput(t,r){const n=de.checkForInput(this.inputs,t);return de.updateInput(r,n),this}updateOutput(t,r){const n=de.checkForOutput(this.outputs,t);return de.updateOutput(r,n),this}addUnknownKeyValToGlobal(t){return de.checkHasKey(t,this.globalMap.unknownKeyVals,de.getEnumLength(no.GlobalTypes)),this.globalMap.unknownKeyVals||(this.globalMap.unknownKeyVals=[]),this.globalMap.unknownKeyVals.push(t),this}addUnknownKeyValToInput(t,r){const n=de.checkForInput(this.inputs,t);return de.checkHasKey(r,n.unknownKeyVals,de.getEnumLength(no.InputTypes)),n.unknownKeyVals||(n.unknownKeyVals=[]),n.unknownKeyVals.push(r),this}addUnknownKeyValToOutput(t,r){const n=de.checkForOutput(this.outputs,t);return de.checkHasKey(r,n.unknownKeyVals,de.getEnumLength(no.OutputTypes)),n.unknownKeyVals||(n.unknownKeyVals=[]),n.unknownKeyVals.push(r),this}addInput(t){this.globalMap.unsignedTx.addInput(t),this.inputs.push({unknownKeyVals:[]});const r=t.unknownKeyVals||[],n=this.inputs.length-1;if(!Array.isArray(r))throw new Error("unknownKeyVals must be an Array");return r.forEach(i=>this.addUnknownKeyValToInput(n,i)),de.addInputAttributes(this.inputs,t),this}addOutput(t){this.globalMap.unsignedTx.addOutput(t),this.outputs.push({unknownKeyVals:[]});const r=t.unknownKeyVals||[],n=this.outputs.length-1;if(!Array.isArray(r))throw new Error("unknownKeyVals must be an Array");return r.forEach(i=>this.addUnknownKeyValToInput(n,i)),de.addOutputAttributes(this.outputs,t),this}clearFinalizedInput(t){const r=de.checkForInput(this.inputs,t);de.inputCheckUncleanFinalized(t,r);for(const n of Object.keys(r))["witnessUtxo","nonWitnessUtxo","finalScriptSig","finalScriptWitness","unknownKeyVals"].includes(n)||delete r[n];return this}combine(...t){const r=Fd.combine([this].concat(t));return Object.assign(this,r),this}getTransaction(){return this.globalMap.unsignedTx.toBuffer()}};qo.Psbt=Dd;var Z={},G={};Object.defineProperty(G,"__esModule",{value:!0});G.signatureBlocksAction=G.checkInputForSig=G.pubkeyInScript=G.pubkeyPositionInScript=G.witnessStackToScriptWitness=G.isP2TR=G.isP2SHScript=G.isP2WSHScript=G.isP2WPKH=G.isP2PKH=G.isP2PK=G.isP2MS=void 0;const Ys=qe,cn=Be,$n=Ht,Kd=rt,ar=Hr;function ur(e){return t=>{try{return e({output:t}),!0}catch{return!1}}}G.isP2MS=ur(ar.p2ms);G.isP2PK=ur(ar.p2pk);G.isP2PKH=ur(ar.p2pkh);G.isP2WPKH=ur(ar.p2wpkh);G.isP2WSHScript=ur(ar.p2wsh);G.isP2SHScript=ur(ar.p2sh);G.isP2TR=ur(ar.p2tr);function Wd(e){let t=Buffer.allocUnsafe(0);function r(s){t=Buffer.concat([t,Buffer.from(s)])}function n(s){const f=t.length,a=Ys.encodingLength(s);t=Buffer.concat([t,Buffer.allocUnsafe(a)]),Ys.encode(s,t,f)}function i(s){n(s.length),r(s)}function o(s){n(s.length),s.forEach(i)}return o(e),t}G.witnessStackToScriptWitness=Wd;function eu(e,t){const r=(0,Kd.hash160)(e),n=e.slice(1,33),i=cn.decompile(t);if(i===null)throw new Error("Unknown script error");return i.findIndex(o=>typeof o=="number"?!1:o.equals(e)||o.equals(r)||o.equals(n))}G.pubkeyPositionInScript=eu;function jd(e,t){return eu(e,t)!==-1}G.pubkeyInScript=jd;function Vd(e,t){return Gd(e).some(n=>tu(n,cn.signature.decode,t))}G.checkInputForSig=Vd;function tu(e,t,r){const{hashType:n}=t(e),i=[];switch(n&$n.Transaction.SIGHASH_ANYONECANPAY&&i.push("addInput"),n&31){case $n.Transaction.SIGHASH_ALL:break;case $n.Transaction.SIGHASH_SINGLE:case $n.Transaction.SIGHASH_NONE:i.push("addOutput"),i.push("setInputSequence");break}return i.indexOf(r)===-1}G.signatureBlocksAction=tu;function Gd(e){let t=[];if((e.partialSig||[]).length===0){if(!e.finalScriptSig&&!e.finalScriptWitness)return[];t=qd(e)}else t=e.partialSig;return t.map(r=>r.signature)}function qd(e){const t=e.finalScriptSig?cn.decompile(e.finalScriptSig)||[]:[],r=e.finalScriptWitness?cn.decompile(e.finalScriptWitness)||[]:[];return t.concat(r).filter(n=>Buffer.isBuffer(n)&&cn.isCanonicalScriptSignature(n)).map(n=>({signature:n}))}Object.defineProperty(Z,"__esModule",{value:!0});Z.checkTaprootInputForSigs=Z.tapTreeFromList=Z.tapTreeToList=Z.tweakInternalPubKey=Z.checkTaprootOutputFields=Z.checkTaprootInputFields=Z.isTaprootOutput=Z.isTaprootInput=Z.serializeTaprootSignature=Z.tapScriptFinalizer=Z.toXOnly=void 0;const os=be,Xd=Ht,mi=G,Ut=bi,Yd=Hr,zd=G,Jd=e=>e.length===32?e:e.slice(1,33);Z.toXOnly=Jd;function Qd(e,t,r){const n=_0(t,e,r);try{const o=p0(t,n).concat(n.script).concat(n.controlBlock);return{finalScriptWitness:(0,mi.witnessStackToScriptWitness)(o)}}catch(i){throw new Error(`Can not finalize taproot input #${e}: ${i}`)}}Z.tapScriptFinalizer=Qd;function Zd(e,t){const r=t?Buffer.from([t]):Buffer.from([]);return Buffer.concat([e,r])}Z.serializeTaprootSignature=Zd;function jn(e){return e&&!!(e.tapInternalKey||e.tapMerkleRoot||e.tapLeafScript&&e.tapLeafScript.length||e.tapBip32Derivation&&e.tapBip32Derivation.length||e.witnessUtxo&&(0,mi.isP2TR)(e.witnessUtxo.script))}Z.isTaprootInput=jn;function Vn(e,t){return e&&!!(e.tapInternalKey||e.tapTree||e.tapBip32Derivation&&e.tapBip32Derivation.length||t&&(0,mi.isP2TR)(t))}Z.isTaprootOutput=Vn;function e0(e,t,r){l0(e,t,r),d0(e,t,r)}Z.checkTaprootInputFields=e0;function t0(e,t,r){h0(e,t,r),r0(e,t)}Z.checkTaprootOutputFields=t0;function r0(e,t){if(!t.tapTree&&!t.tapInternalKey)return;const r=t.tapInternalKey||e.tapInternalKey,n=t.tapTree||e.tapTree;if(r){const{script:i}=e,o=n0(r,n);if(i&&!i.equals(o))throw new Error("Error adding output. Script or address missmatch.")}}function n0(e,t){const r=t&&ru(t.leaves),{output:n}=(0,Yd.p2tr)({internalPubkey:e,scriptTree:r});return n}function i0(e,t){const r=t.tapInternalKey,n=r&&(0,Ut.tweakKey)(r,t.tapMerkleRoot);if(!n)throw new Error(`Cannot tweak tap internal key for input #${e}. Public key: ${r&&r.toString("hex")}`);return n.x}Z.tweakInternalPubKey=i0;function o0(e){if(!(0,os.isTaptree)(e))throw new Error("Cannot convert taptree to tapleaf list. Expecting a tapree structure.");return Io(e)}Z.tapTreeToList=o0;function ru(e=[]){return e.length===1&&e[0].depth===0?{output:e[0].script,version:e[0].leafVersion}:c0(e)}Z.tapTreeFromList=ru;function s0(e,t){return a0(e).some(n=>(0,zd.signatureBlocksAction)(n,f0,t))}Z.checkTaprootInputForSigs=s0;function f0(e){return{signature:e.slice(0,64),hashType:e.slice(64)[0]||Xd.Transaction.SIGHASH_DEFAULT}}function a0(e){const t=[];if(e.tapKeySig&&t.push(e.tapKeySig),e.tapScriptSig&&t.push(...e.tapScriptSig.map(r=>r.signature)),!t.length){const r=u0(e.finalScriptWitness);r&&t.push(r)}return t}function u0(e){if(!e)return;const t=e.slice(2);if(t.length===64||t.length===65)return t}function Io(e,t=[],r=0){if(r>Ut.MAX_TAPTREE_DEPTH)throw new Error("Max taptree depth exceeded.");return e?(0,os.isTapleaf)(e)?(t.push({depth:r,leafVersion:e.version||Ut.LEAF_VERSION_TAPSCRIPT,script:e.output}),t):(e[0]&&Io(e[0],t,r+1),e[1]&&Io(e[1],t,r+1),t):[]}function c0(e){let t;for(const r of e)if(t=Ao(r,t),!t)throw new Error("No room left to insert tapleaf in tree");return t}function Ao(e,t,r=0){if(r>Ut.MAX_TAPTREE_DEPTH)throw new Error("Max taptree depth exceeded.");if(e.depth===r)return t?void 0:{output:e.script,version:e.leafVersion};if((0,os.isTapleaf)(t))return;const n=Ao(e,t&&t[0],r+1);if(n)return[n,t&&t[1]];const i=Ao(e,t&&t[1],r+1);if(i)return[t&&t[0],i]}function l0(e,t,r){const n=jn(e)&&kr(t),i=kr(e)&&jn(t),o=e===t&&jn(t)&&kr(t);if(n||i||o)throw new Error(`Invalid arguments for Psbt.${r}. Cannot use both taproot and non-taproot fields.`)}function h0(e,t,r){const n=Vn(e)&&kr(t),i=kr(e)&&Vn(t),o=e===t&&Vn(t)&&kr(t);if(n||i||o)throw new Error(`Invalid arguments for Psbt.${r}. Cannot use both taproot and non-taproot fields.`)}function d0(e,t,r){if(t.tapMerkleRoot){const n=(t.tapLeafScript||[]).every(o=>io(o,t.tapMerkleRoot)),i=(e.tapLeafScript||[]).every(o=>io(o,t.tapMerkleRoot));if(!n||!i)throw new Error(`Invalid arguments for Psbt.${r}. Tapleaf not part of taptree.`)}else if(e.tapMerkleRoot&&!(t.tapLeafScript||[]).every(i=>io(i,e.tapMerkleRoot)))throw new Error(`Invalid arguments for Psbt.${r}. Tapleaf not part of taptree.`)}function io(e,t){if(!t)return!0;const r=(0,Ut.tapleafHash)({output:e.script,version:e.leafVersion});return(0,Ut.rootHashFromPath)(e.controlBlock,r).equals(t)}function p0(e,t){const r=(0,Ut.tapleafHash)({output:t.script,version:t.leafVersion});return(e.tapScriptSig||[]).filter(n=>n.leafHash.equals(r)).map(n=>y0(t.script,n)).sort((n,i)=>i.positionInScript-n.positionInScript).map(n=>n.signature)}function y0(e,t){return Object.assign({positionInScript:(0,mi.pubkeyPositionInScript)(t.pubkey,e)},t)}function _0(e,t,r){if(!e.tapScriptSig||!e.tapScriptSig.length)throw new Error(`Can not finalize taproot input #${t}. No tapleaf script signature provided.`);const n=(e.tapLeafScript||[]).sort((i,o)=>i.controlBlock.length-o.controlBlock.length).find(i=>b0(i,e.tapScriptSig,r));if(!n)throw new Error(`Can not finalize taproot input #${t}. Signature for tapleaf script not found.`);return n}function b0(e,t,r){const n=(0,Ut.tapleafHash)({output:e.script,version:e.leafVersion});return(!r||r.equals(n))&&t.find(o=>o.leafHash.equals(n))!==void 0}function kr(e){return e&&!!(e.redeemScript||e.witnessScript||e.bip32Derivation&&e.bip32Derivation.length)}Object.defineProperty(Ei,"__esModule",{value:!0});Ei.Psbt=void 0;const zs=qo,Js=qe,Pe=is,Qs=ke,Zn=ae,g0=le,Fe=Hr,w0=bi,_t=Be,_e=Ht,te=Z,oe=G,E0={network:g0.bitcoin,maximumFeeRate:5e3};class ei{static fromBase64(t,r={}){const n=Buffer.from(t,"base64");return this.fromBuffer(n,r)}static fromHex(t,r={}){const n=Buffer.from(t,"hex");return this.fromBuffer(n,r)}static fromBuffer(t,r={}){const n=zs.Psbt.fromBuffer(t,S0),i=new ei(r,n);return I0(i.__CACHE.__TX,i.__CACHE),i}constructor(t={},r=new zs.Psbt(new nu)){this.data=r,this.opts=Object.assign({},E0,t),this.__CACHE={__NON_WITNESS_UTXO_TX_CACHE:[],__NON_WITNESS_UTXO_BUF_CACHE:[],__TX_IN_CACHE:{},__TX:this.data.globalMap.unsignedTx.tx,__UNSAFE_SIGN_NONSEGWIT:!1},this.data.inputs.length===0&&this.setVersion(2);const n=(i,o,s,f)=>Object.defineProperty(i,o,{enumerable:s,writable:f});n(this,"__CACHE",!1,!0),n(this,"opts",!1,!0)}get inputCount(){return this.data.inputs.length}get version(){return this.__CACHE.__TX.version}set version(t){this.setVersion(t)}get locktime(){return this.__CACHE.__TX.locktime}set locktime(t){this.setLocktime(t)}get txInputs(){return this.__CACHE.__TX.ins.map(t=>({hash:(0,Zn.cloneBuffer)(t.hash),index:t.index,sequence:t.sequence}))}get txOutputs(){return this.__CACHE.__TX.outs.map(t=>{let r;try{r=(0,Qs.fromOutputScript)(t.script,this.opts.network)}catch{}return{script:(0,Zn.cloneBuffer)(t.script),value:t.value,address:r}})}combine(...t){return this.data.combine(...t.map(r=>r.data)),this}clone(){const t=ei.fromBuffer(this.data.toBuffer());return t.opts=JSON.parse(JSON.stringify(this.opts)),t}setMaximumFeeRate(t){Fn(t),this.opts.maximumFeeRate=t}setVersion(t){Fn(t),zr(this.data.inputs,"setVersion");const r=this.__CACHE;return r.__TX.version=t,r.__EXTRACTED_TX=void 0,this}setLocktime(t){Fn(t),zr(this.data.inputs,"setLocktime");const r=this.__CACHE;return r.__TX.locktime=t,r.__EXTRACTED_TX=void 0,this}setInputSequence(t,r){Fn(r),zr(this.data.inputs,"setInputSequence");const n=this.__CACHE;if(n.__TX.ins.length<=t)throw new Error("Input index too high");return n.__TX.ins[t].sequence=r,n.__EXTRACTED_TX=void 0,this}addInputs(t){return t.forEach(r=>this.addInput(r)),this}addInput(t){if(arguments.length>1||!t||t.hash===void 0||t.index===void 0)throw new Error("Invalid arguments for Psbt.addInput. Requires single object with at least [hash] and [index]");(0,te.checkTaprootInputFields)(t,t,"addInput"),zr(this.data.inputs,"addInput"),t.witnessScript&&ti(t.witnessScript);const r=this.__CACHE;this.data.addInput(t);const n=r.__TX.ins[r.__TX.ins.length-1];su(r,n);const i=this.data.inputs.length-1,o=this.data.inputs[i];return o.nonWitnessUtxo&&Oo(this.__CACHE,o,i),r.__FEE=void 0,r.__FEE_RATE=void 0,r.__EXTRACTED_TX=void 0,this}addOutputs(t){return t.forEach(r=>this.addOutput(r)),this}addOutput(t){if(arguments.length>1||!t||t.value===void 0||t.address===void 0&&t.script===void 0)throw new Error("Invalid arguments for Psbt.addOutput. Requires single object with at least [script or address] and [value]");zr(this.data.inputs,"addOutput");const{address:r}=t;if(typeof r=="string"){const{network:i}=this.opts,o=(0,Qs.toOutputScript)(r,i);t=Object.assign(t,{script:o})}(0,te.checkTaprootOutputFields)(t,t,"addOutput");const n=this.__CACHE;return this.data.addOutput(t),n.__FEE=void 0,n.__FEE_RATE=void 0,n.__EXTRACTED_TX=void 0,this}extractTransaction(t){if(!this.data.inputs.every(iu))throw new Error("Not finalized");const r=this.__CACHE;if(t||m0(this,r,this.opts),r.__EXTRACTED_TX)return r.__EXTRACTED_TX;const n=r.__TX.clone();return hu(this.data.inputs,n,r,!0),n}getFeeRate(){return nf("__FEE_RATE","fee rate",this.data.inputs,this.__CACHE)}getFee(){return nf("__FEE","fee",this.data.inputs,this.__CACHE)}finalizeAllInputs(){return(0,Pe.checkForInput)(this.data.inputs,0),Jr(this.data.inputs.length).forEach(t=>this.finalizeInput(t)),this}finalizeInput(t,r){const n=(0,Pe.checkForInput)(this.data.inputs,t);return(0,te.isTaprootInput)(n)?this._finalizeTaprootInput(t,n,void 0,r):this._finalizeInput(t,n,r)}finalizeTaprootInput(t,r,n=te.tapScriptFinalizer){const i=(0,Pe.checkForInput)(this.data.inputs,t);if((0,te.isTaprootInput)(i))return this._finalizeTaprootInput(t,i,r,n);throw new Error(`Cannot finalize input #${t}. Not Taproot.`)}_finalizeInput(t,r,n=A0){const{script:i,isP2SH:o,isP2WSH:s,isSegwit:f}=x0(t,r,this.__CACHE);if(!i)throw new Error(`No script found for input #${t}`);T0(r);const{finalScriptSig:a,finalScriptWitness:u}=n(t,r,i,f,o,s);if(a&&this.data.updateInput(t,{finalScriptSig:a}),u&&this.data.updateInput(t,{finalScriptWitness:u}),!a&&!u)throw new Error(`Unknown error finalizing input #${t}`);return this.data.clearFinalizedInput(t),this}_finalizeTaprootInput(t,r,n,i=te.tapScriptFinalizer){if(!r.witnessUtxo)throw new Error(`Cannot finalize input #${t}. Missing withness utxo.`);if(r.tapKeySig){const o=Fe.p2tr({output:r.witnessUtxo.script,signature:r.tapKeySig}),s=(0,oe.witnessStackToScriptWitness)(o.witness);this.data.updateInput(t,{finalScriptWitness:s})}else{const{finalScriptWitness:o}=i(t,r,n);this.data.updateInput(t,{finalScriptWitness:o})}return this.data.clearFinalizedInput(t),this}getInputType(t){const r=(0,Pe.checkForInput)(this.data.inputs,t),n=du(t,r,this.__CACHE),i=Pi(n,t,"input",r.redeemScript||H0(r.finalScriptSig),r.witnessScript||L0(r.finalScriptWitness)),o=i.type==="raw"?"":i.type+"-",s=yu(i.meaningfulScript);return o+s}inputHasPubkey(t,r){const n=(0,Pe.checkForInput)(this.data.inputs,t);return U0(r,n,t,this.__CACHE)}inputHasHDKey(t,r){const n=(0,Pe.checkForInput)(this.data.inputs,t),i=ef(r);return!!n.bip32Derivation&&n.bip32Derivation.some(i)}outputHasPubkey(t,r){const n=(0,Pe.checkForOutput)(this.data.outputs,t);return C0(r,n,t,this.__CACHE)}outputHasHDKey(t,r){const n=(0,Pe.checkForOutput)(this.data.outputs,t),i=ef(r);return!!n.bip32Derivation&&n.bip32Derivation.some(i)}validateSignaturesOfAllInputs(t){return(0,Pe.checkForInput)(this.data.inputs,0),Jr(this.data.inputs.length).map(n=>this.validateSignaturesOfInput(n,t)).reduce((n,i)=>i===!0&&n,!0)}validateSignaturesOfInput(t,r,n){const i=this.data.inputs[t];return(0,te.isTaprootInput)(i)?this.validateSignaturesOfTaprootInput(t,r,n):this._validateSignaturesOfInput(t,r,n)}_validateSignaturesOfInput(t,r,n){const i=this.data.inputs[t],o=(i||{}).partialSig;if(!i||!o||o.length<1)throw new Error("No signatures to validate");if(typeof r!="function")throw new Error("Need validator function to validate signatures");const s=n?o.filter(c=>c.pubkey.equals(n)):o;if(s.length<1)throw new Error("No signatures for this pubkey");const f=[];let a,u,l;for(const c of s){const b=_t.signature.decode(c.signature),{hash:p,script:y}=l!==b.hashType?au(t,Object.assign({},i,{sighashType:b.hashType}),this.__CACHE,!0):{hash:a,script:u};l=b.hashType,a=p,u=y,ou(c.pubkey,y,"verify"),f.push(r(c.pubkey,p,b.signature))}return f.every(c=>c===!0)}validateSignaturesOfTaprootInput(t,r,n){const i=this.data.inputs[t],o=(i||{}).tapKeySig,s=(i||{}).tapScriptSig;if(!i&&!o&&!(s&&!s.length))throw new Error("No signatures to validate");if(typeof r!="function")throw new Error("Need validator function to validate signatures");n=n&&(0,te.toXOnly)(n);const f=n?ko(t,i,this.data.inputs,n,this.__CACHE):O0(t,i,this.data.inputs,this.__CACHE);if(!f.length)throw new Error("No signatures for this pubkey");const a=f.find(l=>!l.leafHash);let u=0;if(o&&a){if(!r(a.pubkey,a.hash,sf(o)))return!1;u++}if(s)for(const l of s){const c=f.find(b=>l.pubkey.equals(b.pubkey));if(c){if(!r(l.pubkey,c.hash,sf(l.signature)))return!1;u++}}return u>0}signAllInputsHD(t,r=[_e.Transaction.SIGHASH_ALL]){if(!t||!t.publicKey||!t.fingerprint)throw new Error("Need HDSigner to sign input");const n=[];for(const i of Jr(this.data.inputs.length))try{this.signInputHD(i,t,r),n.push(!0)}catch{n.push(!1)}if(n.every(i=>i===!1))throw new Error("No inputs were signed");return this}signAllInputsHDAsync(t,r=[_e.Transaction.SIGHASH_ALL]){return new Promise((n,i)=>{if(!t||!t.publicKey||!t.fingerprint)return i(new Error("Need HDSigner to sign input"));const o=[],s=[];for(const f of Jr(this.data.inputs.length))s.push(this.signInputHDAsync(f,t,r).then(()=>{o.push(!0)},()=>{o.push(!1)}));return Promise.all(s).then(()=>{if(o.every(f=>f===!1))return i(new Error("No inputs were signed"));n()})})}signInputHD(t,r,n=[_e.Transaction.SIGHASH_ALL]){if(!r||!r.publicKey||!r.fingerprint)throw new Error("Need HDSigner to sign input");return ff(t,this.data.inputs,r).forEach(o=>this.signInput(t,o,n)),this}signInputHDAsync(t,r,n=[_e.Transaction.SIGHASH_ALL]){return new Promise((i,o)=>{if(!r||!r.publicKey||!r.fingerprint)return o(new Error("Need HDSigner to sign input"));const f=ff(t,this.data.inputs,r).map(a=>this.signInputAsync(t,a,n));return Promise.all(f).then(()=>{i()}).catch(o)})}signAllInputs(t,r){if(!t||!t.publicKey)throw new Error("Need Signer to sign input");const n=[];for(const i of Jr(this.data.inputs.length))try{this.signInput(i,t,r),n.push(!0)}catch{n.push(!1)}if(n.every(i=>i===!1))throw new Error("No inputs were signed");return this}signAllInputsAsync(t,r){return new Promise((n,i)=>{if(!t||!t.publicKey)return i(new Error("Need Signer to sign input"));const o=[],s=[];for(const[f]of this.data.inputs.entries())s.push(this.signInputAsync(f,t,r).then(()=>{o.push(!0)},()=>{o.push(!1)}));return Promise.all(s).then(()=>{if(o.every(f=>f===!1))return i(new Error("No inputs were signed"));n()})})}signInput(t,r,n){if(!r||!r.publicKey)throw new Error("Need Signer to sign input");const i=(0,Pe.checkForInput)(this.data.inputs,t);return(0,te.isTaprootInput)(i)?this._signTaprootInput(t,i,r,void 0,n):this._signInput(t,r,n)}signTaprootInput(t,r,n,i){if(!r||!r.publicKey)throw new Error("Need Signer to sign input");const o=(0,Pe.checkForInput)(this.data.inputs,t);if((0,te.isTaprootInput)(o))return this._signTaprootInput(t,o,r,n,i);throw new Error(`Input #${t} is not of type Taproot.`)}_signInput(t,r,n=[_e.Transaction.SIGHASH_ALL]){const{hash:i,sighashType:o}=of(this.data.inputs,t,r.publicKey,this.__CACHE,n),s=[{pubkey:r.publicKey,signature:_t.signature.encode(r.sign(i),o)}];return this.data.updateInput(t,{partialSig:s}),this}_signTaprootInput(t,r,n,i,o=[_e.Transaction.SIGHASH_DEFAULT]){const s=this.checkTaprootHashesForSig(t,r,n,i,o),f=s.filter(u=>!u.leafHash).map(u=>(0,te.serializeTaprootSignature)(n.signSchnorr(u.hash),r.sighashType))[0],a=s.filter(u=>!!u.leafHash).map(u=>({pubkey:(0,te.toXOnly)(n.publicKey),signature:(0,te.serializeTaprootSignature)(n.signSchnorr(u.hash),r.sighashType),leafHash:u.leafHash}));return f&&this.data.updateInput(t,{tapKeySig:f}),a.length&&this.data.updateInput(t,{tapScriptSig:a}),this}signInputAsync(t,r,n){return Promise.resolve().then(()=>{if(!r||!r.publicKey)throw new Error("Need Signer to sign input");const i=(0,Pe.checkForInput)(this.data.inputs,t);return(0,te.isTaprootInput)(i)?this._signTaprootInputAsync(t,i,r,void 0,n):this._signInputAsync(t,r,n)})}signTaprootInputAsync(t,r,n,i){return Promise.resolve().then(()=>{if(!r||!r.publicKey)throw new Error("Need Signer to sign input");const o=(0,Pe.checkForInput)(this.data.inputs,t);if((0,te.isTaprootInput)(o))return this._signTaprootInputAsync(t,o,r,n,i);throw new Error(`Input #${t} is not of type Taproot.`)})}_signInputAsync(t,r,n=[_e.Transaction.SIGHASH_ALL]){const{hash:i,sighashType:o}=of(this.data.inputs,t,r.publicKey,this.__CACHE,n);return Promise.resolve(r.sign(i)).then(s=>{const f=[{pubkey:r.publicKey,signature:_t.signature.encode(s,o)}];this.data.updateInput(t,{partialSig:f})})}async _signTaprootInputAsync(t,r,n,i,o=[_e.Transaction.SIGHASH_DEFAULT]){const s=this.checkTaprootHashesForSig(t,r,n,i,o),f=[],a=s.filter(l=>!l.leafHash)[0];if(a){const l=Promise.resolve(n.signSchnorr(a.hash)).then(c=>({tapKeySig:(0,te.serializeTaprootSignature)(c,r.sighashType)}));f.push(l)}const u=s.filter(l=>!!l.leafHash);if(u.length){const l=u.map(c=>Promise.resolve(n.signSchnorr(c.hash)).then(b=>({tapScriptSig:[{pubkey:(0,te.toXOnly)(n.publicKey),signature:(0,te.serializeTaprootSignature)(b,r.sighashType),leafHash:c.leafHash}]})));f.push(...l)}return Promise.all(f).then(l=>{l.forEach(c=>this.data.updateInput(t,c))})}checkTaprootHashesForSig(t,r,n,i,o){if(typeof n.signSchnorr!="function")throw new Error(`Need Schnorr Signer to sign taproot input #${t}.`);const s=ko(t,r,this.data.inputs,n.publicKey,this.__CACHE,i,o);if(!s||!s.length)throw new Error(`Can not sign for input #${t} with the key ${n.publicKey.toString("hex")}`);return s}toBuffer(){return oo(this.__CACHE),this.data.toBuffer()}toHex(){return oo(this.__CACHE),this.data.toHex()}toBase64(){return oo(this.__CACHE),this.data.toBase64()}updateGlobal(t){return this.data.updateGlobal(t),this}updateInput(t,r){return r.witnessScript&&ti(r.witnessScript),(0,te.checkTaprootInputFields)(this.data.inputs[t],r,"updateInput"),this.data.updateInput(t,r),r.nonWitnessUtxo&&Oo(this.__CACHE,this.data.inputs[t],t),this}updateOutput(t,r){const n=this.data.outputs[t];return(0,te.checkTaprootOutputFields)(n,r,"updateOutput"),this.data.updateOutput(t,r),this}addUnknownKeyValToGlobal(t){return this.data.addUnknownKeyValToGlobal(t),this}addUnknownKeyValToInput(t,r){return this.data.addUnknownKeyValToInput(t,r),this}addUnknownKeyValToOutput(t,r){return this.data.addUnknownKeyValToOutput(t,r),this}clearFinalizedInput(t){return this.data.clearFinalizedInput(t),this}}Ei.Psbt=ei;const S0=e=>new nu(e);class nu{constructor(t=Buffer.from([2,0,0,0,0,0,0,0,0,0])){this.tx=_e.Transaction.fromBuffer(t),P0(this.tx),Object.defineProperty(this,"tx",{enumerable:!1,writable:!0})}getInputOutputCounts(){return{inputCount:this.tx.ins.length,outputCount:this.tx.outs.length}}addInput(t){if(t.hash===void 0||t.index===void 0||!Buffer.isBuffer(t.hash)&&typeof t.hash!="string"||typeof t.index!="number")throw new Error("Error adding input.");const r=typeof t.hash=="string"?(0,Zn.reverseBuffer)(Buffer.from(t.hash,"hex")):t.hash;this.tx.addInput(r,t.index,t.sequence)}addOutput(t){if(t.script===void 0||t.value===void 0||!Buffer.isBuffer(t.script)||typeof t.value!="number")throw new Error("Error adding output.");this.tx.addOutput(t.script,t.value)}toBuffer(){return this.tx.toBuffer()}}function v0(e,t,r){switch(r){case"pubkey":case"pubkeyhash":case"witnesspubkeyhash":return Zs(1,e.partialSig);case"multisig":const n=Fe.p2ms({output:t});return Zs(n.m,e.partialSig,n.pubkeys);default:return!1}}function oo(e){if(e.__UNSAFE_SIGN_NONSEGWIT!==!1)throw new Error("Not BIP174 compliant, can not export")}function Zs(e,t,r){if(!t)return!1;let n;if(r?n=r.map(i=>{const o=M0(i);return t.find(s=>s.pubkey.equals(o))}).filter(i=>!!i):n=t,n.length>e)throw new Error("Too many signatures");return n.length===e}function iu(e){return!!e.finalScriptSig||!!e.finalScriptWitness}function ef(e){return t=>!(!t.masterFingerprint.equals(e.fingerprint)||!e.derivePath(t.path).publicKey.equals(t.pubkey))}function Fn(e){if(typeof e!="number"||e!==Math.floor(e)||e>4294967295||e<0)throw new Error("Invalid 32 bit integer")}function m0(e,t,r){const n=t.__FEE_RATE||e.getFeeRate(),i=t.__EXTRACTED_TX.virtualSize(),o=n*i;if(n>=r.maximumFeeRate)throw new Error(`Warning: You are paying around ${(o/1e8).toFixed(8)} in fees, which is ${n} satoshi per byte for a transaction with a VSize of ${i} bytes (segwit counted as 0.25 byte per byte). Use setMaximumFeeRate method to raise your threshold, or pass true to the first arg of extractTransaction.`)}function zr(e,t){e.forEach(r=>{if((0,te.isTaprootInput)(r)?(0,te.checkTaprootInputForSigs)(r,t):(0,oe.checkInputForSig)(r,t))throw new Error("Can not modify transaction, signatures exist.")})}function T0(e){if(!e.sighashType||!e.partialSig)return;const{partialSig:t,sighashType:r}=e;t.forEach(n=>{const{hashType:i}=_t.signature.decode(n.signature);if(r!==i)throw new Error("Signature sighash does not match input sighash type")})}function ou(e,t,r){if(!(0,oe.pubkeyInScript)(e,t))throw new Error(`Can not ${r} for this input with the key ${e.toString("hex")}`)}function P0(e){if(!e.ins.every(r=>r.script&&r.script.length===0&&r.witness&&r.witness.length===0))throw new Error("Format Error: Transaction ScriptSigs are not empty")}function I0(e,t){e.ins.forEach(r=>{su(t,r)})}function su(e,t){const r=(0,Zn.reverseBuffer)(Buffer.from(t.hash)).toString("hex")+":"+t.index;if(e.__TX_IN_CACHE[r])throw new Error("Duplicate input detected.");e.__TX_IN_CACHE[r]=1}function fu(e,t){return(r,n,i,o)=>{const s=e({redeem:{output:i}}).output;if(!n.equals(s))throw new Error(`${t} for ${o} #${r} doesn't match the scriptPubKey in the prevout`)}}const tf=fu(Fe.p2sh,"Redeem script"),rf=fu(Fe.p2wsh,"Witness script");function nf(e,t,r,n){if(!r.every(iu))throw new Error(`PSBT must be finalized to calculate ${t}`);if(e==="__FEE_RATE"&&n.__FEE_RATE)return n.__FEE_RATE;if(e==="__FEE"&&n.__FEE)return n.__FEE;let i,o=!0;if(n.__EXTRACTED_TX?(i=n.__EXTRACTED_TX,o=!1):i=n.__TX.clone(),hu(r,i,n,o),e==="__FEE_RATE")return n.__FEE_RATE;if(e==="__FEE")return n.__FEE}function A0(e,t,r,n,i,o){const s=yu(r);if(!v0(t,r,s))throw new Error(`Can not finalize input #${e}`);return k0(r,s,t.partialSig,n,i,o)}function k0(e,t,r,n,i,o){let s,f;const a=B0(e,t,r),u=o?Fe.p2wsh({redeem:a}):null,l=i?Fe.p2sh({redeem:u||a}):null;return n?(u?f=(0,oe.witnessStackToScriptWitness)(u.witness):f=(0,oe.witnessStackToScriptWitness)(a.witness),l&&(s=l.input)):l?s=l.input:s=a.input,{finalScriptSig:s,finalScriptWitness:f}}function of(e,t,r,n,i){const o=(0,Pe.checkForInput)(e,t),{hash:s,sighashType:f,script:a}=au(t,o,n,!1,i);return ou(r,a,"sign"),{hash:s,sighashType:f}}function au(e,t,r,n,i){const o=r.__TX,s=t.sighashType||_e.Transaction.SIGHASH_ALL;cu(s,i);let f,a;if(t.nonWitnessUtxo){const c=Ti(r,t,e),b=o.ins[e].hash,p=c.getHash();if(!b.equals(p))throw new Error(`Non-witness UTXO hash for input #${e} doesn't match the hash specified in the prevout`);const y=o.ins[e].index;a=c.outs[y]}else if(t.witnessUtxo)a=t.witnessUtxo;else throw new Error("Need a Utxo input item for signing");const{meaningfulScript:u,type:l}=Pi(a.script,e,"input",t.redeemScript,t.witnessScript);if(["p2sh-p2wsh","p2wsh"].indexOf(l)>=0)f=o.hashForWitnessV0(e,u,a.value,s);else if((0,oe.isP2WPKH)(u)){const c=Fe.p2pkh({hash:u.slice(2)}).output;f=o.hashForWitnessV0(e,c,a.value,s)}else{if(t.nonWitnessUtxo===void 0&&r.__UNSAFE_SIGN_NONSEGWIT===!1)throw new Error(`Input #${e} has witnessUtxo but non-segwit script: ${u.toString("hex")}`);!n&&r.__UNSAFE_SIGN_NONSEGWIT!==!1&&console.warn(`Warning: Signing non-segwit inputs without the full parent transaction means there is a chance that a miner could feed you incorrect information to trick you into paying large fees. This behavior is the same as Psbt's predecesor (TransactionBuilder - now removed) when signing non-segwit scripts. You are not able to export this Psbt with toBuffer|toBase64|toHex since it is not BIP174 compliant.
*********************
PROCEED WITH CAUTION!
*********************`),f=o.hashForSignature(e,u,s)}return{script:u,sighashType:s,hash:f}}function O0(e,t,r,n){const i=[];if(t.tapInternalKey){const s=uu(e,t,n);s&&i.push(s)}if(t.tapScriptSig){const s=t.tapScriptSig.map(f=>f.pubkey);i.push(...s)}return i.map(s=>ko(e,t,r,s,n)).flat()}function uu(e,t,r){const{script:n}=ss(e,t,r);return(0,oe.isP2TR)(n)?n.subarray(2,34):null}function sf(e){return e.length===64?e:e.subarray(0,64)}function ko(e,t,r,n,i,o,s){const f=i.__TX,a=t.sighashType||_e.Transaction.SIGHASH_DEFAULT;cu(a,s);const u=r.map((y,g)=>ss(g,y,i)),l=u.map(y=>y.script),c=u.map(y=>y.value),b=[];if(t.tapInternalKey&&!o){const y=uu(e,t,i)||Buffer.from([]);if((0,te.toXOnly)(n).equals(y)){const g=f.hashForWitnessV1(e,l,c,a);b.push({pubkey:n,hash:g})}}const p=(t.tapLeafScript||[]).filter(y=>(0,oe.pubkeyInScript)(n,y.script)).map(y=>{const g=(0,w0.tapleafHash)({output:y.script,version:y.leafVersion});return Object.assign({hash:g},y)}).filter(y=>!o||o.equals(y.hash)).map(y=>{const g=f.hashForWitnessV1(e,l,c,_e.Transaction.SIGHASH_DEFAULT,y.hash);return{pubkey:n,hash:g,leafHash:y.hash}});return b.concat(p)}function cu(e,t){if(t&&t.indexOf(e)<0){const r=N0(e);throw new Error(`Sighash type is not allowed. Retry the sign method passing the sighashTypes array of whitelisted types. Sighash type: ${r}`)}}function B0(e,t,r){let n;switch(t){case"multisig":const i=R0(e,r);n=Fe.p2ms({output:e,signatures:i});break;case"pubkey":n=Fe.p2pk({output:e,signature:r[0].signature});break;case"pubkeyhash":n=Fe.p2pkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature});break;case"witnesspubkeyhash":n=Fe.p2wpkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature});break}return n}function x0(e,t,r){const n=r.__TX,i={script:null,isSegwit:!1,isP2SH:!1,isP2WSH:!1};if(i.isP2SH=!!t.redeemScript,i.isP2WSH=!!t.witnessScript,t.witnessScript)i.script=t.witnessScript;else if(t.redeemScript)i.script=t.redeemScript;else if(t.nonWitnessUtxo){const o=Ti(r,t,e),s=n.ins[e].index;i.script=o.outs[s].script}else t.witnessUtxo&&(i.script=t.witnessUtxo.script);return(t.witnessScript||(0,oe.isP2WPKH)(i.script))&&(i.isSegwit=!0),i}function ff(e,t,r){const n=(0,Pe.checkForInput)(t,e);if(!n.bip32Derivation||n.bip32Derivation.length===0)throw new Error("Need bip32Derivation to sign with HD");const i=n.bip32Derivation.map(s=>{if(s.masterFingerprint.equals(r.fingerprint))return s}).filter(s=>!!s);if(i.length===0)throw new Error("Need one bip32Derivation masterFingerprint to match the HDSigner fingerprint");return i.map(s=>{const f=r.derivePath(s.path);if(!s.pubkey.equals(f.publicKey))throw new Error("pubkey did not match bip32Derivation");return f})}function R0(e,t){return Fe.p2ms({output:e}).pubkeys.map(n=>(t.filter(i=>i.pubkey.equals(n))[0]||{}).signature).filter(n=>!!n)}function lu(e){let t=0;function r(s){return t+=s,e.slice(t-s,t)}function n(){const s=Js.decode(e,t);return t+=Js.decode.bytes,s}function i(){return r(n())}function o(){const s=n(),f=[];for(let a=0;a<s;a++)f.push(i());return f}return o()}function N0(e){let t=e&_e.Transaction.SIGHASH_ANYONECANPAY?"SIGHASH_ANYONECANPAY | ":"";switch(e&31){case _e.Transaction.SIGHASH_ALL:t+="SIGHASH_ALL";break;case _e.Transaction.SIGHASH_SINGLE:t+="SIGHASH_SINGLE";break;case _e.Transaction.SIGHASH_NONE:t+="SIGHASH_NONE";break}return t}function Oo(e,t,r){e.__NON_WITNESS_UTXO_BUF_CACHE[r]=t.nonWitnessUtxo;const n=_e.Transaction.fromBuffer(t.nonWitnessUtxo);e.__NON_WITNESS_UTXO_TX_CACHE[r]=n;const i=e,o=r;delete t.nonWitnessUtxo,Object.defineProperty(t,"nonWitnessUtxo",{enumerable:!0,get(){const s=i.__NON_WITNESS_UTXO_BUF_CACHE[o],f=i.__NON_WITNESS_UTXO_TX_CACHE[o];if(s!==void 0)return s;{const a=f.toBuffer();return i.__NON_WITNESS_UTXO_BUF_CACHE[o]=a,a}},set(s){i.__NON_WITNESS_UTXO_BUF_CACHE[o]=s}})}function hu(e,t,r,n){let i=0;e.forEach((a,u)=>{if(n&&a.finalScriptSig&&(t.ins[u].script=a.finalScriptSig),n&&a.finalScriptWitness&&(t.ins[u].witness=lu(a.finalScriptWitness)),a.witnessUtxo)i+=a.witnessUtxo.value;else if(a.nonWitnessUtxo){const l=Ti(r,a,u),c=t.ins[u].index,b=l.outs[c];i+=b.value}});const o=t.outs.reduce((a,u)=>a+u.value,0),s=i-o;if(s<0)throw new Error("Outputs are spending more than Inputs");const f=t.virtualSize();r.__FEE=s,r.__EXTRACTED_TX=t,r.__FEE_RATE=Math.floor(s/f)}function Ti(e,t,r){const n=e.__NON_WITNESS_UTXO_TX_CACHE;return n[r]||Oo(e,t,r),n[r]}function du(e,t,r){const{script:n}=ss(e,t,r);return n}function ss(e,t,r){if(t.witnessUtxo!==void 0)return{script:t.witnessUtxo.script,value:t.witnessUtxo.value};if(t.nonWitnessUtxo!==void 0){const i=Ti(r,t,e).outs[r.__TX.ins[e].index];return{script:i.script,value:i.value}}else throw new Error("Can't find pubkey in input without Utxo data")}function U0(e,t,r,n){const i=du(r,t,n),{meaningfulScript:o}=Pi(i,r,"input",t.redeemScript,t.witnessScript);return(0,oe.pubkeyInScript)(e,o)}function C0(e,t,r,n){const i=n.__TX.outs[r].script,{meaningfulScript:o}=Pi(i,r,"output",t.redeemScript,t.witnessScript);return(0,oe.pubkeyInScript)(e,o)}function H0(e){if(!e)return;const t=_t.decompile(e);if(!t)return;const r=t[t.length-1];if(!(!Buffer.isBuffer(r)||pu(r)||$0(r)||!_t.decompile(r)))return r}function L0(e){if(!e)return;const t=lu(e),r=t[t.length-1];if(!(pu(r)||!_t.decompile(r)))return r}function M0(e){if(e.length===65){const t=e[64]&1,r=e.slice(0,33);return r[0]=2|t,r}return e.slice()}function pu(e){return e.length===33&&_t.isCanonicalPubKey(e)}function $0(e){return _t.isCanonicalScriptSignature(e)}function Pi(e,t,r,n,i){const o=(0,oe.isP2SHScript)(e),s=o&&n&&(0,oe.isP2WSHScript)(n),f=(0,oe.isP2WSHScript)(e);if(o&&n===void 0)throw new Error("scriptPubkey is P2SH but redeemScript missing");if((f||s)&&i===void 0)throw new Error("scriptPubkey or redeemScript is P2WSH but witnessScript missing");let a;return s?(a=i,tf(t,e,n,r),rf(t,n,i,r),ti(a)):f?(a=i,rf(t,e,i,r),ti(a)):o?(a=n,tf(t,e,n,r)):a=e,{meaningfulScript:a,type:s?"p2sh-p2wsh":o?"p2sh":f?"p2wsh":"raw"}}function ti(e){if((0,oe.isP2WPKH)(e)||(0,oe.isP2SHScript)(e))throw new Error("P2WPKH or P2SH can not be contained within P2WSH")}function yu(e){return(0,oe.isP2WPKH)(e)?"witnesspubkeyhash":(0,oe.isP2PKH)(e)?"pubkeyhash":(0,oe.isP2MS)(e)?"multisig":(0,oe.isP2PK)(e)?"pubkey":"nonstandard"}function Jr(e){return[...Array(e).keys()]}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.initEccLib=e.Transaction=e.opcodes=e.Psbt=e.Block=e.script=e.payments=e.networks=e.crypto=e.address=void 0;const t=ke;e.address=t;const r=rt;e.crypto=r;const n=le;e.networks=n;const i=Hr;e.payments=i;const o=Be;e.script=o;var s=gi;Object.defineProperty(e,"Block",{enumerable:!0,get:function(){return s.Block}});var f=Ei;Object.defineProperty(e,"Psbt",{enumerable:!0,get:function(){return f.Psbt}});var a=Rt;Object.defineProperty(e,"opcodes",{enumerable:!0,get:function(){return a.OPS}});var u=Ht;Object.defineProperty(e,"Transaction",{enumerable:!0,get:function(){return u.Transaction}});var l=Nt;Object.defineProperty(e,"initEccLib",{enumerable:!0,get:function(){return l.initEccLib}})})(dt);const F0=jf(dt),D0=yc({__proto__:null,default:F0},[dt]);var _u={},Rr={},Nr={};Object.defineProperty(Nr,"__esModule",{value:!0});Nr.testnet=Nr.bitcoin=void 0;Nr.bitcoin={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128};Nr.testnet={messagePrefix:`Bitcoin Signed Message:
`,bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239};var bu={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.maybe=e.Boolean=e.Array=e.Buffer256bit=e.Network=e.typeforce=void 0,e.typeforce=Qf,e.Network=e.typeforce.compile({messagePrefix:e.typeforce.oneOf(e.typeforce.Buffer,e.typeforce.String),bip32:{public:e.typeforce.UInt32,private:e.typeforce.UInt32},pubKeyHash:e.typeforce.UInt8,scriptHash:e.typeforce.UInt8,wif:e.typeforce.UInt8}),e.Buffer256bit=e.typeforce.BufferN(32),e.Array=e.typeforce.Array,e.Boolean=e.typeforce.Boolean,e.maybe=e.typeforce.maybe})(bu);var Bo={exports:{}},so=65536,K0=4294967295;function W0(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var j0=xe.Buffer,ri=xt.crypto||xt.msCrypto;ri&&ri.getRandomValues?Bo.exports=V0:Bo.exports=W0;function V0(e,t){if(e>K0)throw new RangeError("requested too many random bytes");var r=j0.allocUnsafe(e);if(e>0)if(e>so)for(var n=0;n<e;n+=so)ri.getRandomValues(r.slice(n,n+so));else ri.getRandomValues(r);return typeof t=="function"?process.nextTick(function(){t(null,r)}):r}var G0=Bo.exports,xo={exports:{}},gu=ln.EventEmitter,fo,af;function q0(){if(af)return fo;af=1;function e(y,g){var w=Object.keys(y);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(y);g&&(v=v.filter(function(I){return Object.getOwnPropertyDescriptor(y,I).enumerable})),w.push.apply(w,v)}return w}function t(y){for(var g=1;g<arguments.length;g++){var w=arguments[g]!=null?arguments[g]:{};g%2?e(Object(w),!0).forEach(function(v){r(y,v,w[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(w)):e(Object(w)).forEach(function(v){Object.defineProperty(y,v,Object.getOwnPropertyDescriptor(w,v))})}return y}function r(y,g,w){return g=s(g),g in y?Object.defineProperty(y,g,{value:w,enumerable:!0,configurable:!0,writable:!0}):y[g]=w,y}function n(y,g){if(!(y instanceof g))throw new TypeError("Cannot call a class as a function")}function i(y,g){for(var w=0;w<g.length;w++){var v=g[w];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(y,s(v.key),v)}}function o(y,g,w){return g&&i(y.prototype,g),w&&i(y,w),Object.defineProperty(y,"prototype",{writable:!1}),y}function s(y){var g=f(y,"string");return typeof g=="symbol"?g:String(g)}function f(y,g){if(typeof y!="object"||y===null)return y;var w=y[Symbol.toPrimitive];if(w!==void 0){var v=w.call(y,g||"default");if(typeof v!="object")return v;throw new TypeError("@@toPrimitive must return a primitive value.")}return(g==="string"?String:Number)(y)}var a=Ct,u=a.Buffer,l=ln,c=l.inspect,b=c&&c.custom||"inspect";function p(y,g,w){u.prototype.copy.call(y,g,w)}return fo=function(){function y(){n(this,y),this.head=null,this.tail=null,this.length=0}return o(y,[{key:"push",value:function(w){var v={data:w,next:null};this.length>0?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(w){var v={data:w,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){if(this.length!==0){var w=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,w}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(w){if(this.length===0)return"";for(var v=this.head,I=""+v.data;v=v.next;)I+=w+v.data;return I}},{key:"concat",value:function(w){if(this.length===0)return u.alloc(0);for(var v=u.allocUnsafe(w>>>0),I=this.head,P=0;I;)p(I.data,v,P),P+=I.data.length,I=I.next;return v}},{key:"consume",value:function(w,v){var I;return w<this.head.data.length?(I=this.head.data.slice(0,w),this.head.data=this.head.data.slice(w)):w===this.head.data.length?I=this.shift():I=v?this._getString(w):this._getBuffer(w),I}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(w){var v=this.head,I=1,P=v.data;for(w-=P.length;v=v.next;){var T=v.data,A=w>T.length?T.length:w;if(A===T.length?P+=T:P+=T.slice(0,w),w-=A,w===0){A===T.length?(++I,v.next?this.head=v.next:this.head=this.tail=null):(this.head=v,v.data=T.slice(A));break}++I}return this.length-=I,P}},{key:"_getBuffer",value:function(w){var v=u.allocUnsafe(w),I=this.head,P=1;for(I.data.copy(v),w-=I.data.length;I=I.next;){var T=I.data,A=w>T.length?T.length:w;if(T.copy(v,v.length-w,0,A),w-=A,w===0){A===T.length?(++P,I.next?this.head=I.next:this.head=this.tail=null):(this.head=I,I.data=T.slice(A));break}++P}return this.length-=P,v}},{key:b,value:function(w,v){return c(this,t(t({},v),{},{depth:0,customInspect:!1}))}}]),y}(),fo}function X0(e,t){var r=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return n||i?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(Ro,this,e)):process.nextTick(Ro,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(o){!t&&o?r._writableState?r._writableState.errorEmitted?process.nextTick(Gn,r):(r._writableState.errorEmitted=!0,process.nextTick(uf,r,o)):process.nextTick(uf,r,o):t?(process.nextTick(Gn,r),t(o)):process.nextTick(Gn,r)}),this)}function uf(e,t){Ro(e,t),Gn(e)}function Gn(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function Y0(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function Ro(e,t){e.emit("error",t)}function z0(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}var wu={destroy:X0,undestroy:Y0,errorOrDestroy:z0},cr={};function J0(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Eu={};function Ve(e,t,r){r||(r=Error);function n(o,s,f){return typeof t=="string"?t:t(o,s,f)}var i=function(o){J0(s,o);function s(f,a,u){return o.call(this,n(f,a,u))||this}return s}(r);i.prototype.name=r.name,i.prototype.code=e,Eu[e]=i}function cf(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map(function(n){return String(n)}),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:r===2?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}else return"of ".concat(t," ").concat(String(e))}function Q0(e,t,r){return e.substr(!r||r<0?0:+r,t.length)===t}function Z0(e,t,r){return(r===void 0||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}function ep(e,t,r){return typeof r!="number"&&(r=0),r+t.length>e.length?!1:e.indexOf(t,r)!==-1}Ve("ERR_INVALID_OPT_VALUE",function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'},TypeError);Ve("ERR_INVALID_ARG_TYPE",function(e,t,r){var n;typeof t=="string"&&Q0(t,"not ")?(n="must not be",t=t.replace(/^not /,"")):n="must be";var i;if(Z0(e," argument"))i="The ".concat(e," ").concat(n," ").concat(cf(t,"type"));else{var o=ep(e,".")?"property":"argument";i='The "'.concat(e,'" ').concat(o," ").concat(n," ").concat(cf(t,"type"))}return i+=". Received type ".concat(typeof r),i},TypeError);Ve("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");Ve("ERR_METHOD_NOT_IMPLEMENTED",function(e){return"The "+e+" method is not implemented"});Ve("ERR_STREAM_PREMATURE_CLOSE","Premature close");Ve("ERR_STREAM_DESTROYED",function(e){return"Cannot call "+e+" after a stream was destroyed"});Ve("ERR_MULTIPLE_CALLBACK","Callback called multiple times");Ve("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");Ve("ERR_STREAM_WRITE_AFTER_END","write after end");Ve("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Ve("ERR_UNKNOWN_ENCODING",function(e){return"Unknown encoding: "+e},TypeError);Ve("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");cr.codes=Eu;var tp=cr.codes.ERR_INVALID_OPT_VALUE;function rp(e,t,r){return e.highWaterMark!=null?e.highWaterMark:t?e[r]:null}function np(e,t,r,n){var i=rp(t,n,r);if(i!=null){if(!(isFinite(i)&&Math.floor(i)===i)||i<0){var o=n?r:"highWaterMark";throw new tp(o,i)}return Math.floor(i)}return e.objectMode?16:16*1024}var Su={getHighWaterMark:np},ip=op;function op(e,t){if(ao("noDeprecation"))return e;var r=!1;function n(){if(!r){if(ao("throwDeprecation"))throw new Error(t);ao("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}return n}function ao(e){try{if(!xt.localStorage)return!1}catch{return!1}var t=xt.localStorage[e];return t==null?!1:String(t).toLowerCase()==="true"}var uo,lf;function vu(){if(lf)return uo;lf=1,uo=x;function e(S){var E=this;this.next=null,this.entry=null,this.finish=function(){yr(E,S)}}var t;x.WritableState=_;var r={deprecate:ip},n=gu,i=Ct.Buffer,o=(typeof xt<"u"?xt:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function s(S){return i.from(S)}function f(S){return i.isBuffer(S)||S instanceof o}var a=wu,u=Su,l=u.getHighWaterMark,c=cr.codes,b=c.ERR_INVALID_ARG_TYPE,p=c.ERR_METHOD_NOT_IMPLEMENTED,y=c.ERR_MULTIPLE_CALLBACK,g=c.ERR_STREAM_CANNOT_PIPE,w=c.ERR_STREAM_DESTROYED,v=c.ERR_STREAM_NULL_VALUES,I=c.ERR_STREAM_WRITE_AFTER_END,P=c.ERR_UNKNOWN_ENCODING,T=a.errorOrDestroy;ve(x,n);function A(){}function _(S,E,B){t=t||Ur(),S=S||{},typeof B!="boolean"&&(B=E instanceof t),this.objectMode=!!S.objectMode,B&&(this.objectMode=this.objectMode||!!S.writableObjectMode),this.highWaterMark=l(this,S,"writableHighWaterMark",B),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var C=S.decodeStrings===!1;this.decodeStrings=!C,this.defaultEncoding=S.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(K){Kr(E,K)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=S.emitClose!==!1,this.autoDestroy=!!S.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new e(this)}_.prototype.getBuffer=function(){for(var E=this.bufferedRequest,B=[];E;)B.push(E),E=E.next;return B},function(){try{Object.defineProperty(_.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var O;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(O=Function.prototype[Symbol.hasInstance],Object.defineProperty(x,Symbol.hasInstance,{value:function(E){return O.call(this,E)?!0:this!==x?!1:E&&E._writableState instanceof _}})):O=function(E){return E instanceof this};function x(S){t=t||Ur();var E=this instanceof t;if(!E&&!O.call(x,this))return new x(S);this._writableState=new _(S,this,E),this.writable=!0,S&&(typeof S.write=="function"&&(this._write=S.write),typeof S.writev=="function"&&(this._writev=S.writev),typeof S.destroy=="function"&&(this._destroy=S.destroy),typeof S.final=="function"&&(this._final=S.final)),n.call(this)}x.prototype.pipe=function(){T(this,new g)};function m(S,E){var B=new I;T(S,B),process.nextTick(E,B)}function N(S,E,B,C){var K;return B===null?K=new v:typeof B!="string"&&!E.objectMode&&(K=new b("chunk",["string","Buffer"],B)),K?(T(S,K),process.nextTick(C,K),!1):!0}x.prototype.write=function(S,E,B){var C=this._writableState,K=!1,h=!C.objectMode&&f(S);return h&&!i.isBuffer(S)&&(S=s(S)),typeof E=="function"&&(B=E,E=null),h?E="buffer":E||(E=C.defaultEncoding),typeof B!="function"&&(B=A),C.ending?m(this,B):(h||N(this,C,S,B))&&(C.pendingcb++,K=J(this,C,h,S,E,B)),K},x.prototype.cork=function(){this._writableState.corked++},x.prototype.uncork=function(){var S=this._writableState;S.corked&&(S.corked--,!S.writing&&!S.corked&&!S.bufferProcessing&&S.bufferedRequest&&st(this,S))},x.prototype.setDefaultEncoding=function(E){if(typeof E=="string"&&(E=E.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((E+"").toLowerCase())>-1))throw new P(E);return this._writableState.defaultEncoding=E,this},Object.defineProperty(x.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function F(S,E,B){return!S.objectMode&&S.decodeStrings!==!1&&typeof E=="string"&&(E=i.from(E,B)),E}Object.defineProperty(x.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function J(S,E,B,C,K,h){if(!B){var d=F(E,C,K);C!==d&&(B=!0,K="buffer",C=d)}var k=E.objectMode?1:C.length;E.length+=k;var R=E.length<E.highWaterMark;if(R||(E.needDrain=!0),E.writing||E.corked){var re=E.lastBufferedRequest;E.lastBufferedRequest={chunk:C,encoding:K,isBuf:B,callback:h,next:null},re?re.next=E.lastBufferedRequest:E.bufferedRequest=E.lastBufferedRequest,E.bufferedRequestCount+=1}else D(S,E,!1,k,C,K,h);return R}function D(S,E,B,C,K,h,d){E.writelen=C,E.writecb=d,E.writing=!0,E.sync=!0,E.destroyed?E.onwrite(new w("write")):B?S._writev(K,E.onwrite):S._write(K,h,E.onwrite),E.sync=!1}function ee(S,E,B,C,K){--E.pendingcb,B?(process.nextTick(K,C),process.nextTick(Ye,S,E),S._writableState.errorEmitted=!0,T(S,C)):(K(C),S._writableState.errorEmitted=!0,T(S,C),Ye(S,E))}function Re(S){S.writing=!1,S.writecb=null,S.length-=S.writelen,S.writelen=0}function Kr(S,E){var B=S._writableState,C=B.sync,K=B.writecb;if(typeof K!="function")throw new y;if(Re(B),E)ee(S,B,C,E,K);else{var h=dr(B)||S.destroyed;!h&&!B.corked&&!B.bufferProcessing&&B.bufferedRequest&&st(S,B),C?process.nextTick(ot,S,B,h,K):ot(S,B,h,K)}}function ot(S,E,B,C){B||hr(S,E),E.pendingcb--,C(),Ye(S,E)}function hr(S,E){E.length===0&&E.needDrain&&(E.needDrain=!1,S.emit("drain"))}function st(S,E){E.bufferProcessing=!0;var B=E.bufferedRequest;if(S._writev&&B&&B.next){var C=E.bufferedRequestCount,K=new Array(C),h=E.corkedRequestsFree;h.entry=B;for(var d=0,k=!0;B;)K[d]=B,B.isBuf||(k=!1),B=B.next,d+=1;K.allBuffers=k,D(S,E,!0,E.length,K,"",h.finish),E.pendingcb++,E.lastBufferedRequest=null,h.next?(E.corkedRequestsFree=h.next,h.next=null):E.corkedRequestsFree=new e(E),E.bufferedRequestCount=0}else{for(;B;){var R=B.chunk,re=B.encoding,$=B.callback,q=E.objectMode?1:R.length;if(D(S,E,!1,q,R,re,$),B=B.next,E.bufferedRequestCount--,E.writing)break}B===null&&(E.lastBufferedRequest=null)}E.bufferedRequest=B,E.bufferProcessing=!1}x.prototype._write=function(S,E,B){B(new p("_write()"))},x.prototype._writev=null,x.prototype.end=function(S,E,B){var C=this._writableState;return typeof S=="function"?(B=S,S=null,E=null):typeof E=="function"&&(B=E,E=null),S!=null&&this.write(S,E),C.corked&&(C.corked=1,this.uncork()),C.ending||jr(this,C,B),this},Object.defineProperty(x.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function dr(S){return S.ending&&S.length===0&&S.bufferedRequest===null&&!S.finished&&!S.writing}function Wr(S,E){S._final(function(B){E.pendingcb--,B&&T(S,B),E.prefinished=!0,S.emit("prefinish"),Ye(S,E)})}function pr(S,E){!E.prefinished&&!E.finalCalled&&(typeof S._final=="function"&&!E.destroyed?(E.pendingcb++,E.finalCalled=!0,process.nextTick(Wr,S,E)):(E.prefinished=!0,S.emit("prefinish")))}function Ye(S,E){var B=dr(E);if(B&&(pr(S,E),E.pendingcb===0&&(E.finished=!0,S.emit("finish"),E.autoDestroy))){var C=S._readableState;(!C||C.autoDestroy&&C.endEmitted)&&S.destroy()}return B}function jr(S,E,B){E.ending=!0,Ye(S,E),B&&(E.finished?process.nextTick(B):S.once("finish",B)),E.ended=!0,S.writable=!1}function yr(S,E,B){var C=S.entry;for(S.entry=null;C;){var K=C.callback;E.pendingcb--,K(B),C=C.next}E.corkedRequestsFree.next=S}return Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(E){this._writableState&&(this._writableState.destroyed=E)}}),x.prototype.destroy=a.destroy,x.prototype._undestroy=a.undestroy,x.prototype._destroy=function(S,E){E(S)},uo}var co,hf;function Ur(){if(hf)return co;hf=1;var e=Object.keys||function(u){var l=[];for(var c in u)l.push(c);return l};co=s;var t=Tu(),r=vu();ve(s,t);for(var n=e(r.prototype),i=0;i<n.length;i++){var o=n[i];s.prototype[o]||(s.prototype[o]=r.prototype[o])}function s(u){if(!(this instanceof s))return new s(u);t.call(this,u),r.call(this,u),this.allowHalfOpen=!0,u&&(u.readable===!1&&(this.readable=!1),u.writable===!1&&(this.writable=!1),u.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",f)))}Object.defineProperty(s.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(s.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(s.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function f(){this._writableState.ended||process.nextTick(a,this)}function a(u){u.end()}return Object.defineProperty(s.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(l){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=l,this._writableState.destroyed=l)}}),co}var ni={},fs=xe.Buffer,df=fs.isEncoding||function(e){switch(e=""+e,e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function sp(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}function fp(e){var t=sp(e);if(typeof t!="string"&&(fs.isEncoding===df||!df(e)))throw new Error("Unknown encoding: "+e);return t||e}ni.StringDecoder=En;function En(e){this.encoding=fp(e);var t;switch(this.encoding){case"utf16le":this.text=dp,this.end=pp,t=4;break;case"utf8":this.fillLast=cp,t=4;break;case"base64":this.text=yp,this.end=_p,t=3;break;default:this.write=bp,this.end=gp;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=fs.allocUnsafe(t)}En.prototype.write=function(e){if(e.length===0)return"";var t,r;if(this.lastNeed){if(t=this.fillLast(e),t===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""};En.prototype.end=hp;En.prototype.text=lp;En.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length};function lo(e){return e<=127?0:e>>5===6?2:e>>4===14?3:e>>3===30?4:e>>6===2?-1:-2}function ap(e,t,r){var n=t.length-1;if(n<r)return 0;var i=lo(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r||i===-2?0:(i=lo(t[n]),i>=0?(i>0&&(e.lastNeed=i-2),i):--n<r||i===-2?0:(i=lo(t[n]),i>=0?(i>0&&(i===2?i=0:e.lastNeed=i-3),i):0))}function up(e,t,r){if((t[0]&192)!==128)return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if((t[1]&192)!==128)return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&(t[2]&192)!==128)return e.lastNeed=2,""}}function cp(e){var t=this.lastTotal-this.lastNeed,r=up(this,e);if(r!==void 0)return r;if(this.lastNeed<=e.length)return e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,t,0,e.length),this.lastNeed-=e.length}function lp(e,t){var r=ap(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)}function hp(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t}function dp(e,t){if((e.length-t)%2===0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function pp(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function yp(e,t){var r=(e.length-t)%3;return r===0?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function _p(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function bp(e){return e.toString(this.encoding)}function gp(e){return e&&e.length?this.write(e):""}var pf=cr.codes.ERR_STREAM_PREMATURE_CLOSE;function wp(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}function Ep(){}function Sp(e){return e.setHeader&&typeof e.abort=="function"}function mu(e,t,r){if(typeof t=="function")return mu(e,null,t);t||(t={}),r=wp(r||Ep);var n=t.readable||t.readable!==!1&&e.readable,i=t.writable||t.writable!==!1&&e.writable,o=function(){e.writable||f()},s=e._writableState&&e._writableState.finished,f=function(){i=!1,s=!0,n||r.call(e)},a=e._readableState&&e._readableState.endEmitted,u=function(){n=!1,a=!0,i||r.call(e)},l=function(y){r.call(e,y)},c=function(){var y;if(n&&!a)return(!e._readableState||!e._readableState.ended)&&(y=new pf),r.call(e,y);if(i&&!s)return(!e._writableState||!e._writableState.ended)&&(y=new pf),r.call(e,y)},b=function(){e.req.on("finish",f)};return Sp(e)?(e.on("complete",f),e.on("abort",c),e.req?b():e.on("request",b)):i&&!e._writableState&&(e.on("end",o),e.on("close",o)),e.on("end",u),e.on("finish",f),t.error!==!1&&e.on("error",l),e.on("close",c),function(){e.removeListener("complete",f),e.removeListener("abort",c),e.removeListener("request",b),e.req&&e.req.removeListener("finish",f),e.removeListener("end",o),e.removeListener("close",o),e.removeListener("finish",f),e.removeListener("end",u),e.removeListener("error",l),e.removeListener("close",c)}}var as=mu,ho,yf;function vp(){if(yf)return ho;yf=1;var e;function t(P,T,A){return T=r(T),T in P?Object.defineProperty(P,T,{value:A,enumerable:!0,configurable:!0,writable:!0}):P[T]=A,P}function r(P){var T=n(P,"string");return typeof T=="symbol"?T:String(T)}function n(P,T){if(typeof P!="object"||P===null)return P;var A=P[Symbol.toPrimitive];if(A!==void 0){var _=A.call(P,T||"default");if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(T==="string"?String:Number)(P)}var i=as,o=Symbol("lastResolve"),s=Symbol("lastReject"),f=Symbol("error"),a=Symbol("ended"),u=Symbol("lastPromise"),l=Symbol("handlePromise"),c=Symbol("stream");function b(P,T){return{value:P,done:T}}function p(P){var T=P[o];if(T!==null){var A=P[c].read();A!==null&&(P[u]=null,P[o]=null,P[s]=null,T(b(A,!1)))}}function y(P){process.nextTick(p,P)}function g(P,T){return function(A,_){P.then(function(){if(T[a]){A(b(void 0,!0));return}T[l](A,_)},_)}}var w=Object.getPrototypeOf(function(){}),v=Object.setPrototypeOf((e={get stream(){return this[c]},next:function(){var T=this,A=this[f];if(A!==null)return Promise.reject(A);if(this[a])return Promise.resolve(b(void 0,!0));if(this[c].destroyed)return new Promise(function(m,N){process.nextTick(function(){T[f]?N(T[f]):m(b(void 0,!0))})});var _=this[u],O;if(_)O=new Promise(g(_,this));else{var x=this[c].read();if(x!==null)return Promise.resolve(b(x,!1));O=new Promise(this[l])}return this[u]=O,O}},t(e,Symbol.asyncIterator,function(){return this}),t(e,"return",function(){var T=this;return new Promise(function(A,_){T[c].destroy(null,function(O){if(O){_(O);return}A(b(void 0,!0))})})}),e),w),I=function(T){var A,_=Object.create(v,(A={},t(A,c,{value:T,writable:!0}),t(A,o,{value:null,writable:!0}),t(A,s,{value:null,writable:!0}),t(A,f,{value:null,writable:!0}),t(A,a,{value:T._readableState.endEmitted,writable:!0}),t(A,l,{value:function(x,m){var N=_[c].read();N?(_[u]=null,_[o]=null,_[s]=null,x(b(N,!1))):(_[o]=x,_[s]=m)},writable:!0}),A));return _[u]=null,i(T,function(O){if(O&&O.code!=="ERR_STREAM_PREMATURE_CLOSE"){var x=_[s];x!==null&&(_[u]=null,_[o]=null,_[s]=null,x(O)),_[f]=O;return}var m=_[o];m!==null&&(_[u]=null,_[o]=null,_[s]=null,m(b(void 0,!0))),_[a]=!0}),T.on("readable",y.bind(null,_)),_};return ho=I,ho}var po,_f;function mp(){return _f||(_f=1,po=function(){throw new Error("Readable.from is not available in the browser")}),po}var yo,bf;function Tu(){if(bf)return yo;bf=1,yo=m;var e;m.ReadableState=x,ln.EventEmitter;var t=function(d,k){return d.listeners(k).length},r=gu,n=Ct.Buffer,i=(typeof xt<"u"?xt:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function o(h){return n.from(h)}function s(h){return n.isBuffer(h)||h instanceof i}var f=ln,a;f&&f.debuglog?a=f.debuglog("stream"):a=function(){};var u=q0(),l=wu,c=Su,b=c.getHighWaterMark,p=cr.codes,y=p.ERR_INVALID_ARG_TYPE,g=p.ERR_STREAM_PUSH_AFTER_EOF,w=p.ERR_METHOD_NOT_IMPLEMENTED,v=p.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,I,P,T;ve(m,r);var A=l.errorOrDestroy,_=["error","close","destroy","pause","resume"];function O(h,d,k){if(typeof h.prependListener=="function")return h.prependListener(d,k);!h._events||!h._events[d]?h.on(d,k):Array.isArray(h._events[d])?h._events[d].unshift(k):h._events[d]=[k,h._events[d]]}function x(h,d,k){e=e||Ur(),h=h||{},typeof k!="boolean"&&(k=d instanceof e),this.objectMode=!!h.objectMode,k&&(this.objectMode=this.objectMode||!!h.readableObjectMode),this.highWaterMark=b(this,h,"readableHighWaterMark",k),this.buffer=new u,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=h.emitClose!==!1,this.autoDestroy=!!h.autoDestroy,this.destroyed=!1,this.defaultEncoding=h.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,h.encoding&&(I||(I=ni.StringDecoder),this.decoder=new I(h.encoding),this.encoding=h.encoding)}function m(h){if(e=e||Ur(),!(this instanceof m))return new m(h);var d=this instanceof e;this._readableState=new x(h,this,d),this.readable=!0,h&&(typeof h.read=="function"&&(this._read=h.read),typeof h.destroy=="function"&&(this._destroy=h.destroy)),r.call(this)}Object.defineProperty(m.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(d){this._readableState&&(this._readableState.destroyed=d)}}),m.prototype.destroy=l.destroy,m.prototype._undestroy=l.undestroy,m.prototype._destroy=function(h,d){d(h)},m.prototype.push=function(h,d){var k=this._readableState,R;return k.objectMode?R=!0:typeof h=="string"&&(d=d||k.defaultEncoding,d!==k.encoding&&(h=n.from(h,d),d=""),R=!0),N(this,h,d,!1,R)},m.prototype.unshift=function(h){return N(this,h,null,!0,!1)};function N(h,d,k,R,re){a("readableAddChunk",d);var $=h._readableState;if(d===null)$.reading=!1,Kr(h,$);else{var q;if(re||(q=J($,d)),q)A(h,q);else if($.objectMode||d&&d.length>0)if(typeof d!="string"&&!$.objectMode&&Object.getPrototypeOf(d)!==n.prototype&&(d=o(d)),R)$.endEmitted?A(h,new v):F(h,$,d,!0);else if($.ended)A(h,new g);else{if($.destroyed)return!1;$.reading=!1,$.decoder&&!k?(d=$.decoder.write(d),$.objectMode||d.length!==0?F(h,$,d,!1):st(h,$)):F(h,$,d,!1)}else R||($.reading=!1,st(h,$))}return!$.ended&&($.length<$.highWaterMark||$.length===0)}function F(h,d,k,R){d.flowing&&d.length===0&&!d.sync?(d.awaitDrain=0,h.emit("data",k)):(d.length+=d.objectMode?1:k.length,R?d.buffer.unshift(k):d.buffer.push(k),d.needReadable&&ot(h)),st(h,d)}function J(h,d){var k;return!s(d)&&typeof d!="string"&&d!==void 0&&!h.objectMode&&(k=new y("chunk",["string","Buffer","Uint8Array"],d)),k}m.prototype.isPaused=function(){return this._readableState.flowing===!1},m.prototype.setEncoding=function(h){I||(I=ni.StringDecoder);var d=new I(h);this._readableState.decoder=d,this._readableState.encoding=this._readableState.decoder.encoding;for(var k=this._readableState.buffer.head,R="";k!==null;)R+=d.write(k.data),k=k.next;return this._readableState.buffer.clear(),R!==""&&this._readableState.buffer.push(R),this._readableState.length=R.length,this};var D=1073741824;function ee(h){return h>=D?h=D:(h--,h|=h>>>1,h|=h>>>2,h|=h>>>4,h|=h>>>8,h|=h>>>16,h++),h}function Re(h,d){return h<=0||d.length===0&&d.ended?0:d.objectMode?1:h!==h?d.flowing&&d.length?d.buffer.head.data.length:d.length:(h>d.highWaterMark&&(d.highWaterMark=ee(h)),h<=d.length?h:d.ended?d.length:(d.needReadable=!0,0))}m.prototype.read=function(h){a("read",h),h=parseInt(h,10);var d=this._readableState,k=h;if(h!==0&&(d.emittedReadable=!1),h===0&&d.needReadable&&((d.highWaterMark!==0?d.length>=d.highWaterMark:d.length>0)||d.ended))return a("read: emitReadable",d.length,d.ended),d.length===0&&d.ended?B(this):ot(this),null;if(h=Re(h,d),h===0&&d.ended)return d.length===0&&B(this),null;var R=d.needReadable;a("need readable",R),(d.length===0||d.length-h<d.highWaterMark)&&(R=!0,a("length less than watermark",R)),d.ended||d.reading?(R=!1,a("reading or ended",R)):R&&(a("do read"),d.reading=!0,d.sync=!0,d.length===0&&(d.needReadable=!0),this._read(d.highWaterMark),d.sync=!1,d.reading||(h=Re(k,d)));var re;return h>0?re=E(h,d):re=null,re===null?(d.needReadable=d.length<=d.highWaterMark,h=0):(d.length-=h,d.awaitDrain=0),d.length===0&&(d.ended||(d.needReadable=!0),k!==h&&d.ended&&B(this)),re!==null&&this.emit("data",re),re};function Kr(h,d){if(a("onEofChunk"),!d.ended){if(d.decoder){var k=d.decoder.end();k&&k.length&&(d.buffer.push(k),d.length+=d.objectMode?1:k.length)}d.ended=!0,d.sync?ot(h):(d.needReadable=!1,d.emittedReadable||(d.emittedReadable=!0,hr(h)))}}function ot(h){var d=h._readableState;a("emitReadable",d.needReadable,d.emittedReadable),d.needReadable=!1,d.emittedReadable||(a("emitReadable",d.flowing),d.emittedReadable=!0,process.nextTick(hr,h))}function hr(h){var d=h._readableState;a("emitReadable_",d.destroyed,d.length,d.ended),!d.destroyed&&(d.length||d.ended)&&(h.emit("readable"),d.emittedReadable=!1),d.needReadable=!d.flowing&&!d.ended&&d.length<=d.highWaterMark,S(h)}function st(h,d){d.readingMore||(d.readingMore=!0,process.nextTick(dr,h,d))}function dr(h,d){for(;!d.reading&&!d.ended&&(d.length<d.highWaterMark||d.flowing&&d.length===0);){var k=d.length;if(a("maybeReadMore read 0"),h.read(0),k===d.length)break}d.readingMore=!1}m.prototype._read=function(h){A(this,new w("_read()"))},m.prototype.pipe=function(h,d){var k=this,R=this._readableState;switch(R.pipesCount){case 0:R.pipes=h;break;case 1:R.pipes=[R.pipes,h];break;default:R.pipes.push(h);break}R.pipesCount+=1,a("pipe count=%d opts=%j",R.pipesCount,d);var re=(!d||d.end!==!1)&&h!==process.stdout&&h!==process.stderr,$=re?_r:Vr;R.endEmitted?process.nextTick($):k.once("end",$),h.on("unpipe",q);function q(br,gr){a("onunpipe"),br===k&&gr&&gr.hasUnpiped===!1&&(gr.hasUnpiped=!0,oc())}function _r(){a("onend"),h.end()}var An=Wr(k);h.on("drain",An);var ds=!1;function oc(){a("cleanup"),h.removeListener("close",Mi),h.removeListener("finish",$i),h.removeListener("drain",An),h.removeListener("error",Li),h.removeListener("unpipe",q),k.removeListener("end",_r),k.removeListener("end",Vr),k.removeListener("data",ps),ds=!0,R.awaitDrain&&(!h._writableState||h._writableState.needDrain)&&An()}k.on("data",ps);function ps(br){a("ondata");var gr=h.write(br);a("dest.write",gr),gr===!1&&((R.pipesCount===1&&R.pipes===h||R.pipesCount>1&&K(R.pipes,h)!==-1)&&!ds&&(a("false write response, pause",R.awaitDrain),R.awaitDrain++),k.pause())}function Li(br){a("onerror",br),Vr(),h.removeListener("error",Li),t(h,"error")===0&&A(h,br)}O(h,"error",Li);function Mi(){h.removeListener("finish",$i),Vr()}h.once("close",Mi);function $i(){a("onfinish"),h.removeListener("close",Mi),Vr()}h.once("finish",$i);function Vr(){a("unpipe"),k.unpipe(h)}return h.emit("pipe",k),R.flowing||(a("pipe resume"),k.resume()),h};function Wr(h){return function(){var k=h._readableState;a("pipeOnDrain",k.awaitDrain),k.awaitDrain&&k.awaitDrain--,k.awaitDrain===0&&t(h,"data")&&(k.flowing=!0,S(h))}}m.prototype.unpipe=function(h){var d=this._readableState,k={hasUnpiped:!1};if(d.pipesCount===0)return this;if(d.pipesCount===1)return h&&h!==d.pipes?this:(h||(h=d.pipes),d.pipes=null,d.pipesCount=0,d.flowing=!1,h&&h.emit("unpipe",this,k),this);if(!h){var R=d.pipes,re=d.pipesCount;d.pipes=null,d.pipesCount=0,d.flowing=!1;for(var $=0;$<re;$++)R[$].emit("unpipe",this,{hasUnpiped:!1});return this}var q=K(d.pipes,h);return q===-1?this:(d.pipes.splice(q,1),d.pipesCount-=1,d.pipesCount===1&&(d.pipes=d.pipes[0]),h.emit("unpipe",this,k),this)},m.prototype.on=function(h,d){var k=r.prototype.on.call(this,h,d),R=this._readableState;return h==="data"?(R.readableListening=this.listenerCount("readable")>0,R.flowing!==!1&&this.resume()):h==="readable"&&!R.endEmitted&&!R.readableListening&&(R.readableListening=R.needReadable=!0,R.flowing=!1,R.emittedReadable=!1,a("on readable",R.length,R.reading),R.length?ot(this):R.reading||process.nextTick(Ye,this)),k},m.prototype.addListener=m.prototype.on,m.prototype.removeListener=function(h,d){var k=r.prototype.removeListener.call(this,h,d);return h==="readable"&&process.nextTick(pr,this),k},m.prototype.removeAllListeners=function(h){var d=r.prototype.removeAllListeners.apply(this,arguments);return(h==="readable"||h===void 0)&&process.nextTick(pr,this),d};function pr(h){var d=h._readableState;d.readableListening=h.listenerCount("readable")>0,d.resumeScheduled&&!d.paused?d.flowing=!0:h.listenerCount("data")>0&&h.resume()}function Ye(h){a("readable nexttick read 0"),h.read(0)}m.prototype.resume=function(){var h=this._readableState;return h.flowing||(a("resume"),h.flowing=!h.readableListening,jr(this,h)),h.paused=!1,this};function jr(h,d){d.resumeScheduled||(d.resumeScheduled=!0,process.nextTick(yr,h,d))}function yr(h,d){a("resume",d.reading),d.reading||h.read(0),d.resumeScheduled=!1,h.emit("resume"),S(h),d.flowing&&!d.reading&&h.read(0)}m.prototype.pause=function(){return a("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(a("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function S(h){var d=h._readableState;for(a("flow",d.flowing);d.flowing&&h.read()!==null;);}m.prototype.wrap=function(h){var d=this,k=this._readableState,R=!1;h.on("end",function(){if(a("wrapped end"),k.decoder&&!k.ended){var q=k.decoder.end();q&&q.length&&d.push(q)}d.push(null)}),h.on("data",function(q){if(a("wrapped data"),k.decoder&&(q=k.decoder.write(q)),!(k.objectMode&&q==null)&&!(!k.objectMode&&(!q||!q.length))){var _r=d.push(q);_r||(R=!0,h.pause())}});for(var re in h)this[re]===void 0&&typeof h[re]=="function"&&(this[re]=function(_r){return function(){return h[_r].apply(h,arguments)}}(re));for(var $=0;$<_.length;$++)h.on(_[$],this.emit.bind(this,_[$]));return this._read=function(q){a("wrapped _read",q),R&&(R=!1,h.resume())},this},typeof Symbol=="function"&&(m.prototype[Symbol.asyncIterator]=function(){return P===void 0&&(P=vp()),P(this)}),Object.defineProperty(m.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(m.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(m.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(d){this._readableState&&(this._readableState.flowing=d)}}),m._fromList=E,Object.defineProperty(m.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function E(h,d){if(d.length===0)return null;var k;return d.objectMode?k=d.buffer.shift():!h||h>=d.length?(d.decoder?k=d.buffer.join(""):d.buffer.length===1?k=d.buffer.first():k=d.buffer.concat(d.length),d.buffer.clear()):k=d.buffer.consume(h,d.decoder),k}function B(h){var d=h._readableState;a("endReadable",d.endEmitted),d.endEmitted||(d.ended=!0,process.nextTick(C,d,h))}function C(h,d){if(a("endReadableNT",h.endEmitted,h.length),!h.endEmitted&&h.length===0&&(h.endEmitted=!0,d.readable=!1,d.emit("end"),h.autoDestroy)){var k=d._writableState;(!k||k.autoDestroy&&k.finished)&&d.destroy()}}typeof Symbol=="function"&&(m.from=function(h,d){return T===void 0&&(T=mp()),T(m,h,d)});function K(h,d){for(var k=0,R=h.length;k<R;k++)if(h[k]===d)return k;return-1}return yo}var Pu=wt,Ii=cr.codes,Tp=Ii.ERR_METHOD_NOT_IMPLEMENTED,Pp=Ii.ERR_MULTIPLE_CALLBACK,Ip=Ii.ERR_TRANSFORM_ALREADY_TRANSFORMING,Ap=Ii.ERR_TRANSFORM_WITH_LENGTH_0,Ai=Ur();ve(wt,Ai);function kp(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(n===null)return this.emit("error",new Pp);r.writechunk=null,r.writecb=null,t!=null&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function wt(e){if(!(this instanceof wt))return new wt(e);Ai.call(this,e),this._transformState={afterTransform:kp.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&(typeof e.transform=="function"&&(this._transform=e.transform),typeof e.flush=="function"&&(this._flush=e.flush)),this.on("prefinish",Op)}function Op(){var e=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(t,r){gf(e,t,r)}):gf(this,null,null)}wt.prototype.push=function(e,t){return this._transformState.needTransform=!1,Ai.prototype.push.call(this,e,t)};wt.prototype._transform=function(e,t,r){r(new Tp("_transform()"))};wt.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}};wt.prototype._read=function(e){var t=this._transformState;t.writechunk!==null&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0};wt.prototype._destroy=function(e,t){Ai.prototype._destroy.call(this,e,function(r){t(r)})};function gf(e,t,r){if(t)return e.emit("error",t);if(r!=null&&e.push(r),e._writableState.length)throw new Ap;if(e._transformState.transforming)throw new Ip;return e.push(null)}var Bp=pn,Iu=Pu;ve(pn,Iu);function pn(e){if(!(this instanceof pn))return new pn(e);Iu.call(this,e)}pn.prototype._transform=function(e,t,r){r(null,e)};var _o;function xp(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}var Au=cr.codes,Rp=Au.ERR_MISSING_ARGS,Np=Au.ERR_STREAM_DESTROYED;function wf(e){if(e)throw e}function Up(e){return e.setHeader&&typeof e.abort=="function"}function Cp(e,t,r,n){n=xp(n);var i=!1;e.on("close",function(){i=!0}),_o===void 0&&(_o=as),_o(e,{readable:t,writable:r},function(s){if(s)return n(s);i=!0,n()});var o=!1;return function(s){if(!i&&!o){if(o=!0,Up(e))return e.abort();if(typeof e.destroy=="function")return e.destroy();n(s||new Np("pipe"))}}}function Ef(e){e()}function Hp(e,t){return e.pipe(t)}function Lp(e){return!e.length||typeof e[e.length-1]!="function"?wf:e.pop()}function Mp(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=Lp(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new Rp("streams");var i,o=t.map(function(s,f){var a=f<t.length-1,u=f>0;return Cp(s,a,u,function(l){i||(i=l),l&&o.forEach(Ef),!a&&(o.forEach(Ef),n(i))})});return t.reduce(Hp)}var $p=Mp;(function(e,t){t=e.exports=Tu(),t.Stream=t,t.Readable=t,t.Writable=vu(),t.Duplex=Ur(),t.Transform=Pu,t.PassThrough=Bp,t.finished=as,t.pipeline=$p})(xo,xo.exports);var Fp=xo.exports,ii=xe.Buffer,ku=Fp.Transform,Dp=ve;function Kp(e,t){if(!ii.isBuffer(e)&&typeof e!="string")throw new TypeError(t+" must be a string or a buffer")}function Lt(e){ku.call(this),this._block=ii.allocUnsafe(e),this._blockSize=e,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}Dp(Lt,ku);Lt.prototype._transform=function(e,t,r){var n=null;try{this.update(e,t)}catch(i){n=i}r(n)};Lt.prototype._flush=function(e){var t=null;try{this.push(this.digest())}catch(r){t=r}e(t)};Lt.prototype.update=function(e,t){if(Kp(e,"Data"),this._finalized)throw new Error("Digest already called");ii.isBuffer(e)||(e=ii.from(e,t));for(var r=this._block,n=0;this._blockOffset+e.length-n>=this._blockSize;){for(var i=this._blockOffset;i<this._blockSize;)r[i++]=e[n++];this._update(),this._blockOffset=0}for(;n<e.length;)r[this._blockOffset++]=e[n++];for(var o=0,s=e.length*8;s>0;++o)this._length[o]+=s,s=this._length[o]/4294967296|0,s>0&&(this._length[o]-=4294967296*s);return this};Lt.prototype._update=function(){throw new Error("_update is not implemented")};Lt.prototype.digest=function(e){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var t=this._digest();e!==void 0&&(t=t.toString(e)),this._block.fill(0),this._blockOffset=0;for(var r=0;r<4;++r)this._length[r]=0;return t};Lt.prototype._digest=function(){throw new Error("_digest is not implemented")};var Ou=Lt,Wp=ve,Bu=Ou,jp=xe.Buffer,Vp=new Array(16);function ki(){Bu.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}Wp(ki,Bu);ki.prototype._update=function(){for(var e=Vp,t=0;t<16;++t)e[t]=this._block.readInt32LE(t*4);var r=this._a,n=this._b,i=this._c,o=this._d;r=ge(r,n,i,o,e[0],3614090360,7),o=ge(o,r,n,i,e[1],3905402710,12),i=ge(i,o,r,n,e[2],606105819,17),n=ge(n,i,o,r,e[3],3250441966,22),r=ge(r,n,i,o,e[4],4118548399,7),o=ge(o,r,n,i,e[5],1200080426,12),i=ge(i,o,r,n,e[6],2821735955,17),n=ge(n,i,o,r,e[7],4249261313,22),r=ge(r,n,i,o,e[8],1770035416,7),o=ge(o,r,n,i,e[9],2336552879,12),i=ge(i,o,r,n,e[10],4294925233,17),n=ge(n,i,o,r,e[11],2304563134,22),r=ge(r,n,i,o,e[12],1804603682,7),o=ge(o,r,n,i,e[13],4254626195,12),i=ge(i,o,r,n,e[14],2792965006,17),n=ge(n,i,o,r,e[15],1236535329,22),r=we(r,n,i,o,e[1],4129170786,5),o=we(o,r,n,i,e[6],3225465664,9),i=we(i,o,r,n,e[11],643717713,14),n=we(n,i,o,r,e[0],3921069994,20),r=we(r,n,i,o,e[5],3593408605,5),o=we(o,r,n,i,e[10],38016083,9),i=we(i,o,r,n,e[15],3634488961,14),n=we(n,i,o,r,e[4],3889429448,20),r=we(r,n,i,o,e[9],568446438,5),o=we(o,r,n,i,e[14],3275163606,9),i=we(i,o,r,n,e[3],4107603335,14),n=we(n,i,o,r,e[8],1163531501,20),r=we(r,n,i,o,e[13],2850285829,5),o=we(o,r,n,i,e[2],4243563512,9),i=we(i,o,r,n,e[7],1735328473,14),n=we(n,i,o,r,e[12],2368359562,20),r=Ee(r,n,i,o,e[5],4294588738,4),o=Ee(o,r,n,i,e[8],2272392833,11),i=Ee(i,o,r,n,e[11],1839030562,16),n=Ee(n,i,o,r,e[14],4259657740,23),r=Ee(r,n,i,o,e[1],2763975236,4),o=Ee(o,r,n,i,e[4],1272893353,11),i=Ee(i,o,r,n,e[7],4139469664,16),n=Ee(n,i,o,r,e[10],3200236656,23),r=Ee(r,n,i,o,e[13],681279174,4),o=Ee(o,r,n,i,e[0],3936430074,11),i=Ee(i,o,r,n,e[3],3572445317,16),n=Ee(n,i,o,r,e[6],76029189,23),r=Ee(r,n,i,o,e[9],3654602809,4),o=Ee(o,r,n,i,e[12],3873151461,11),i=Ee(i,o,r,n,e[15],530742520,16),n=Ee(n,i,o,r,e[2],3299628645,23),r=Se(r,n,i,o,e[0],4096336452,6),o=Se(o,r,n,i,e[7],1126891415,10),i=Se(i,o,r,n,e[14],2878612391,15),n=Se(n,i,o,r,e[5],4237533241,21),r=Se(r,n,i,o,e[12],1700485571,6),o=Se(o,r,n,i,e[3],2399980690,10),i=Se(i,o,r,n,e[10],4293915773,15),n=Se(n,i,o,r,e[1],2240044497,21),r=Se(r,n,i,o,e[8],1873313359,6),o=Se(o,r,n,i,e[15],4264355552,10),i=Se(i,o,r,n,e[6],2734768916,15),n=Se(n,i,o,r,e[13],1309151649,21),r=Se(r,n,i,o,e[4],4149444226,6),o=Se(o,r,n,i,e[11],3174756917,10),i=Se(i,o,r,n,e[2],718787259,15),n=Se(n,i,o,r,e[9],3951481745,21),this._a=this._a+r|0,this._b=this._b+n|0,this._c=this._c+i|0,this._d=this._d+o|0};ki.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=jp.allocUnsafe(16);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e};function Oi(e,t){return e<<t|e>>>32-t}function ge(e,t,r,n,i,o,s){return Oi(e+(t&r|~t&n)+i+o|0,s)+t|0}function we(e,t,r,n,i,o,s){return Oi(e+(t&n|r&~n)+i+o|0,s)+t|0}function Ee(e,t,r,n,i,o,s){return Oi(e+(t^r^n)+i+o|0,s)+t|0}function Se(e,t,r,n,i,o,s){return Oi(e+(r^(t|~n))+i+o|0,s)+t|0}var Gp=ki,bo=Ct.Buffer,qp=ve,xu=Ou,Xp=new Array(16),Qr=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],Zr=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],en=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],tn=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],rn=[0,1518500249,1859775393,2400959708,2840853838],nn=[1352829926,1548603684,1836072691,2053994217,0];function Bi(){xu.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}qp(Bi,xu);Bi.prototype._update=function(){for(var e=Xp,t=0;t<16;++t)e[t]=this._block.readInt32LE(t*4);for(var r=this._a|0,n=this._b|0,i=this._c|0,o=this._d|0,s=this._e|0,f=this._a|0,a=this._b|0,u=this._c|0,l=this._d|0,c=this._e|0,b=0;b<80;b+=1){var p,y;b<16?(p=Sf(r,n,i,o,s,e[Qr[b]],rn[0],en[b]),y=Pf(f,a,u,l,c,e[Zr[b]],nn[0],tn[b])):b<32?(p=vf(r,n,i,o,s,e[Qr[b]],rn[1],en[b]),y=Tf(f,a,u,l,c,e[Zr[b]],nn[1],tn[b])):b<48?(p=mf(r,n,i,o,s,e[Qr[b]],rn[2],en[b]),y=mf(f,a,u,l,c,e[Zr[b]],nn[2],tn[b])):b<64?(p=Tf(r,n,i,o,s,e[Qr[b]],rn[3],en[b]),y=vf(f,a,u,l,c,e[Zr[b]],nn[3],tn[b])):(p=Pf(r,n,i,o,s,e[Qr[b]],rn[4],en[b]),y=Sf(f,a,u,l,c,e[Zr[b]],nn[4],tn[b])),r=s,s=o,o=Vt(i,10),i=n,n=p,f=c,c=l,l=Vt(u,10),u=a,a=y}var g=this._b+i+l|0;this._b=this._c+o+c|0,this._c=this._d+s+f|0,this._d=this._e+r+a|0,this._e=this._a+n+u|0,this._a=g};Bi.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=bo.alloc?bo.alloc(20):new bo(20);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e.writeInt32LE(this._e,16),e};function Vt(e,t){return e<<t|e>>>32-t}function Sf(e,t,r,n,i,o,s,f){return Vt(e+(t^r^n)+o+s|0,f)+i|0}function vf(e,t,r,n,i,o,s,f){return Vt(e+(t&r|~t&n)+o+s|0,f)+i|0}function mf(e,t,r,n,i,o,s,f){return Vt(e+((t|~r)^n)+o+s|0,f)+i|0}function Tf(e,t,r,n,i,o,s,f){return Vt(e+(t&n|r&~n)+o+s|0,f)+i|0}function Pf(e,t,r,n,i,o,s,f){return Vt(e+(t^(r|~n))+o+s|0,f)+i|0}var Yp=Bi,Ru={exports:{}},Nu=xe.Buffer;function xi(e,t){this._block=Nu.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}xi.prototype.update=function(e,t){typeof e=="string"&&(t=t||"utf8",e=Nu.from(e,t));for(var r=this._block,n=this._blockSize,i=e.length,o=this._len,s=0;s<i;){for(var f=o%n,a=Math.min(i-s,n-f),u=0;u<a;u++)r[f+u]=e[s+u];o+=a,s+=a,o%n===0&&this._update(r)}return this._len+=i,this};xi.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var r=this._len*8;if(r<=4294967295)this._block.writeUInt32BE(r,this._blockSize-4);else{var n=(r&4294967295)>>>0,i=(r-n)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(n,this._blockSize-4)}this._update(this._block);var o=this._hash();return e?o.toString(e):o};xi.prototype._update=function(){throw new Error("_update must be implemented by subclass")};var Mr=xi,zp=ve,Uu=Mr,Jp=xe.Buffer,Qp=[1518500249,1859775393,-1894007588,-899497514],Zp=new Array(80);function Sn(){this.init(),this._w=Zp,Uu.call(this,64,56)}zp(Sn,Uu);Sn.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function ey(e){return e<<5|e>>>27}function ty(e){return e<<30|e>>>2}function ry(e,t,r,n){return e===0?t&r|~t&n:e===2?t&r|t&n|r&n:t^r^n}Sn.prototype._update=function(e){for(var t=this._w,r=this._a|0,n=this._b|0,i=this._c|0,o=this._d|0,s=this._e|0,f=0;f<16;++f)t[f]=e.readInt32BE(f*4);for(;f<80;++f)t[f]=t[f-3]^t[f-8]^t[f-14]^t[f-16];for(var a=0;a<80;++a){var u=~~(a/20),l=ey(r)+ry(u,n,i,o)+s+t[a]+Qp[u]|0;s=o,o=i,i=ty(n),n=r,r=l}this._a=r+this._a|0,this._b=n+this._b|0,this._c=i+this._c|0,this._d=o+this._d|0,this._e=s+this._e|0};Sn.prototype._hash=function(){var e=Jp.allocUnsafe(20);return e.writeInt32BE(this._a|0,0),e.writeInt32BE(this._b|0,4),e.writeInt32BE(this._c|0,8),e.writeInt32BE(this._d|0,12),e.writeInt32BE(this._e|0,16),e};var ny=Sn,iy=ve,Cu=Mr,oy=xe.Buffer,sy=[1518500249,1859775393,-1894007588,-899497514],fy=new Array(80);function vn(){this.init(),this._w=fy,Cu.call(this,64,56)}iy(vn,Cu);vn.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function ay(e){return e<<1|e>>>31}function uy(e){return e<<5|e>>>27}function cy(e){return e<<30|e>>>2}function ly(e,t,r,n){return e===0?t&r|~t&n:e===2?t&r|t&n|r&n:t^r^n}vn.prototype._update=function(e){for(var t=this._w,r=this._a|0,n=this._b|0,i=this._c|0,o=this._d|0,s=this._e|0,f=0;f<16;++f)t[f]=e.readInt32BE(f*4);for(;f<80;++f)t[f]=ay(t[f-3]^t[f-8]^t[f-14]^t[f-16]);for(var a=0;a<80;++a){var u=~~(a/20),l=uy(r)+ly(u,n,i,o)+s+t[a]+sy[u]|0;s=o,o=i,i=cy(n),n=r,r=l}this._a=r+this._a|0,this._b=n+this._b|0,this._c=i+this._c|0,this._d=o+this._d|0,this._e=s+this._e|0};vn.prototype._hash=function(){var e=oy.allocUnsafe(20);return e.writeInt32BE(this._a|0,0),e.writeInt32BE(this._b|0,4),e.writeInt32BE(this._c|0,8),e.writeInt32BE(this._d|0,12),e.writeInt32BE(this._e|0,16),e};var hy=vn,dy=ve,Hu=Mr,py=xe.Buffer,yy=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],_y=new Array(64);function mn(){this.init(),this._w=_y,Hu.call(this,64,56)}dy(mn,Hu);mn.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function by(e,t,r){return r^e&(t^r)}function gy(e,t,r){return e&t|r&(e|t)}function wy(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function Ey(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function Sy(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}function vy(e){return(e>>>17|e<<15)^(e>>>19|e<<13)^e>>>10}mn.prototype._update=function(e){for(var t=this._w,r=this._a|0,n=this._b|0,i=this._c|0,o=this._d|0,s=this._e|0,f=this._f|0,a=this._g|0,u=this._h|0,l=0;l<16;++l)t[l]=e.readInt32BE(l*4);for(;l<64;++l)t[l]=vy(t[l-2])+t[l-7]+Sy(t[l-15])+t[l-16]|0;for(var c=0;c<64;++c){var b=u+Ey(s)+by(s,f,a)+yy[c]+t[c]|0,p=wy(r)+gy(r,n,i)|0;u=a,a=f,f=s,s=o+b|0,o=i,i=n,n=r,r=b+p|0}this._a=r+this._a|0,this._b=n+this._b|0,this._c=i+this._c|0,this._d=o+this._d|0,this._e=s+this._e|0,this._f=f+this._f|0,this._g=a+this._g|0,this._h=u+this._h|0};mn.prototype._hash=function(){var e=py.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e};var Lu=mn,my=ve,Ty=Lu,Py=Mr,Iy=xe.Buffer,Ay=new Array(64);function Ri(){this.init(),this._w=Ay,Py.call(this,64,56)}my(Ri,Ty);Ri.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this};Ri.prototype._hash=function(){var e=Iy.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e};var ky=Ri,Oy=ve,Mu=Mr,By=xe.Buffer,If=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],xy=new Array(160);function Tn(){this.init(),this._w=xy,Mu.call(this,128,112)}Oy(Tn,Mu);Tn.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function Af(e,t,r){return r^e&(t^r)}function kf(e,t,r){return e&t|r&(e|t)}function Of(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function Bf(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function Ry(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function Ny(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function Uy(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function Cy(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function ce(e,t){return e>>>0<t>>>0?1:0}Tn.prototype._update=function(e){for(var t=this._w,r=this._ah|0,n=this._bh|0,i=this._ch|0,o=this._dh|0,s=this._eh|0,f=this._fh|0,a=this._gh|0,u=this._hh|0,l=this._al|0,c=this._bl|0,b=this._cl|0,p=this._dl|0,y=this._el|0,g=this._fl|0,w=this._gl|0,v=this._hl|0,I=0;I<32;I+=2)t[I]=e.readInt32BE(I*4),t[I+1]=e.readInt32BE(I*4+4);for(;I<160;I+=2){var P=t[I-30],T=t[I-15*2+1],A=Ry(P,T),_=Ny(T,P);P=t[I-2*2],T=t[I-2*2+1];var O=Uy(P,T),x=Cy(T,P),m=t[I-7*2],N=t[I-7*2+1],F=t[I-16*2],J=t[I-16*2+1],D=_+N|0,ee=A+m+ce(D,_)|0;D=D+x|0,ee=ee+O+ce(D,x)|0,D=D+J|0,ee=ee+F+ce(D,J)|0,t[I]=ee,t[I+1]=D}for(var Re=0;Re<160;Re+=2){ee=t[Re],D=t[Re+1];var Kr=kf(r,n,i),ot=kf(l,c,b),hr=Of(r,l),st=Of(l,r),dr=Bf(s,y),Wr=Bf(y,s),pr=If[Re],Ye=If[Re+1],jr=Af(s,f,a),yr=Af(y,g,w),S=v+Wr|0,E=u+dr+ce(S,v)|0;S=S+yr|0,E=E+jr+ce(S,yr)|0,S=S+Ye|0,E=E+pr+ce(S,Ye)|0,S=S+D|0,E=E+ee+ce(S,D)|0;var B=st+ot|0,C=hr+Kr+ce(B,st)|0;u=a,v=w,a=f,w=g,f=s,g=y,y=p+S|0,s=o+E+ce(y,p)|0,o=i,p=b,i=n,b=c,n=r,c=l,l=S+B|0,r=E+C+ce(l,S)|0}this._al=this._al+l|0,this._bl=this._bl+c|0,this._cl=this._cl+b|0,this._dl=this._dl+p|0,this._el=this._el+y|0,this._fl=this._fl+g|0,this._gl=this._gl+w|0,this._hl=this._hl+v|0,this._ah=this._ah+r+ce(this._al,l)|0,this._bh=this._bh+n+ce(this._bl,c)|0,this._ch=this._ch+i+ce(this._cl,b)|0,this._dh=this._dh+o+ce(this._dl,p)|0,this._eh=this._eh+s+ce(this._el,y)|0,this._fh=this._fh+f+ce(this._fl,g)|0,this._gh=this._gh+a+ce(this._gl,w)|0,this._hh=this._hh+u+ce(this._hl,v)|0};Tn.prototype._hash=function(){var e=By.allocUnsafe(64);function t(r,n,i){e.writeInt32BE(r,i),e.writeInt32BE(n,i+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e};var $u=Tn,Hy=ve,Ly=$u,My=Mr,$y=xe.Buffer,Fy=new Array(160);function Ni(){this.init(),this._w=Fy,My.call(this,128,112)}Hy(Ni,Ly);Ni.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this};Ni.prototype._hash=function(){var e=$y.allocUnsafe(48);function t(r,n,i){e.writeInt32BE(r,i),e.writeInt32BE(n,i+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e};var Dy=Ni,lr=Ru.exports=function(t){t=t.toLowerCase();var r=lr[t];if(!r)throw new Error(t+" is not supported (we accept pull requests)");return new r};lr.sha=ny;lr.sha1=hy;lr.sha224=ky;lr.sha256=Lu;lr.sha384=Dy;lr.sha512=$u;var Ky=Ru.exports,Fu=xe.Buffer,Du=ln.Transform,Wy=ni.StringDecoder,jy=ve;function Xe(e){Du.call(this),this.hashMode=typeof e=="string",this.hashMode?this[e]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}jy(Xe,Du);Xe.prototype.update=function(e,t,r){typeof e=="string"&&(e=Fu.from(e,t));var n=this._update(e);return this.hashMode?this:(r&&(n=this._toString(n,r)),n)};Xe.prototype.setAutoPadding=function(){};Xe.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")};Xe.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")};Xe.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")};Xe.prototype._transform=function(e,t,r){var n;try{this.hashMode?this._update(e):this.push(this._update(e))}catch(i){n=i}finally{r(n)}};Xe.prototype._flush=function(e){var t;try{this.push(this.__final())}catch(r){t=r}e(t)};Xe.prototype._finalOrDigest=function(e){var t=this.__final()||Fu.alloc(0);return e&&(t=this._toString(t,e,!0)),t};Xe.prototype._toString=function(e,t,r){if(this._decoder||(this._decoder=new Wy(t),this._encoding=t),this._encoding!==t)throw new Error("can't switch encodings");var n=this._decoder.write(e);return r&&(n+=this._decoder.end()),n};var Vy=Xe,Gy=ve,qy=Gp,Xy=Yp,Yy=Ky,Ku=Vy;function Ui(e){Ku.call(this,"digest"),this._hash=e}Gy(Ui,Ku);Ui.prototype._update=function(e){this._hash.update(e)};Ui.prototype._final=function(){return this._hash.digest()};var zy=function(t){return t=t.toLowerCase(),t==="md5"?new qy:t==="rmd160"||t==="ripemd160"?new Xy:new Ui(Yy(t))},Dn=xe.Buffer;function Jy(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var n=0;n<e.length;n++){var i=e.charAt(n),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=n}var s=e.length,f=e.charAt(0),a=Math.log(s)/Math.log(256),u=Math.log(256)/Math.log(s);function l(p){if((Array.isArray(p)||p instanceof Uint8Array)&&(p=Dn.from(p)),!Dn.isBuffer(p))throw new TypeError("Expected Buffer");if(p.length===0)return"";for(var y=0,g=0,w=0,v=p.length;w!==v&&p[w]===0;)w++,y++;for(var I=(v-w)*u+1>>>0,P=new Uint8Array(I);w!==v;){for(var T=p[w],A=0,_=I-1;(T!==0||A<g)&&_!==-1;_--,A++)T+=256*P[_]>>>0,P[_]=T%s>>>0,T=T/s>>>0;if(T!==0)throw new Error("Non-zero carry");g=A,w++}for(var O=I-g;O!==I&&P[O]===0;)O++;for(var x=f.repeat(y);O<I;++O)x+=e.charAt(P[O]);return x}function c(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return Dn.alloc(0);for(var y=0,g=0,w=0;p[y]===f;)g++,y++;for(var v=(p.length-y)*a+1>>>0,I=new Uint8Array(v);p[y];){var P=t[p.charCodeAt(y)];if(P===255)return;for(var T=0,A=v-1;(P!==0||T<w)&&A!==-1;A--,T++)P+=s*I[A]>>>0,I[A]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");w=T,y++}for(var _=v-w;_!==v&&I[_]===0;)_++;var O=Dn.allocUnsafe(g+(v-_));O.fill(0,0,g);for(var x=g;_!==v;)O[x++]=I[_++];return O}function b(p){var y=c(p);if(y)return y;throw new Error("Non-base"+s+" character")}return{encode:l,decodeUnsafe:c,decode:b}}var Qy=Jy,Zy=Qy,e_="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",t_=Zy(e_),go=t_,r_=xe.Buffer,n_=function(e){function t(o){var s=e(o);return go.encode(r_.concat([o,s],o.length+4))}function r(o){var s=o.slice(0,-4),f=o.slice(-4),a=e(s);if(!(f[0]^a[0]|f[1]^a[1]|f[2]^a[2]|f[3]^a[3]))return s}function n(o){var s=go.decodeUnsafe(o);if(s)return r(s)}function i(o){var s=go.decode(o),f=r(s);if(!f)throw new Error("Invalid checksum");return f}return{encode:t,decode:i,decodeUnsafe:n}},xf=zy,i_=n_;function o_(e){var t=xf("sha256").update(e).digest();return xf("sha256").update(t).digest()}var s_=i_(o_),No=s_;function Wu(e,t){if(t!==void 0&&e[0]!==t)throw new Error("Invalid network version");if(e.length===33)return{version:e[0],privateKey:e.slice(1,33),compressed:!1};if(e.length!==34)throw new Error("Invalid WIF length");if(e[33]!==1)throw new Error("Invalid compression flag");return{version:e[0],privateKey:e.slice(1,33),compressed:!0}}function Uo(e,t,r){var n=new Buffer(r?34:33);return n.writeUInt8(e,0),t.copy(n,1),r&&(n[33]=1),n}function f_(e,t){return Wu(No.decode(e),t)}function a_(e,t,r){return typeof e=="number"?No.encode(Uo(e,t,r)):No.encode(Uo(e.version,e.privateKey,e.compressed))}var u_={decode:f_,decodeRaw:Wu,encode:a_,encodeRaw:Uo},Ci={};Object.defineProperty(Ci,"__esModule",{value:!0});Ci.testEcc=void 0;const U=e=>Buffer.from(e,"hex");function c_(e){Y(e.isPoint(U("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),Y(!e.isPoint(U("030000000000000000000000000000000000000000000000000000000000000005"))),Y(e.isPrivate(U("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),Y(e.isPrivate(U("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),Y(!e.isPrivate(U("0000000000000000000000000000000000000000000000000000000000000000"))),Y(!e.isPrivate(U("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"))),Y(!e.isPrivate(U("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364142"))),Y(Buffer.from(e.privateAdd(U("0000000000000000000000000000000000000000000000000000000000000001"),U("0000000000000000000000000000000000000000000000000000000000000000"))).equals(U("0000000000000000000000000000000000000000000000000000000000000001"))),Y(e.privateAdd(U("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"),U("0000000000000000000000000000000000000000000000000000000000000003"))===null),Y(Buffer.from(e.privateAdd(U("e211078564db65c3ce7704f08262b1f38f1ef412ad15b5ac2d76657a63b2c500"),U("b51fbb69051255d1becbd683de5848242a89c229348dd72896a87ada94ae8665"))).equals(U("9730c2ee69edbb958d42db7460bafa18fef9d955325aec99044c81c8282b0a24"))),Y(Buffer.from(e.privateNegate(U("0000000000000000000000000000000000000000000000000000000000000001"))).equals(U("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),Y(Buffer.from(e.privateNegate(U("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"))).equals(U("0000000000000000000000000000000000000000000000000000000000000003"))),Y(Buffer.from(e.privateNegate(U("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(U("4eede1bf775995d70a494f0a7bb6bc11e0b8cccd41cce8009ab1132c8b0a3792"))),Y(Buffer.from(e.pointCompress(U("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!0)).equals(U("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),Y(Buffer.from(e.pointCompress(U("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!1)).equals(U("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),Y(Buffer.from(e.pointCompress(U("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!0)).equals(U("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),Y(Buffer.from(e.pointCompress(U("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!1)).equals(U("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),Y(Buffer.from(e.pointFromScalar(U("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(U("02b07ba9dca9523b7ef4bd97703d43d20399eb698e194704791a25ce77a400df99"))),Y(e.xOnlyPointAddTweak(U("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),U("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))===null);let t=e.xOnlyPointAddTweak(U("1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b"),U("a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac"));Y(Buffer.from(t.xOnlyPubkey).equals(U("e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"))&&t.parity===1),t=e.xOnlyPointAddTweak(U("2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991"),U("823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47")),Y(Buffer.from(t.xOnlyPubkey).equals(U("9534f8dc8c6deda2dc007655981c78b49c5d96c778fbf363462a11ec9dfd948c"))&&t.parity===0),Y(Buffer.from(e.sign(U("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),U("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))).equals(U("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),Y(e.verify(U("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),U("0379be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),U("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),e.signSchnorr&&Y(Buffer.from(e.signSchnorr(U("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),U("c90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b14e5c9"),U("c87aa53824b4d7ae2eb035a2b5bbbccc080e76cdc6d1692c4b0b62d798e6d906"))).equals(U("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7"))),e.verifySchnorr&&Y(e.verifySchnorr(U("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),U("dd308afec5777e13121fa72b9cc1b7cc0139715309b086c960e18fd969774eb8"),U("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7")))}Ci.testEcc=c_;function Y(e){if(!e)throw new Error("ecc library invalid")}Object.defineProperty(Rr,"__esModule",{value:!0});Rr.ECPairFactory=Rr.networks=void 0;const Co=Nr;Rr.networks=Co;const Ie=bu,l_=G0,Rf=u_,h_=Ci,wo=Ie.typeforce.maybe(Ie.typeforce.compile({compressed:Ie.maybe(Ie.Boolean),network:Ie.maybe(Ie.Network)})),d_=e=>e.length===32?e:e.slice(1,33);function p_(e){(0,h_.testEcc)(e);function t(f){return e.isPoint(f)}function r(f,a){if(Ie.typeforce(Ie.Buffer256bit,f),!e.isPrivate(f))throw new TypeError("Private key not in range [1, n)");return Ie.typeforce(wo,a),new s(f,void 0,a)}function n(f,a){return Ie.typeforce(e.isPoint,f),Ie.typeforce(wo,a),new s(void 0,f,a)}function i(f,a){const u=Rf.decode(f),l=u.version;if(Ie.Array(a)){if(a=a.filter(c=>l===c.wif).pop(),!a)throw new Error("Unknown network version")}else if(a=a||Co.bitcoin,l!==a.wif)throw new Error("Invalid network version");return r(u.privateKey,{compressed:u.compressed,network:a})}function o(f){Ie.typeforce(wo,f),f===void 0&&(f={});const a=f.rng||l_;let u;do u=a(32),Ie.typeforce(Ie.Buffer256bit,u);while(!e.isPrivate(u));return r(u,f)}class s{__D;__Q;compressed;network;lowR;constructor(a,u,l){this.__D=a,this.__Q=u,this.lowR=!1,l===void 0&&(l={}),this.compressed=l.compressed===void 0?!0:l.compressed,this.network=l.network||Co.bitcoin,u!==void 0&&(this.__Q=Buffer.from(e.pointCompress(u,this.compressed)))}get privateKey(){return this.__D}get publicKey(){if(!this.__Q){const a=e.pointFromScalar(this.__D,this.compressed);this.__Q=Buffer.from(a)}return this.__Q}toWIF(){if(!this.__D)throw new Error("Missing private key");return Rf.encode(this.network.wif,this.__D,this.compressed)}tweak(a){return this.privateKey?this.tweakFromPrivateKey(a):this.tweakFromPublicKey(a)}sign(a,u){if(!this.__D)throw new Error("Missing private key");if(u===void 0&&(u=this.lowR),u===!1)return Buffer.from(e.sign(a,this.__D));{let l=e.sign(a,this.__D);const c=Buffer.alloc(32,0);let b=0;for(;l[0]>127;)b++,c.writeUIntLE(b,0,6),l=e.sign(a,this.__D,c);return Buffer.from(l)}}signSchnorr(a){if(!this.privateKey)throw new Error("Missing private key");if(!e.signSchnorr)throw new Error("signSchnorr not supported by ecc library");return Buffer.from(e.signSchnorr(a,this.privateKey))}verify(a,u){return e.verify(a,this.publicKey,u)}verifySchnorr(a,u){if(!e.verifySchnorr)throw new Error("verifySchnorr not supported by ecc library");return e.verifySchnorr(a,this.publicKey.subarray(1,33),u)}tweakFromPublicKey(a){const u=d_(this.publicKey),l=e.xOnlyPointAddTweak(u,a);if(!l||l.xOnlyPubkey===null)throw new Error("Cannot tweak public key!");const c=Buffer.from([l.parity===0?2:3]);return n(Buffer.concat([c,l.xOnlyPubkey]),{network:this.network,compressed:this.compressed})}tweakFromPrivateKey(a){const l=this.publicKey[0]===3||this.publicKey[0]===4&&(this.publicKey[64]&1)===1?e.privateNegate(this.privateKey):this.privateKey,c=e.privateAdd(l,a);if(!c)throw new Error("Invalid tweaked private key!");return r(Buffer.from(c),{network:this.network,compressed:this.compressed})}}return{isPoint:t,fromPrivateKey:r,fromPublicKey:n,fromWIF:i,makeRandom:o}}Rr.ECPairFactory=p_;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.networks=e.ECPairFactory=e.default=void 0;var t=Rr;Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.ECPairFactory}}),Object.defineProperty(e,"ECPairFactory",{enumerable:!0,get:function(){return t.ECPairFactory}}),Object.defineProperty(e,"networks",{enumerable:!0,get:function(){return t.networks}})})(_u);const y_=jf(_u),ju="0123456789abcdefABCDEF";ju.split("").map(e=>e.codePointAt(0));Array(256).fill(!0).map((e,t)=>{const r=String.fromCodePoint(t),n=ju.indexOf(r);return n<0?void 0:n<16?n:n-6});new TextEncoder;new TextDecoder("ascii");function __(e,t){const r=Math.min(e.length,t.length);for(let n=0;n<r;++n)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return e.length===t.length?0:e.length>t.length?1:-1}const Vu=0,us=1,Gu=2,qu=3,yn=4,Xu=5,Yu=6,zu=7,b_={[Vu.toString()]:"Expected Private",[us.toString()]:"Expected Point",[Gu.toString()]:"Expected Tweak",[qu.toString()]:"Expected Hash",[yn.toString()]:"Expected Signature",[Xu.toString()]:"Expected Extra Data (32 bytes)",[Yu.toString()]:"Expected Parity (1 | 0)",[zu.toString()]:"Bad Recovery Id"};function He(e){const t=b_[e.toString()]||`Unknow error code: ${e}`;throw new TypeError(t)}const Pn=32,_n=33,In=65,Mt=32,Ju=32,Qu=32,Zu=32,Hi=64,ec=new Uint8Array(32),oi=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65]),g_=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,69,81,35,25,80,183,95,196,64,45,161,114,47,201,186,238]);function it(e){return e instanceof Uint8Array}function Gt(e,t){for(let r=0;r<32;++r)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}function Ho(e){return Gt(e,ec)===0}function tc(e){return it(e)&&e.length===Pn&&Gt(e,ec)>0&&Gt(e,oi)<0}function w_(e){return it(e)&&(e.length===_n||e.length===In||e.length===Mt)}function rc(e){return it(e)&&e.length===Mt}function E_(e){return it(e)&&(e.length===_n||e.length===In)}function S_(e){return it(e)&&e.length===_n}function v_(e){return it(e)&&e.length===Ju&&Gt(e,oi)<0}function m_(e){return it(e)&&e.length===Qu}function T_(e){return e===void 0||it(e)&&e.length===Zu}function P_(e){return it(e)&&e.length===64&&Gt(e.subarray(0,32),oi)<0&&Gt(e.subarray(32,64),oi)<0}function I_(e){return it(e)&&e.length===64&&Gt(e.subarray(0,32),g_)<0}function A_(e){e!==0&&e!==1&&He(Yu)}function $t(e){tc(e)||He(Vu)}function qt(e){w_(e)||He(us)}function si(e){rc(e)||He(us)}function $r(e){v_(e)||He(Gu)}function Fr(e){m_(e)||He(qu)}function cs(e){T_(e)||He(Xu)}function ls(e){P_(e)||He(yn)}function k_(e){e()||He(yn)}function O_(e){Ho(e.subarray(0,32))&&He(yn),Ho(e.subarray(32,64))&&He(yn)}function B_(e){I_(e)||He(zu)}const x_="/Robot_Dream_Blockchain_Practice/assets/secp256k1-c2a2ab4f.wasm",R_=async(e={},t)=>{let r;if(t.startsWith("data:")){const n=t.replace(/^data:.*?base64,/,"");let i;if(typeof Buffer=="function"&&typeof Buffer.from=="function")i=Buffer.from(n,"base64");else if(typeof atob=="function"){const o=atob(n);i=new Uint8Array(o.length);for(let s=0;s<o.length;s++)i[s]=o.charCodeAt(s)}else throw new Error("Cannot decode base64-encoded data URL");r=await WebAssembly.instantiate(i,e)}else{const n=await fetch(t),i=n.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&i.startsWith("application/wasm"))r=await WebAssembly.instantiateStreaming(n,e);else{const o=await n.arrayBuffer();r=await WebAssembly.instantiate(o,e)}}return r.instance.exports};function N_(){const e=new Uint8Array(4);if(typeof crypto>"u")throw new Error("The crypto object is unavailable. This may occur if your environment does not support the Web Cryptography API.");return crypto.getRandomValues(e),e}function U_(){const e=N_();return(e[0]<<3*8)+(e[1]<<2*8)+(e[2]<<1*8)+e[3]}URL=globalThis.URL;const W=await R_({"./rand.js":{generateInt32:U_},"./validate_error.js":{throwError:He}},x_),C_=W.memory,H_=W.initializeContext,L_=W.isPoint,M_=W.PUBLIC_KEY_INPUT,$_=W.pointAdd,F_=W.PUBLIC_KEY_INPUT2,D_=W.pointAddScalar,K_=W.TWEAK_INPUT,W_=W.xOnlyPointAddTweak,j_=W.X_ONLY_PUBLIC_KEY_INPUT,V_=W.xOnlyPointAddTweakCheck,G_=W.X_ONLY_PUBLIC_KEY_INPUT2,q_=W.pointCompress,X_=W.pointFromScalar,Y_=W.PRIVATE_INPUT,z_=W.xOnlyPointFromScalar,J_=W.xOnlyPointFromPoint,Q_=W.pointMultiply,Z_=W.privateAdd,e1=W.privateSub,t1=W.privateNegate,r1=W.sign,n1=W.HASH_INPUT,i1=W.EXTRA_DATA_INPUT,o1=W.SIGNATURE_INPUT,s1=W.signRecoverable,f1=W.signSchnorr,a1=W.verify,u1=W.recover,c1=W.verifySchnorr,l1=W.rustsecp256k1_v0_8_1_default_error_callback_fn,h1=W.rustsecp256k1_v0_8_1_default_illegal_callback_fn,d1=W.__data_end,p1=W.__heap_base,V=Object.freeze(Object.defineProperty({__proto__:null,EXTRA_DATA_INPUT:i1,HASH_INPUT:n1,PRIVATE_INPUT:Y_,PUBLIC_KEY_INPUT:M_,PUBLIC_KEY_INPUT2:F_,SIGNATURE_INPUT:o1,TWEAK_INPUT:K_,X_ONLY_PUBLIC_KEY_INPUT:j_,X_ONLY_PUBLIC_KEY_INPUT2:G_,__data_end:d1,__heap_base:p1,initializeContext:H_,isPoint:L_,memory:C_,pointAdd:$_,pointAddScalar:D_,pointCompress:q_,pointFromScalar:X_,pointMultiply:Q_,privateAdd:Z_,privateNegate:t1,privateSub:e1,recover:u1,rustsecp256k1_v0_8_1_default_error_callback_fn:l1,rustsecp256k1_v0_8_1_default_illegal_callback_fn:h1,sign:r1,signRecoverable:s1,signSchnorr:f1,verify:a1,verifySchnorr:c1,xOnlyPointAddTweak:W_,xOnlyPointAddTweakCheck:V_,xOnlyPointFromPoint:J_,xOnlyPointFromScalar:z_},Symbol.toStringTag,{value:"Module"})),Et=new Uint8Array(V.memory.buffer),Nf=V.PRIVATE_INPUT.value,Uf=V.PUBLIC_KEY_INPUT.value,Cf=V.PUBLIC_KEY_INPUT2.value,Hf=V.X_ONLY_PUBLIC_KEY_INPUT.value,Lf=V.X_ONLY_PUBLIC_KEY_INPUT2.value,Mf=V.TWEAK_INPUT.value,$f=V.HASH_INPUT.value,Ff=V.EXTRA_DATA_INPUT.value,Df=V.SIGNATURE_INPUT.value,ue=Et.subarray(Nf,Nf+Pn),ne=Et.subarray(Uf,Uf+In),Kf=Et.subarray(Cf,Cf+In),De=Et.subarray(Hf,Hf+Mt),Wf=Et.subarray(Lf,Lf+Mt),Ke=Et.subarray(Mf,Mf+Ju),We=Et.subarray($f,$f+Qu),Cr=Et.subarray(Ff,Ff+Zu),je=Et.subarray(Df,Df+Hi);function Dr(e,t){return e===void 0?t!==void 0?t.length:_n:e?_n:In}function hs(e){try{return ne.set(e),V.isPoint(e.length)===1}finally{ne.fill(0)}}function y1(){V.initializeContext()}function _1(e){return E_(e)&&hs(e)}function b1(e){return S_(e)&&hs(e)}function nc(e){return rc(e)&&hs(e)}function g1(e){return tc(e)}function w1(e,t,r){qt(e),qt(t);const n=Dr(r,e);try{return ne.set(e),Kf.set(t),V.pointAdd(e.length,t.length,n)===1?ne.slice(0,n):null}finally{ne.fill(0),Kf.fill(0)}}function E1(e,t,r){qt(e),$r(t);const n=Dr(r,e);try{return ne.set(e),Ke.set(t),V.pointAddScalar(e.length,n)===1?ne.slice(0,n):null}finally{ne.fill(0),Ke.fill(0)}}function S1(e,t){qt(e);const r=Dr(t,e);try{return ne.set(e),V.pointCompress(e.length,r),ne.slice(0,r)}finally{ne.fill(0)}}function v1(e,t){$t(e);const r=Dr(t);try{return ue.set(e),V.pointFromScalar(r)===1?ne.slice(0,r):null}finally{ue.fill(0),ne.fill(0)}}function m1(e){$t(e);try{return ue.set(e),V.xOnlyPointFromScalar(),De.slice(0,Mt)}finally{ue.fill(0),De.fill(0)}}function T1(e){qt(e);try{return ne.set(e),V.xOnlyPointFromPoint(e.length),De.slice(0,Mt)}finally{ne.fill(0),De.fill(0)}}function P1(e,t,r){qt(e),$r(t);const n=Dr(r,e);try{return ne.set(e),Ke.set(t),V.pointMultiply(e.length,n)===1?ne.slice(0,n):null}finally{ne.fill(0),Ke.fill(0)}}function I1(e,t){$t(e),$r(t);try{return ue.set(e),Ke.set(t),V.privateAdd()===1?ue.slice(0,Pn):null}finally{ue.fill(0),Ke.fill(0)}}function A1(e,t){if($t(e),$r(t),Ho(t))return new Uint8Array(e);try{return ue.set(e),Ke.set(t),V.privateSub()===1?ue.slice(0,Pn):null}finally{ue.fill(0),Ke.fill(0)}}function k1(e){$t(e);try{return ue.set(e),V.privateNegate(),ue.slice(0,Pn)}finally{ue.fill(0)}}function O1(e,t){si(e),$r(t);try{De.set(e),Ke.set(t);const r=V.xOnlyPointAddTweak();return r!==-1?{parity:r,xOnlyPubkey:De.slice(0,Mt)}:null}finally{De.fill(0),Ke.fill(0)}}function B1(e,t,r,n){si(e),si(r),$r(t);const i=n!==void 0;i&&A_(n);try{if(De.set(e),Wf.set(r),Ke.set(t),i)return V.xOnlyPointAddTweakCheck(n)===1;{V.xOnlyPointAddTweak();const o=De.slice(0,Mt);return __(o,r)===0}}finally{De.fill(0),Wf.fill(0),Ke.fill(0)}}function x1(e,t,r){Fr(e),$t(t),cs(r);try{return We.set(e),ue.set(t),r!==void 0&&Cr.set(r),V.sign(r===void 0?0:1),je.slice(0,Hi)}finally{We.fill(0),ue.fill(0),r!==void 0&&Cr.fill(0),je.fill(0)}}function R1(e,t,r){Fr(e),$t(t),cs(r);try{We.set(e),ue.set(t),r!==void 0&&Cr.set(r);const n=V.signRecoverable(r===void 0?0:1);return{signature:je.slice(0,Hi),recoveryId:n}}finally{We.fill(0),ue.fill(0),r!==void 0&&Cr.fill(0),je.fill(0)}}function N1(e,t,r){Fr(e),$t(t),cs(r);try{return We.set(e),ue.set(t),r!==void 0&&Cr.set(r),V.signSchnorr(r===void 0?0:1),je.slice(0,Hi)}finally{We.fill(0),ue.fill(0),r!==void 0&&Cr.fill(0),je.fill(0)}}function U1(e,t,r,n=!1){Fr(e),qt(t),ls(r);try{return We.set(e),ne.set(t),je.set(r),V.verify(t.length,n===!0?1:0)===1}finally{We.fill(0),ne.fill(0),je.fill(0)}}function C1(e,t,r,n=!1){Fr(e),ls(t),O_(t),r&2&&B_(t),k_(()=>nc(t.subarray(0,32)));const i=Dr(n);try{return We.set(e),je.set(t),V.recover(i,r)===1?ne.slice(0,i):null}finally{We.fill(0),je.fill(0),ne.fill(0)}}function H1(e,t,r){Fr(e),si(t),ls(r);try{return We.set(e),De.set(t),je.set(r),V.verifySchnorr()===1}finally{We.fill(0),De.fill(0),je.fill(0)}}const L1=Object.freeze(Object.defineProperty({__proto__:null,__initializeContext:y1,isPoint:_1,isPointCompressed:b1,isPrivate:g1,isXOnlyPoint:nc,pointAdd:w1,pointAddScalar:E1,pointCompress:S1,pointFromScalar:v1,pointMultiply:P1,privateAdd:I1,privateNegate:k1,privateSub:A1,recover:C1,sign:x1,signRecoverable:R1,signSchnorr:N1,verify:U1,verifySchnorr:H1,xOnlyPointAddTweak:O1,xOnlyPointAddTweakCheck:B1,xOnlyPointFromPoint:T1,xOnlyPointFromScalar:m1},Symbol.toStringTag,{value:"Module"}));function M1(e,t){return pc().fromDecimals(e,t)}const $1=sc("btcToken",{state(){return{isConnected:!1,keyPair:null,p2pkh:null,btcAddress:null,btcBalance:0}},getters:{},actions:{async initBtcWalletCDN(){console.log("bitcoinjs",D0);const e=dt.networks.testnet,t="3d6a51a383e6c4c8b40a45302a7e83ebd8fc69e2a630c48449f808e47aa0139c";this.keyPair=dt.ECPair.fromPrivateKey(dt.Buffer.from(t,"hex"),{network:e}),this.p2pkh=dt.payments.p2pkh({pubkey:this.keyPair.publicKey,network:e}),this.btcAddress=this.p2pkh.address,await this.getBtcBalance(),this.isConnected=!0},async initBtcWallet(){const e=dt.networks.testnet,t="3d6a51a383e6c4c8b40a45302a7e83ebd8fc69e2a630c48449f808e47aa0139c",r=y_(L1);this.keyPair=r.fromPrivateKey(Buffer.from(t,"hex"),{network:e}),this.p2pkh=dt.payments.p2pkh({pubkey:this.keyPair.publicKey,network:e}),this.btcAddress=this.p2pkh.address,await this.getBtcBalance(),this.isConnected=!0},async getBtcBalance(){const e=await(await fetch(`https://api.blockcypher.com/v1/btc/test3/addrs/${this.btcAddress}/balance`)).json();this.btcBalance=M1(e.final_balance,8)}}});const F1={name:"EtherPage",components:{ConnectBtcWallet:ac(()=>lc(()=>import("./ConnectBtcWallet-f6b13488.js"),["assets/ConnectBtcWallet-f6b13488.js","assets/index-597dc359.js","assets/index-50093501.css","assets/useEtherJsStore-066c617b.js","assets/ConnectBtcWallet-3909c117.css"]))},setup(){const e=$1(),t=Fi(()=>e.btcAddress),r=Fi(()=>e.btcBalance),n=Fi(()=>e.isConnected);return{useBtc:e,userAddress:t,userBtcBalance:r,isConnected:n}},computed:{getAddress(){return this.userAddress?`${this.userAddress.slice(0,10)}...${this.userAddress.slice(-10)}`:"---"},getAddressLink(){return`https://live.blockcypher.com/btc-testnet/address/${this.userAddress}/`}}},ic=e=>(hc("data-v-927465f4"),e=e(),dc(),e),D1={class:"h-100 flex-center"},K1=ic(()=>qn("h1",{class:"ma-0"},"Btc",-1)),W1=ic(()=>qn("div",null,"Address:",-1)),j1=["href"];function V1(e,t,r,n,i,o){const s=Di("ConnectBtcWallet"),f=Di("BaseDivider"),a=Di("BaseCard");return Ki(),uc("div",D1,[n.isConnected?(Ki(),ys(a,{key:1,width:"500",bgColor:"#ffffff"},{default:cc(()=>[K1,qn("div",null,"Balance: "+_s(n.userBtcBalance)+" BTC",1),bs(f,{class:"my-2",color:"#000000"}),W1,qn("a",{href:o.getAddressLink,class:"address main-black-text"},_s(n.userAddress),9,j1),bs(f,{class:"my-2",color:"#000000"})]),_:1})):(Ki(),ys(s,{key:0}))])}const G1=fc(F1,[["render",V1],["__scopeId","data-v-927465f4"]]),J1=Object.freeze(Object.defineProperty({__proto__:null,default:G1},Symbol.toStringTag,{value:"Module"}));export{J1 as B,$1 as u};
